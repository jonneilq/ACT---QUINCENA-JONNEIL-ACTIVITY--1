/*!CK:2170241536!*//*1435022114,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["JWpvK"]); }

__d("ReactComposerScrapedAttachmentStore",["ReactComposerAttachmentActionType","ReactComposerAttachmentType","ReactComposerScrapedAttachmentActionType","ReactComposerStoreBase","XReactComposerScrapedAttachmentController","AsyncRequest","DOM"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();for(var n in j)if(j.hasOwnProperty(n))p[n]=j[n];var o=j===null?null:j.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=j;function p(){"use strict";j.call(this,(function(){return {markup:null,attachmentConfig:{},enabled:false,isScraping:false,permissiveMatch:null};}),(function(q){switch(q.type){case i.ATTACHMENT_SCRAPE_ENABLED:this.$ReactComposerScrapedAttachmentStore0(q);break;case i.ATTACHMENT_PERMISSIVE_MATCH_SETTED:this.$ReactComposerScrapedAttachmentStore1(q);break;case i.ATTACHMENT_SCRAPE_INTENDED:this.$ReactComposerScrapedAttachmentStore2(q);break;case i.ATTACHMENT_SCRAPED:this.$ReactComposerScrapedAttachmentStore3(q);break;case g.SELECT_ATTACHMENT:this.$ReactComposerScrapedAttachmentStore4(q);break;}}.bind(this)));}p.prototype.isEnabled=function(q){"use strict";return this.getComposerData(q).isEnabled;};p.prototype.hasAttachment=function(q){"use strict";return !!this.getMarkup(q);};p.prototype.isScraping=function(q){"use strict";return this.getComposerData(q).isScraping;};p.prototype.getMarkup=function(q){"use strict";return this.getComposerData(q).markup;};p.prototype.getAttachmentConfig=function(q){"use strict";var r=this.getComposerData(q);if(!r.markup)return null;var s=m.scry(r.markup,'input[name="attachment[params][images][0]"]').pop(),t=m.scry(r.markup,'input[name="attachment[params][title]"]').pop(),u=m.scry(r.markup,'input[name="attachment[params][summary]"]').pop();if(s!=null)r.attachmentConfig.params.images[0]=s.value;if(t!=null)r.attachmentConfig.params.title=t.value;if(u!=null)r.attachmentConfig.params.summary=u.value;return r.attachmentConfig;};p.prototype.getPermissiveMatch=function(q){"use strict";return this.getComposerData(q).permissiveMatch;};p.prototype.$ReactComposerScrapedAttachmentStore0=function(q){"use strict";var r=this.validateAction(q,['composerID','enabled']),s=r[0],t=r[1],u=this.getComposerData(s);u.isEnabled=t;};p.prototype.$ReactComposerScrapedAttachmentStore1=function(q){"use strict";var r=this.validateAction(q,['composerID','permissiveMatch']),s=r[0],t=r[1],u=this.getComposerData(s);u.permissiveMatch=t;this.emitChange(q.composerID);};p.prototype.$ReactComposerScrapedAttachmentStore2=function(q){"use strict";var r=this.validateAction(q,['composerID','targetID','value']),s=r[0],t=r[1],u=r[2];if(!this.isEnabled(s))return;var v=this.getComposerData(q.composerID);v.isScraping=true;var w=k.getURIBuilder().setString('composer_id',s).setString('target_id',t).setString('scrape_url',u).getURI();new l(w).send();this.emitChange(q.composerID);};p.prototype.$ReactComposerScrapedAttachmentStore3=function(q){"use strict";if(!this.isEnabled(q.composerID))return;var r=this.getComposerData(q.composerID);r.markup=q.markup;r.attachmentConfig=q.attachmentConfig;r.isScraping=false;this.emitChange(q.composerID);};p.prototype.$ReactComposerScrapedAttachmentStore4=function(q){"use strict";if(q.id===h.STATUS)return;var r=this.getComposerData(q.composerID);r.markup=null;r.attachmentConfig={};r.isScraping=false;this.emitChange(q.composerID);};e.exports=new p();},null);