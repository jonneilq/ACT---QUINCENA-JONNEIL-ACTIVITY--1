/*!CK:2910069366!*//*1435166855,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["T8NIH"]); }

__d("P2PBannerType",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={ADD_CARD_TO_UNLOCK:"ADD_CARD_TO_UNLOCK",SENDER_NUX:"SENDER_NUX",RECEIVER_NUX:"RECEIVER_NUX"};},null);
__d("P2PPasswordProtectionParam",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={STATUS:"status"};},null);
__d("P2PPaymentCreditCardsTypes",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={SENDING:1,RECEIVING:2};},null);
__d("P2PTransferParam",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={TRANSFER_ID:"transfer_id",STATUS:"status",SENDER_STATUS:"sender_status",RECEIVER_STATUS:"receiver_status",RISK_RESULT:"risk_result"};},null);
__d("ItunesPluginLogging",["Run","Bootloader"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h={logPluginData:function(){g.onAfterLoad(function(){var i=b('Bootloader');i.loadModules(["ItunesDetector","AsyncRequest"],function(j,k){new k().setURI('/ajax/ads/media/log').setData({status:j.hasItunes()}).send();});});}};e.exports=h;},null);
__d("BuddyListNub",["Arbiter","AvailableList","ChannelConnection","ChannelConstants","ChatSidebarActions","ChatVisibility","CSS","Dock","DOM","Event","JSLogger","JSXDOM","KeyEventController","Keys","NubController","OrderedFriendsList","Parent","PresencePrivacy","PresenceStatus","Toggler","csx","cx","setTimeoutAcrossTransitions","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da){b.__markCompiled&&b.__markCompiled();var ea=32,fa=q.create('buddylist_nub');for(var ga in u)if(u.hasOwnProperty(ga))ia[ga]=u[ga];var ha=u===null?null:u.prototype;ia.prototype=Object.create(ha);ia.prototype.constructor=ia;ia.__superConstructor__=u;function ia(ja,ka,la){"use strict";u.call(this);ha.init.call(this,ja);this.root=ja;this.orderedList=ka;this.typeahead=la;this.button=o.find(ja,'a.fbNubButton');this.unreadCount=o.find(ja,"span._5ayx");this.label=o.find(ja,'span.label');this.body=o.scry(ja,'div.fbNubFlyoutBody')[0];this.container=w.byClass(ja,"_56ox");this.typeaheadContainer=o.find(ja,'.fbChatTypeaheadViewContainer');var ma=o.find(ja,'div.fbNubFlyoutTitlebar');z.createInstance(ma).setSticky(false);ka.subscribe('render',this.flyoutContentChanged.bind(this));ka.setScrollContainer(this.body);h.subscribe('buddylist/availability-changed',this._updateCount.bind(this));g.subscribe('chat/connect',this._handleConnect.bind(this));g.subscribe('chat/option-changed',function(na,oa){if(oa.name=='hide_groups')this.onResize();}.bind(this));x.subscribe('privacy-user-presence-changed',this._handleVisibilityChange.bind(this));this.message=o.find(ja,"div._4mq1");this.warningMsgText=null;this.warningMsgEventListener=null;this.showWarningTimeout=null;i.subscribe(i.CONNECTED,this._handleChannelConnected.bind(this));i.subscribe(i.SHUTDOWN,this._handleChannelShutdown.bind(this));i.subscribe(i.RECONNECTING,this._handleChannelReconnecting.bind(this));i.subscribe([i.MUTE_WARNING,i.UNMUTE_WARNING],this._updateView.bind(this));this.subscribe('show',this.onShow.bind(this));this.subscribe('hide',this.onHide.bind(this));this.subscribe('resize',this.onResize.bind(this));p.listen(ja,'keydown',this._onKeyDown.bind(this));p.listen(this.button,'click',this.onButtonClick.bind(this));s.registerKey('q',function(event){if(this._isOpen){la.getCore().getElement().focus();}else{this.onButtonClick();this.show();}event.prevent();}.bind(this));la.getCore().subscribe('escape',this.hide.bind(this));la.subscribe(['respond','reset'],function(na,oa){if(this._isOpen){if(oa&&oa.value&&oa.value===la.getCore().getValue()&&la.getView().isVisible()){n.setUseMaxHeight(this.root,false);this._hideBuddyList();}else this._showBuddyList();this.flyoutContentChanged();}}.bind(this));g.subscribe('sidebar/show',this.hide.bind(this));g.subscribe('minisidebar/show',this.hide.bind(this));g.subscribe('sidebar/hide',this._onSidebarHide.bind(this));this._orderedListCount=v.getList().length;g.inform('buddylist-nub/initialized',this,g.BEHAVIOR_PERSISTENT);this._handleVisibilityChange();fa.log('buddylist_initialized');}ia.prototype.getButton=function(){"use strict";return this.button;};ia.prototype.getRoot=function(){"use strict";return this.root;};ia.prototype._handleConnect=function(ja){"use strict";this._updateView(true);};ia.prototype._getShutdownReason=function(ja){"use strict";switch(ja){case j.HINT_AUTH:return da._("Your session has timed out. Please log in.");case j.HINT_CONN:return da._("Facebook {Chat} is currently unavailable.",[da.param("Chat",da._("Chat"))]);case j.HINT_MAINT:return da._("Facebook {Chat} is currently down for maintenance.",[da.param("Chat",da._("Chat"))]);default:return da._("Facebook {Chat} is currently unavailable.",[da.param("Chat",da._("Chat"))]);}};ia.prototype._getReconnectMsg=function(ja){"use strict";var ka;if(ja===null||false===navigator.onLine){ka=da._("Unable to connect to chat. Check your Internet connection.");}else if(ja>j.WARNING_COUNTDOWN_THRESHOLD_MSEC){var la=o.create('a',{href:'#',className:'fbChatReconnectLink'},da._("Try again")),ma=o.create('div',null,la);ka=o.create('div',{},da._("Unable to connect to chat."));o.appendContent(ka,ma);}else if(ja>1000){ka=da._("Unable to connect to chat. Reconnecting in {seconds}...",[da.param("seconds",Math.floor(ja/1000))]);}else ka=da._("Unable to connect to chat. Reconnecting...");return ka;};ia.prototype._resetShowWarningTimeout=function(){"use strict";if(this.showWarningTimeout){clearTimeout(this.showWarningTimeout);this.showWarningTimeout=null;}};ia.prototype._handleChannelConnected=function(ja){"use strict";this._resetShowWarningTimeout();if(this.orderedList.isVisible())l.goOnline();this.warningMsgText=null;this._updateView();};ia.prototype._handleChannelShutdown=function(ja,ka){"use strict";this._resetShowWarningTimeout();this.warningMsgText=this._getShutdownReason(ka);this._updateView();};ia.prototype._handleChannelReconnecting=function(ja,ka){"use strict";this._resetShowWarningTimeout();this.warningMsgText=this._getReconnectMsg(ka);if(ka>1000){if(ka>j.WARNING_COUNTDOWN_THRESHOLD_MSEC){if(this.warningMsgEventListener){this.warningMsgEventListener.remove();this.warningMsgEventListener=null;}this.warningMsgEventListener=p.listen(this.message,'click',function(event){if(m.hasClass(event.getTarget(),'fbChatReconnectLink')){this._tryReconnect();event.kill();}}.bind(this));}this.showWarningTimeout=ca(this._handleChannelReconnecting.bind(this,ja,ka-1000),1000);}this._updateView();};ia.prototype._tryReconnect=function(){"use strict";if(i.disconnected())i.reconnect();};ia.prototype._handleVisibilityChange=function(){"use strict";this._updateView();if(!l.isOnline())this.hide();};ia.prototype._updateView=function(ja){"use strict";var ka=this.container;if(ka){m.conditionClass(ka,'offline',!l.isOnline());m.conditionClass(ka,'error',i.disconnected());}if(i.disconnected())o.setContent(this.message,this.warningMsgText);var la,ma;if(!l.isOnline()){la=da._("{Chat} (Off)",[da.param("Chat",da._("Chat"))]);}else if(i.disconnected()){la=da._("{Chat} (Disconnected)",[da.param("Chat",da._("Chat"))]);}else{var na=y.getOnlineCount();if(na){var oa=r.span({className:"count"},"(",na,")");la=da._({"*":"{Chat} {number-available}"},[da.param("Chat",da._("Chat")),da.param("number-available",oa,[0,na])]);}else{la=da._("Chat");ma=true;}}this._setUnread(this._unreadMessageCount);this._setLabel(la,ma);this.buttonContentChanged();};ia.prototype.onButtonClick=function(){"use strict";if(m.shown(this.typeahead.getElement())){var ja=this.subscribe('show',function(){this.typeahead.getCore().getElement().focus();}.bind(this));setTimeout(this.unsubscribe.bind(this,ja),0);}};ia.prototype.onHide=function(){"use strict";this._isOpen=false;if(this._buddyListRenderSubscription){this.orderedList.unsubscribe(this._buddyListRenderSubscription);this._buddyListRenderSubscription=null;}this._hideBuddyList();this.typeahead.getCore().reset();};ia.prototype._onKeyDown=function(event){"use strict";var ja=p.getKeyCode(event);if(ja===t.ESC&&!m.hasClass(this.root,'menuOpened')){this.hide();return false;}else if(ja==t.RETURN)k.enable();};ia.prototype._onSidebarHide=function(event){"use strict";this.getButton().focus();};ia.prototype.onResize=function(){"use strict";var ja=n.getMaxFlyoutHeight(this.root)-60,ka=Math.max(250,ja);this.orderedList.setNumTopFriends(Math.floor(ka/ea));};ia.prototype._showBuddyList=function(){"use strict";if(!this._buddyListRenderSubscription)this._buddyListRenderSubscription=this.orderedList.subscribe('render',n.setUseMaxHeight.bind(n,this.root,false));m.hide(this.typeaheadContainer);this.orderedList.show();fa.bump('buddylist_show');};ia.prototype._hideBuddyList=function(){"use strict";m.show(this.typeaheadContainer);this.orderedList.hide();fa.bump('buddylist_hide');};ia.prototype.onShow=function(){"use strict";this._isOpen=true;if(i.disconnected()){this._tryReconnect();this._showBuddyList();}else l.goOnline(this._showBuddyList.bind(this));};ia.prototype._setLabel=function(ja,ka){"use strict";var la=this.label.textContent||this.label.innerText;if(la!==ja){var ma=this.label.cloneNode(true);o.setContent(ma,ja);o.replace(this.label,ma);this.label=ma;}this.throbber&&m.conditionShow(this.throbber,!!ka);};ia.prototype._setUnread=function(ja){"use strict";m.conditionShow(this.unreadCount,!!ja);if(ja){ja=r.span({className:"_51jx _5ayw"},ja);o.setContent(this.unreadCount,ja);}};ia.prototype._updateCount=function(){"use strict";this._updateView();};e.exports=ia;},null);
__d("NotificationImpressions",["AsyncSignal","NotificationTokens","URI"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j='/ajax/notifications/impression.php';function k(l,m){var n={ref:m};h.untokenizeIDs(l).forEach(function(o,p){n['alert_ids['+p+']']=o;});new g(new i(j).getQualifiedURI().toString(),n).send();}e.exports={log:k};},null);
__d("P2PTriggersUtils",["CurrentEnvironment","MercuryIDs","P2PGKValues","P2PQEValues"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=/\$((\d{1,3}(,\d{3})*)|\d+)(\.\d{1,2})?(?=\s|\.\s|\,\s|$|\.$|\,$|\?|\!|\")/,l={canSeeTriggers:function(m){if(!j.P2PMessageTriggersEnabled)return false;if(h.isGroupChat(m))if(g.messengerdotcom&&!i.P2PGroupSendMessengerDotCom){return false;}else if(g.facebookdotcom&&!i.P2PGroupSendWWW)return false;return true;},getMatches:function(m){return m.match(k);}};e.exports=l;},null);
__d("DOMP2PTrigger",["CurrentEnvironment","JSXDOM","P2PAmountUtils","P2PTriggersUtils","TransformTextToDOMMixin","copyProperties","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();var n={MAX_ITEMS:40,match:function(o){var p=j.getMatches(o);if(!p||!p.length)return false;var q=p[0];if(i.isAmountOverLegalLimit(q))return false;var r=p.index;return {startIndex:r,endIndex:r+q.length,element:this._element(q)};},_element:function(o){return (h.a({href:"#",className:(("_35i0")+(g.facebookdotcom?' '+"_4g4e":'')),"data-p2p-trigger":o},o));}};e.exports=l(n,k);},null);
__d("p2pTriggerJSXDOMToString",["DOMEmoji","DOMEmote","DOMP2PTrigger","JSXDOM","transformTextToDOM"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=function(m,n,o){var p=[];p.push(i);if(n)p.push(g);if(o)p.push(h);return (j.span(null,k(m,p))).innerHTML;};e.exports=l;},null);
__d("P2PTriggers.react",["DOM","Event","P2PActions","React","nullthrows","p2pTriggerJSXDOMToString"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=j,n=m.PropTypes,o=j.createClass({displayName:"P2PTriggers",propTypes:{renderEmoji:n.bool,renderEmoticons:n.bool,text:n.string.isRequired,threadID:n.string.isRequired},getInitialState:function(){return {amount:''};},_clickListeners:(null),componentDidMount:function(){this._clickListeners=[];var p=g.scry(j.findDOMNode(this),'[data-p2p-trigger]');for(var q=0,r=p.length;q<r;q++)k(this._clickListeners).push(h.listen(p[q],'click',this.handleTriggerClick));},componentWillUnmount:function(){var p;if(this._clickListeners){for(var q=0,r=this._clickListeners.length;q<r;q++){p=this._clickListeners[q];if(p)p.remove();}this._clickListeners=[];}},getAmountFromTriggerClickEvent:function(p){var q=p.target.getAttribute('data-p2p-trigger')||'';return q.replace(/[^0-9\.]+/g,'');},handleTriggerClick:function(p){p.preventDefault();var q=this.getAmountFromTriggerClickEvent(p);this.setState({amount:q});this.openSendView();},openSendView:function(){i.chatSendViewOpened({threadID:this.props.threadID,amount:this.state.amount});},render:function(){var p=l(this.props.text,this.props.renderEmoji,this.props.renderEmoticons);return (j.createElement("span",{dangerouslySetInnerHTML:{__html:p}}));}});e.exports=o;},null);
__d("TextWithEntitiesAndP2P.react",["BaseTextWithEntities.react","Link.react","P2PTriggers.react","React"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=j.createClass({displayName:"TextWithEntitiesAndP2P",_renderText:function(l){return (j.createElement(i,{text:l,renderEmoticons:this.props.renderEmoticons,renderEmoji:this.props.renderEmoji,threadID:this.props.threadID}));},_renderRange:function(l,m){if(this.props.interpolator){return this.props.interpolator(l,m);}else return (j.createElement(h,{href:m.entity},l));},render:function(){return (j.createElement(g,j.__spread({},this.props,{textRenderer:this._renderText,rangeRenderer:this._renderRange,ranges:this.props.ranges,imageRanges:this.props.imageRanges,aggregatedRanges:this.props.aggregatedRanges,text:this.props.text})));}});e.exports=k;},null);
__d("getURLRanges",["URI","URLScraper"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';function i(j,k){k=k||0;var l=h.match(j);if(!l)return [];var m=l;if(!(/^[a-z][a-z0-9\-+.]+:\/\//i.test(l)))m='http://'+l;if(!g.isValidURI(m))return [];k+=j.indexOf(l);var n=l.length,o=[{offset:k,length:l.length,entity:{url:m}}];return o.concat(i(j.substr(k+n),k+n));}e.exports=i;},null);
__d("MercuryMessageBody.react",["EmoticonsList","React","Link.react","P2PTriggersUtils","ReactComponentWithPureRenderMixin","SupportedEmoji","TextWithEntities.react","TextWithEntitiesAndP2P.react","URI","URLMatcher","cancelAnimationFrame","cx","fbt","getURLRanges","isFacebookURI","requestAnimationFrame"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();var w=h,x=w.PropTypes,y=h.createClass({displayName:"MercuryMessageBody",mixins:[k],propTypes:{body:x.string,ranges:x.array,threadID:x.string},getInitialState:function(){return {richText:false};},_shouldRenderP2PTriggers:false,componentDidMount:function(){this._raf=v(this.setIsRichText);},targetBlankLinkInterpolator:function(z,aa){if(aa.entity&&aa.entity.url){var ba=new o(aa.entity.url);if(u(ba)&&!ba.getFragment())aa.entity.url=ba.addQueryData({__mref:'message_bubble'}).toString();}return (h.createElement(i,{target:"_blank",href:aa.entity},z));},setIsRichText:function(){delete this._raf;var z=this.props,aa=z.body,ba=z.ranges;this._shouldRenderP2PTriggers=!!(this.props.threadID&&j.canSeeTriggers(this.props.threadID)&&j.getMatches(aa));if((ba&&ba.length)||g.noncapturingRegexp.test(aa)||l.findEmoji(aa||'')||p.match(aa)||this._shouldRenderP2PTriggers)this.setState({richText:true});},componentWillUnmount:function(){this._raf&&q(this._raf);},render:function(){var z=this.props.body||'',aa;if(z.startsWith('?OTR'))return (h.createElement("span",{className:"_89h"},s._("[encrypted message]")));z=z.replace(/\s+$/,'');if(z.length===0)return null;if(!this.state.richText)return h.createElement("span",{className:this.props.className},z);var ba=this.props.ranges;if(ba==undefined)ba=t(z);aa={className:this.props.className,interpolator:this.targetBlankLinkInterpolator,text:z,ranges:ba,renderEmoticons:true,renderEmoji:true};if(this._shouldRenderP2PTriggers){return (h.createElement(n,h.__spread({},aa,{threadID:this.props.threadID})));}else return (h.createElement(m,h.__spread({},aa)));}});e.exports=y;},null);
__d("NotificationBeeperItemContents.react",["Animation","AsyncRequest","Bootloader","CloseButton.react","ImageBlock.react","NotificationURI","NotificationUserActions","React","TextWithEntities.react","Timestamp.react","URI","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){b.__markCompiled&&b.__markCompiled();function s(u,v){return n.createElement("span",{className:"fwb"},u);}var t=n.createClass({displayName:"NotificationBeeperItemContents",_markAsRead:function(){m.markNotificationsAsRead([this.props.beep.notificationID]);},_onClick:function(u){this._markAsRead();this.props.onHide();if(u.button===1||u.altKey||u.ctrlKey||u.metaKey||u.shiftKey)return;var v=this.props.beep,w=new q(v.url).getPath();if(l.isAlbumDraftRecoveryDialogURI(v.link)){new h(v.link).send();u.preventDefault();}else if(v.photo&&l.snowliftable(v.link)){i.loadModules(["PhotoSnowlift"],function(x){x.bootstrap(v.link,u.currentTarget);});u.preventDefault();}else if(v.ajaxifyLink){i.loadModules(["AsyncDialog"],function(x){x.bootstrap(v.ajaxifyLink,u.currentTarget,'dialog');});u.preventDefault();}},_onClose:function(){this._markAsRead();this.props.onHide();},_doFlash:function(){new g(n.findDOMNode(this.refs.inner)).from('opacity','0').to('opacity','1').duration(200).go();},componentDidMount:function(){this.props.onReadyToHide(this.props.beep.notificationID);},componentDidUpdate:function(u){if(u.beep.beepID!==this.props.beep.beepID){this._doFlash();this.props.onReadyToHide(this.props.beep.notificationID);}},render:function(){var u=this.props.beep;return (n.createElement("div",{ref:"inner"},n.createElement(j,{className:"_3soc",onClick:this._onClose,size:"medium"}),n.createElement("a",{href:u.link,onClick:this._onClick,className:"_3soi"},n.createElement(k,{className:"_3soj",spacing:"medium"},n.createElement("img",{src:u.actors[0].profile_picture.uri,className:"_3sok"}),n.createElement("div",{className:"_3sol"},n.createElement(o,{renderEmoticons:true,renderEmoji:true,interpolator:s,ranges:u.text.ranges,aggregatedranges:u.text.aggregated_ranges,text:u.text.text}),n.createElement(k,{className:"_3som"},n.createElement("img",{className:"_1x8t",src:u.icon.uri}),n.createElement(p,{time:u.timestamp.time,text:u.timestamp.text,verbose:u.timestamp.verbose})))))));}});e.exports=t;},null);
__d("NotificationBeeperConst",["keyMirror"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h={IDLE_DELAY:10000,ACTIVE_DELAY_LONG:4000,FADE_OUT_LENGTH:1500,BeepStates:g({PENDING:true,RENDERED:true,READY_TO_HIDE:true,FADING_OUT:true})};e.exports=h;},null);
__d("NotificationBeeperItem.react",["Animation","BrowserSupport","NotificationBeeperItemContents.react","React","NotificationBeeperItemRenderersList","Style","NotificationBeeperConst","cx","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();var p=j.createClass({displayName:"NotificationBeeperItem",getInitialState:function(){return {fadedIn:false,hidden:false};},componentDidMount:function(){var q;if(h.hasCSSAnimations()){q=this.setState.bind(this,{fadedIn:true},null);}else q=function(){new g(j.findDOMNode(this.refs.item)).from('top','-30px').from('opacity','0').to('top','0px').to('opacity','1').duration(200).ondone(this.setState.bind(this,{fadedIn:true},null)).go();}.bind(this);o(q,50);this.props.onInserted(this.props.beep);},componentWillUnmount:function(){if(this._fadeOutAnimation){this._fadeOutAnimation.stop();this._fadeOutAnimation=null;}},_onHide:function(){this.setState({hidden:true});},render:function(){var q=this.props.beep,r=(("_3sod")+(this.state.fadedIn?' '+"_3soe":'')+(this.state.hidden?' '+"_3sof":'')),s=this._getRenderer(q.beepRenderer);return (j.createElement("li",{className:r,ref:"item","data-gt":q.tracking},j.createElement(s,{beep:q,onHide:this._onHide,onReadyToHide:this.props.onReadyToHide,ref:"itemContents"})));},componentDidUpdate:function(q,r,s){if(this.props.fadingOut){if(!this._fadeOutAnimation)this._fadeOutAnimation=new g(j.findDOMNode(this.refs.item)).from('opacity','1').to('opacity','0').duration(m.FADE_OUT_LENGTH).ondone(this._onHide).go();j.findDOMNode(this.refs.item).style.transitionDuration='0ms';}else if(this._fadeOutAnimation){this._fadeOutAnimation.stop();this._fadeOutAnimation=null;l.set(j.findDOMNode(this.refs.item),'opacity','1');}},_getRenderer:function(q){if(q in k)return k[q];return i;}});e.exports=p;},null);
__d("NotificationSound",["Sound"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h=5000;g.init(['audio/mpeg']);function i(j){this._soundPath=j;this._lastPlayed=0;}Object.assign(i.prototype,{play:function(j){if(!this._soundPath)return;var k=Date.now();if((k-this._lastPlayed)<h)return;this._lastPlayed=k;g.play(this._soundPath,j);}});e.exports=i;},null);
__d("NotificationBeeper.react",["Arbiter","ChannelConstants","NotificationBeeperItem.react","NotificationConstants","NotificationImpressions","NotificationPhotoThumbnail","NotificationSound","NotificationUpdates","NotificationURI","NotificationUserActions","React","NotificationBeeperConst","NotificationBeeperPinnedPostLoader","cx","setTimeoutAcrossTransitions","shield"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();var w=r.BeepStates,x='beeper',y=j.PayloadSourceType.LIVE_SEND,z=j.PayloadSourceType.OTHER_APPLICATION,aa=q.createClass({displayName:"NotificationBeeper",getInitialState:function(){return {soundEnabled:this.props.soundEnabled,hovering:false,fading:false,beeps:{}};},componentWillMount:function(){var ba=h.getArbiterType('notif_sound_pref_changed'),ca='update-notifications';this.subscriptions=[n.subscribe(ca,function(da,ea){if(ea.payloadsource===y||ea.payloadsource===z){var fa=ea.nodes;if(fa&&fa.length)this._handleBeepChanges(this._convertNotifications(fa));}}.bind(this)),g.subscribe(ba,function(da,ea){this.setState({soundEnabled:ea.obj.enabled});}.bind(this))];g.inform('NotificationBeeper/mounted',null,g.BEHAVIOR_PERSISTENT);if(s.payload)this._handleBeepChanges(this._convertNotifications(s.payload.nodes));},componentWillUnmount:function(){this.subscriptions.forEach(function(ba){ba.unsubscribe();});this.subscriptions=null;},_onMouseEnter:function(){this._hideWait&&clearTimeout(this._hideWait);var ba=[],ca=this.state.beeps;Object.keys(ca).forEach(function(da){if(ca[da].state!=w.PENDING){ba.push(da);}else ca[da].state=w.RENDERED;});p.markNotificationsAsSeen(ba);this.setState({hovering:true,fading:false,beeps:ca});},_onMouseLeave:function(){this._waitToHide(r.ACTIVE_DELAY_LONG);this.setState({hovering:false});},_onInsertedItem:function(ba){if(!this.state.hovering)this._waitToHide();if(this.state.soundEnabled&&ba.sound){if(!this._notifSound)this._notifSound=new m(this.props.soundPath);this._notifSound.play(ba.beepID);}if(this.props.shouldLogImpressions)k.log([ba.notificationID],x);},_waitToHide:function(ba){this._hideWait&&clearTimeout(this._hideWait);this._hideWait=u(v(this._hide,this),ba||r.IDLE_DELAY);},_onReadyToHide:function(ba){this.state.beeps[ba].state=w.READY_TO_HIDE;if(!this._hideWait)this._waitToHide();},_hide:function(){this._hideWait=null;var ba=this.state.beeps;Object.keys(ba).forEach(function(ca){if(ba[ca].state==w.READY_TO_HIDE)ba[ca].state=w.FADING_OUT;});this.setState({fading:true});u(v(this._finishHide,this),r.FADE_OUT_LENGTH);},_finishHide:function(){if(!this.state.fading)return;var ba=this.state.beeps;Object.keys(ba).forEach(function(ca){if(ba[ca].state==w.FADING_OUT)delete ba[ca];});this.setState({fading:false,beeps:ba});u(function(){var ca=this.state.beeps;Object.keys(ca).forEach(function(da){if(ca[da].state==w.PENDING)ca[da].state=w.RENDERED;});this.setState({beeps:ca});}.bind(this));},_handleBeepChanges:function(ba){var ca=this.state.fading?w.PENDING:w.RENDERED,da=this.state.beeps,ea=false;Object.keys(ba).reverse().forEach(function(fa){var ga={state:ca,data:ba[fa]};if(!da[fa]||da[fa].data.beepID!=ga.data.beepID){if(da[fa]){ea=true;if(ga.data.beepUpdatesOnTop)delete da[fa];}da[fa]=ga;}});if(ea)this._waitToHide();this.forceUpdate();},render:function(){var ba=this.state.beeps,ca=[];Object.keys(ba).reverse().forEach(function(fa){var ga=ba[fa];if(ga.state==w.PENDING)return;ca.push(q.createElement(i,{key:fa,fadingOut:this.state.fading&&ga.state==w.FADING_OUT,beep:ga.data,onInserted:this._onInsertedItem,onReadyToHide:this._onReadyToHide}));},this);var da=ca.length>0,ea=((!da?"hidden_elem":'')+(' '+"_50d1"));return (q.createElement("ul",{ref:"container",className:ea,"data-gt":this.props.tracking,onMouseEnter:this._onMouseEnter,onMouseLeave:this._onMouseLeave},ca));},_convertNotifications:function(ba){var ca={};ba.forEach(function(da){if(!da.showBeep)return;var ea=da.alert_id,fa=ea+'-'+da.receivedTime,ga=l.getThumbnail(da.attachments,da.attached_story),ha=ca[ea]={notificationID:ea,notifID:da.id,beepID:fa,beepRenderer:da.beepRenderer,rendererData:da.rendererData,beepUpdatesOnTop:da.beepUpdatesOnTop,actors:da.unaggregatedActors||da.actors,icon:da.icon,link:da.url?o.localize(da.url):'#',url:da.url,ajaxifyLink:da.ajaxify_url,photo:ga,text:da.unaggregatedTitle||da.title,timestamp:da.timestamp,receivedTime:da.receivedTime,sound:!!da.sound,tracking:da.tracking};});return ca;}});e.exports=aa;},null);
__d("SyncRequestTitle.react",["React","fbt","cx"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j=g,k=j.PropTypes,l=g.createClass({displayName:"SyncRequestTitle",propTypes:{appName:k.string.isRequired,isSender:k.bool.isRequired,receiverName:k.string.isRequired,senderName:k.string.isRequired},render:function(){if(this.props.isSender){return (g.createElement("div",null,h._("Waiting for {receiver} to accept your invite to play {app_name}.",[h.param("receiver",g.createElement("span",{className:"_dg4"},this.props.receiverName)),h.param("app_name",g.createElement("span",{className:"_dg5"},this.props.appName))])));}else return (g.createElement("div",null,h._("{sender} wants to play {app_name} with you, right now.",[h.param("sender",g.createElement("span",{className:"_dg4"},this.props.senderName)),h.param("app_name",g.createElement("span",{className:"_dg5"},this.props.appName))])));}});e.exports=l;},null);
__d("SyncRequestAcceptedMessage.react",["React","fbt","cx"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=g,k=j.PropTypes,l=g.createClass({displayName:"SyncRequestAcceptedMessage",propTypes:{appName:k.string.isRequired,isSender:k.bool.isRequired,receiverName:k.string.isRequired,senderName:k.string.isRequired},render:function(){if(this.props.isSender){return (g.createElement("div",null,h._("{receiver} accepted your invite to play {app name}.",[h.param("receiver",g.createElement("span",{className:"_dg4"},this.props.receiverName)),h.param("app name",g.createElement("span",{className:"_dg5"},this.props.appName))])));}else return (g.createElement("div",null,h._("You accepted an invite from {sender} to play {app name}.",[h.param("sender",g.createElement("span",{className:"_dg4"},this.props.senderName)),h.param("app name",g.createElement("span",{className:"_dg5"},this.props.appName))])));}});e.exports=l;},null);
__d("SyncRequestRejectedMessage.react",["AsyncRequest","Link.react","React","URI","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m=i,n=m.PropTypes,o=i.createClass({displayName:"SyncRequestRejectedMessage",propTypes:{requestId:n.string.isRequired,app:n.object.isRequired,isSender:n.bool.isRequired,receiver:n.object.isRequired,sender:n.object.isRequired},render:function(){if(this.props.isSender){return (i.createElement("div",null,l._("{receiver} declined your invite to play {app_name}.",[l.param("receiver",i.createElement("span",{className:"_dg4"},this.props.receiver.name)),l.param("app_name",i.createElement("span",{className:"_dg5"},this.props.app.name))])));}else return (i.createElement("div",null,l._("You declined an invite from {sender} to play {app_name}.",[l.param("sender",i.createElement("span",{className:"_dg4"},this.props.sender.name)),l.param("app_name",i.createElement("span",{className:"_dg5"},this.props.app.name))]),i.createElement("div",{className:"_13n7"},i.createElement("div",null,i.createElement(h,{onClick:this._submitBlockApp},l._("Block {app}",[l.param("app",this.props.app.name)]))),i.createElement("div",null,i.createElement(h,{onClick:this._submitBlockUser},l._("Block requests from {sender}",[l.param("sender",this.props.sender.name)]))))));},_submitBlockApp:function(){var p=new j('/games/block_app/'),q=new g().setURI(p);q.setData({app_id:this.props.app.id,source:'sync_request'});q.send();},_submitBlockUser:function(){var p=new j('/games/block_user/'),q=new g().setURI(p);q.setData({app_id:this.props.app.id,blockee_uid:this.props.sender.id});q.send();}});e.exports=o;},null);
__d("SyncRequestExpiredMessage.react",["React","fbt","cx"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j=g,k=j.PropTypes,l=g.createClass({displayName:"SyncRequestExpiredMessage",propTypes:{appName:k.string.isRequired,isSender:k.bool.isRequired,receiverName:k.string.isRequired,senderName:k.string.isRequired},render:function(){if(this.props.isSender){return (g.createElement("div",null,h._("{receiver} missed your invite to play {app name}.",[h.param("receiver",g.createElement("span",{className:"_dg4"},this.props.receiverName)),h.param("app name",g.createElement("span",{className:"_dg5"},this.props.appName))])));}else return (g.createElement("div",null,h._("You missed an invite from {sender} to play {app name}.",[h.param("sender",g.createElement("span",{className:"_dg4"},this.props.senderName)),h.param("app name",g.createElement("span",{className:"_dg5"},this.props.appName))])));}});e.exports=l;},null);
__d("SyncRequestCanceledMessage.react",["React","cx","fbt"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=g,k=j.PropTypes,l=g.createClass({displayName:"SyncRequestCanceledMessage",propTypes:{appName:k.string.isRequired,isSender:k.bool.isRequired,receiverName:k.string.isRequired,senderName:k.string.isRequired},render:function(){if(this.props.isSender){return (g.createElement("div",null,i._("You canceled an invite to {receiver} to play {app name}.",[i.param("receiver",g.createElement("span",{className:"_dg4"},this.props.receiverName)),i.param("app name",g.createElement("span",{className:"_dg5"},this.props.appName))])));}else return (g.createElement("div",null,i._("{sender} canceled an invitation to play {app name}.",[i.param("sender",g.createElement("span",{className:"_dg4"},this.props.senderName)),i.param("app name",g.createElement("span",{className:"_dg5"},this.props.appName))])));}});e.exports=l;},null);
__d("SyncRequestTimer.react",["React","fbt"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i=g,j=i.PropTypes;function k(m){if(m){m=Math.ceil(m);var n=m%60;if(n<10)n='0'+n;var o=Math.floor(m/60);return o+':'+n;}else return "0:00";}var l=g.createClass({displayName:"SyncRequestTimer",propTypes:{timeRemaining:j.number.isRequired,isSender:j.bool.isRequired,receiverName:j.string.isRequired},render:function(){if(this.props.isSender){return (g.createElement("div",null,h._("({time_remaining} remaining)",[h.param("time_remaining",k(this.props.timeRemaining))])));}else return (g.createElement("div",null,h._("You have {time_remaining} to accept.",[h.param("time_remaining",k(this.props.timeRemaining))])));}});e.exports=l;},null);
__d("XSyncRequestSubmitController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/platform\/games\/sync_requests\/submit\/",{request_id:{type:"Int",required:true},sender:{type:"Int",required:true},action:{type:"Int",required:true}});},null);
__d("SyncRequest.react",["Arbiter","AsyncRequest","ChannelConstants","React","SyncRequestStatusEnum","SyncRequestTitle.react","SyncRequestAcceptedMessage.react","SyncRequestRejectedMessage.react","SyncRequestExpiredMessage.react","SyncRequestCanceledMessage.react","SyncRequestTimer.react","XUIButton.react","XSyncRequestSubmitController","cx","fbt","getObjectValues"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){b.__markCompiled&&b.__markCompiled();var w=j,x=w.PropTypes,y=j.createClass({displayName:"SyncRequest",propTypes:{app:x.object.isRequired,creationTime:x.number.isRequired,requestId:x.string.isRequired,receiver:x.object.isRequired,sender:x.object.isRequired,status:x.oneOf(v(k)).isRequired,timeout:x.number.isRequired,timeRemaining:x.number.isRequired,viewerId:x.number.isRequired,onStatusUpdate:x.func},componentWillMount:function(){if(this.props.status===k.PENDING){var z=g.subscribe(i.getArbiterType('sync_request_updated'),function(ca,da){da=da.obj;if(da.id.toString()!==this.props.requestId)return;this.setState({status:da.status});}.bind(this));this.setState({statusEvent:z});}var aa=null;if(this.props.status===k.PENDING){var ba=function(){this.setState({time_remaining:(this.state.time_remaining-1)});if(this.state.time_remaining<=0){clearInterval(this.state.counter);var ca={counter:null,time_remaining:0};if(this.state.status===k.PENDING)ca.status=k.EXPIRED;this.setState(ca);}};aa=setInterval(ba.bind(this),1000);}this.setState({time_remaining:this.props.timeRemaining,counter:aa});},componentWillUnmount:function(){if(this.state.counter)clearInterval(this.state.counter);g.unsubscribe(this.state.statusEvent);},getInitialState:function(){return {buttonsDisabled:false,time:Date.now(),status:this.props.status,viewerIsSender:this.props.viewerId===this.props.sender.id};},componentDidUpdate:function(z,aa){if(this.props.status!=k.PENDING)this.state.status=this.props.status;if(this.props.onStatusUpdate)this.props.onStatusUpdate(this.state.status,aa.status);},render:function(){var z;switch(this.state.status){case k.PENDING:var aa;if(!this.state.viewerIsSender){aa=[j.createElement(r,{use:"confirm",onClick:this._handleAccept,disabled:this.state.buttonsDisabled,label:u._("Accept")}),j.createElement(r,{use:"default",onClick:this._handleReject,disabled:this.state.buttonsDisabled,label:u._("Decline")})];}else aa=j.createElement(r,{use:"default",onClick:this._handleCancel,disabled:this.state.buttonsDisabled,label:u._("Cancel")});z=(j.createElement("div",null,j.createElement("div",{className:"_372m"},j.createElement(l,{appName:this.props.app.name,isSender:this.state.viewerIsSender,receiverName:this.props.receiver.name,senderName:this.props.sender.name})),j.createElement("div",{className:"_372n"},j.createElement(q,{isSender:this.state.viewerIsSender,timeRemaining:this.state.time_remaining,receiverName:this.props.receiver.name})),j.createElement("div",{className:"_372o"},aa)));break;case k.ACCEPTED:z=j.createElement("div",{className:"_372p mvs"},j.createElement(m,{appName:this.props.app.name,isSender:this.state.viewerIsSender,receiverName:this.props.receiver.name,senderName:this.props.sender.name}));break;case k.REJECTED:z=j.createElement("div",{className:"_372p mvs"},j.createElement(n,{requestId:this.props.requestId,app:this.props.app,isSender:this.state.viewerIsSender,receiver:this.props.receiver,sender:this.props.sender}));break;case k.EXPIRED:z=j.createElement("div",{className:"_372p mvs"},j.createElement(o,{appName:this.props.app.name,isSender:this.state.viewerIsSender,receiverName:this.props.receiver.name,senderName:this.props.sender.name}));break;case k.CANCELED:z=j.createElement("div",{className:"_372p mvs"},j.createElement(p,{appName:this.props.app.name,isSender:this.state.viewerIsSender,receiverName:this.props.receiver.name,senderName:this.props.sender.name}));break;default:throw new Error('The request status `%s` is unknown.',this.state.status);}return (j.createElement("div",{className:"_372q"},z));},_handleAccept:function(){this._handleStatusUpdate(k.ACCEPTED);var z=window.open(this.props.app.uri);if(z)z.focus();},_handleReject:function(){this._handleStatusUpdate(k.REJECTED);},_handleCancel:function(){this._handleStatusUpdate(k.CANCELED);},_handleStatusUpdate:function(z){this.setState({status:z,buttonsDisabled:true});var aa=s.getURIBuilder().setInt('request_id',this.props.requestId).setInt('sender',this.props.sender.id).setInt('action',z).getURI();new h().setURI(aa).setHandler(function(ba){this.setState({status:z});}.bind(this)).setErrorHandler(function(ba){this.setState({buttonsDisabled:false});}.bind(this)).send();}});e.exports=y;},null);
__d("LineClamp.react",["React","cx","getVendorPrefixedName","joinClasses"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=g,l=k.PropTypes,m=i('lineClamp'),n=g.createClass({displayName:"LineClamp",propTypes:{customEllipsis:l.node,disableNative:l.bool,lineHeight:l.number,lines:l.number.isRequired},_renderEllipsis:function(){var o;if(this.props.lineHeight)o={bottom:this.props.lineHeight+'px'};return (g.createElement("div",{style:o,className:"_4ik3",key:"ellipsis"},this.props.customEllipsis?this.props.customEllipsis:'\u2026'));},render:function(){var o=!!m&&!this.props.disableNative,p=j(this.props.className,(("_4ik4")+(o?' '+"_4ik5":''))),q=this.props.children,r={};if(this.props.lineHeight)r={height:this.props.lineHeight*this.props.lines,lineHeight:this.props.lineHeight+'px'};if(o){r[m]=this.props.lines;}else{p=j(p,'clearfix');q=[g.createElement("div",{className:"_4ik6",key:"inner"},q),this._renderEllipsis()];}return (g.createElement("div",{className:p,style:r},q));}});e.exports=n;},null);
__d("ChatAnimatedGifs",["URI"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();var h={shouldHideBody:function(i){if(!i.has_attachment)return false;for(var j=0;j<i.attachments.length;j++){var k=i.attachments[j];if(k.preview_url){var l=h.getRawUrlFromSafeUrl(k.preview_url);if(i.body==l)return true;}}return false;},getRawUrlFromSafeUrl:function(i){return new g(i).getQueryData().url;}};e.exports=h;},null);
__d("ChatPrivacyActionController",["ChatVisibility","JSLogger","PresencePrivacy"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j=function(k,l){this._userID=k;this._logger=h.create('blackbird');this._getState=function(){if(g.isOnline())return i.allows(this._userID)?j.NORMAL:j.BLOCKED;return j.OFFLINE;};this._togglePrivacy=function(){var m=this._getState();switch(this._getState()){case j.OFFLINE:if(g.isOnline()){this._logger.error('tabs_already_online');break;}this._logger.log('tabs_go_online',{tab_id:this._userID});g.goOnline(function(){if(!i.allows(this._userID)){if(this._getState()!==j.BLOCKED)this._logger.error('privacy_action_controller_blocked_inconsistency');this._togglePrivacy();}}.bind(this));break;case j.BLOCKED:i.allow(this._userID);this._logger.log('tabs_unblock',{tab_id:this._userID});break;case j.NORMAL:i.disallow(this._userID);this._logger.log('tabs_block',{tab_id:this._userID});break;}};setTimeout(function(){var m=function(){l&&l(this._getState());}.bind(this);m();this._subscribeToken=i.subscribe('privacy-changed',m);}.bind(this),0);};j.OFFLINE='offline';j.BLOCKED='blocked';j.NORMAL='normal';Object.assign(j.prototype,{togglePrivacy:function(){this._logger.log('gear_menu_toggle_privacy',{tab_id:this._userID});this._togglePrivacy();},destroy:function(){this._subscribeToken&&i.unsubscribe(this._subscribeToken);}});e.exports=j;},null);
__d("StickersFlyoutTriggerSelector.react",["React","Sticker.react","StickerConstants","StickerUtils","XUIContextualDialog.react","XUICloseButton.react","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n=g,o=n.PropTypes,p=84,q=g.createClass({displayName:"StickersFlyoutTriggerSelector",getDefaultProps:function(){return {stickers:[]};},propTypes:{context:o.object.isRequired,stickers:o.array,onStickerSelect:o.func.isRequired},shouldComponentUpdate:function(r){if(this.props.stickers.length!==r.stickers.length)return true;for(var s=0;s<Math.min(this.props.stickers.length,5);s++)if(this.props.stickers[s].id!==r.stickers[s].id)return true;return false;},_renderStickers:function(){if(!this.props.stickers||this.props.stickers.length===0)return null;var r=Math.floor(Math.random()*Math.min(this.props.stickers.length,5)),s=this.props.stickers[r],t=j.getScaledDimensions(s.height,s.width,i.TRAY_SIZE);return (g.createElement("div",null,g.createElement(l,{size:"small",className:"_2ohj",onClick:this.props.onDismissTrigger}),g.createElement("div",{className:"_5r8h _onc","data-id":s.id,onClick:function(){return this.props.onStickerSelect(s.id);}.bind(this)},g.createElement(h,{animationTrigger:"hover",className:"_5r8i",frameCount:s.frameCount,frameRate:s.frameRate||83,framesPerCol:s.framesPerCol,framesPerRow:s.framesPerRow,sourceHeight:t.height,sourceURI:s.sourceURI,sourceWidth:t.width,spriteURI:s.spriteURI,paddedSpriteURI:s.paddedSpriteURI,stickerID:s.id,style:{cursor:'pointer',height:'64px'}}))));},render:function(){return (g.createElement(k,{alignment:"left",autoFocus:false,context:this.props.context,onBlur:this._resetFlyout,offsetY:11,position:"above",shown:this.props.stickers&&this.props.stickers.length>0,width:p},this._renderStickers()));}});e.exports=q;},null);
__d("StickerTrigger",["EmoticonsList","Map","StickerConfig","StickerSearch","StickerServerRequests"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=new h(),m={findTriggerForInput:function(n,o){if(n===null){o([],null);return;}j.prepareTagsData().then(function(){return this.findTagForInput(n,function(p,q){return o(p,q);});}.bind(this));},findTagForInput:function(n,o){var p=this.findTriggeredWord(n);if(p){if(l.has(p)){o(l.get(p),p);}else k.getStickersForQuery(p,function(q){var r=q.getPayload();l.set(p,r);o(r,p);});}else o([],null);},_getRegex:function(){if(i.TriggerConfidence==='emoji_only'){return g.noncapturingRegexp;}else if(i.TriggerConfidence==='high')return (/^(?:\w+\s?){1,4}$/);return null;},findTriggeredWord:function(n){var o=j.getTagsIndex();if(!o)return null;n=n.toLowerCase();var p=n.match(this._getRegex()),q=null;for(var r=0;p!==null&&r<p.length;r++)if(o[p[r]])q=p[r];return q;}};e.exports=m;},null);
__d("StickerTriggerIndicator.react",["React","cx"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i=g,j=i.PropTypes,k=g.createClass({displayName:"StickerTriggerIndicator",getDefaultProps:function(){return {stickers:[]};},propTypes:{stickers:j.array},shouldComponentUpdate:function(l){var m=this.props.stickers.length>0,n=l.stickers.length>0;return m!==n;},render:function(){var l=this.props.stickers&&this.props.stickers.length>0;return g.createElement("span",{className:((l?"emoticonIndicator":''))});}});e.exports=k;},null);
__d("ChatStickerTriggerController",["BanzaiLogger","React","StickerConfig","StickersFlyoutTriggerSelector.react","StickerTrigger","StickerTriggerIndicator.react"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';function m(n,o,p,q,r){this.$ChatStickerTriggerController0=null;this.$ChatStickerTriggerController1=null;this.$ChatStickerTriggerController2=null;this.$ChatStickerTriggerController3=r;this.$ChatStickerTriggerController4=q;this.$ChatStickerTriggerController5=null;if(i.TriggerInterface==='one_tap'){this.$ChatStickerTriggerController1=h.render(h.createElement(j,{context:p,onStickerSelect:this.$ChatStickerTriggerController6.bind(this),onDismissTrigger:this.$ChatStickerTriggerController7.bind(this)}),n);this.$ChatStickerTriggerController2=n;}else if(i.TriggerInterface==='hyperlink'){this.$ChatStickerTriggerController1=h.render(h.createElement(l,null),o);this.$ChatStickerTriggerController2=o;}}m.prototype.setInput=function(n){this.$ChatStickerTriggerController8=n;};m.prototype.activateAfterparty=function(){this.$ChatStickerTriggerController9=true;clearTimeout(this.$ChatStickerTriggerControllera);this.$ChatStickerTriggerControllera=setTimeout(this.$ChatStickerTriggerControllerb.bind(this),5000);};m.prototype.updateInput=function(n){if(this.$ChatStickerTriggerController9)this.$ChatStickerTriggerControllerb();this.$ChatStickerTriggerControllerc(n);};m.prototype.onFlyoutShown=function(n){if(this.$ChatStickerTriggerController0&&!this.$ChatStickerTriggerControllerd){this.$ChatStickerTriggerControllerd=true;this.$ChatStickerTriggerController3(this.$ChatStickerTriggerController0,n);this.$ChatStickerTriggerController1.isMounted()&&this.$ChatStickerTriggerController1.setProps({stickers:[]});}else n();};m.prototype.getTriggeredWord=function(){return this.$ChatStickerTriggerController0;};m.prototype.$ChatStickerTriggerController6=function(n){this.$ChatStickerTriggerController4(n);this.$ChatStickerTriggerController7();};m.prototype.$ChatStickerTriggerController7=function(){this.$ChatStickerTriggerControllerd=true;this.$ChatStickerTriggerController1.isMounted()&&this.$ChatStickerTriggerController1.setProps({stickers:[]});};m.prototype.$ChatStickerTriggerControllere=function(n,o){if(this.$ChatStickerTriggerController5===null||this.$ChatStickerTriggerController5&&this.$ChatStickerTriggerController5.toLowerCase().indexOf(o)===-1){this.$ChatStickerTriggerController8.isMounted()&&this.$ChatStickerTriggerController8.setProps({triggeredWord:null});this.$ChatStickerTriggerController1.isMounted()&&this.$ChatStickerTriggerController1.setProps({stickers:[]});return;}if(o)g.log('StickersLoggerConfig',{event:'sticker_trigger_activated',numsearchresults:n.length,triggeredword:o,triggerused:false});this.$ChatStickerTriggerController0=o;this.$ChatStickerTriggerController8.isMounted()&&this.$ChatStickerTriggerController8.setProps({triggeredWord:o});if(!this.$ChatStickerTriggerControllerd)this.$ChatStickerTriggerController1.isMounted()&&this.$ChatStickerTriggerController1.setProps({stickers:n});};m.prototype.$ChatStickerTriggerControllerb=function(){clearTimeout(this.$ChatStickerTriggerControllera);this.$ChatStickerTriggerController9=false;this.$ChatStickerTriggerControllerd=false;this.$ChatStickerTriggerController0=null;this.$ChatStickerTriggerControllerc(null);};m.prototype.$ChatStickerTriggerControllerc=function(n){if(this.$ChatStickerTriggerController5!==n){this.$ChatStickerTriggerController5=n;k.findTriggerForInput(this.$ChatStickerTriggerController5,this.$ChatStickerTriggerControllere.bind(this));}};m.prototype.destroy=function(){h.unmountComponentAtNode(this.$ChatStickerTriggerController2);clearTimeout(this.$ChatStickerTriggerControllera);};e.exports=m;},null);
__d("ChatDateBreak.react",["React","Timestamp.react","cx","formatDate","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=g,m=l.PropTypes,n=g.createClass({displayName:"ChatDateBreak",propTypes:{date:m.instanceOf(Date).isRequired},shouldComponentUpdate:function(o){return this.props.date.getTime()!==o.date.getTime();},render:function(){var o=this.props.date,p=j(o,{today:'g:ia',withinWeek:'l g:ia',thisYear:'F jS, g:ia',older:'F j, Y g:i a'}),q=Math.round(o.getTime()/1000);return (g.createElement("div",g.__spread({},this.props,{className:k(this.props.className,"_5w-5")}),g.createElement("div",{className:"_5w-6"},g.createElement(h,{time:q,verbose:p,text:p}))));}});e.exports=n;},null);
__d("ChatAuthorPhotoBlock.react",["MercuryParticipants","React","cx","fbt","formatDate","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m=h,n=m.PropTypes,o=86400000,p=h.createClass({displayName:"ChatAuthorPhotoBlock",propTypes:{authorID:n.string.isRequired,hideName:n.bool,hidePhoto:n.bool,timestamp:n.number},getInitialState:function(){return {author:{id:null,name:'',href:'#',image_src:''}};},componentDidMount:function(){this.updateAuthor(this.props.authorID);},componentWillReceiveProps:function(q){if(q.authorID!=this.state.author.id)this.updateAuthor(q.authorID);},render:function(){return (h.createElement("div",h.__spread({},this.props,{className:l(this.props.className,"_5yt9")}),this.renderAuthorName(),this.renderAuthorPhoto(),this.props.children));},renderAuthorName:function(){if(!this.props.hideName)return (h.createElement("div",{className:"_5ys-",ref:"name"},this.state.author.name));},renderAuthorPhoto:function(){if(!this.props.hidePhoto){var q=null;if(this.props.timestamp){var r=this._getFormat(this.props.timestamp);q=k(new Date(this.props.timestamp),r);}var s=j._("{name} {time}",[j.param("name",this.state.author.name),j.param("time",q)]);return (h.createElement("a",{"aria-label":s,className:"_5ys_","data-hover":"tooltip","data-tooltip-position":"left",href:this.state.author.href||'#',ref:"link"},h.createElement("img",{src:this.state.author.image_src,ref:"image"})));}},updateAuthor:function(q){g.get(q,function(r){this.isMounted()&&this.setState({author:r});}.bind(this));},_getFormat:function(q){if(Date.now()-this.props.timestamp<o){return 'g:ia';}else if((new Date()).getFullYear()===(new Date(q).getFullYear())){return 'M jS, g:ia';}else return 'M j, Y g:ia';}});e.exports=p;},null);
__d("MessageBubbleMixin",["DOMDimensions","React"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i=2,j={getInitialState:function(){return {bubbleWidth:null};},componentDidMount:function(){this._restyleBubble(this.props);},componentDidUpdate:function(k){if(k.maxWidth!==this.props.maxWidth||k.body!==this.props.body||(!k.attachments&&this.props.attachments))this._restyleBubble(k);},_restyleBubble:function(k){if(this.props.attachments){this.setState({bubbleWidth:null});return;}var l=h.findDOMNode(this.refs.bubble);if(k.maxWidth!==this.props.maxWidth||g.getElementDimensions(l).width>this.props.maxWidth){var m=this.props.maxWidth;this.setState({bubbleWidth:m},this._shrinkBubble);return;}this._shrinkBubble();},_shrinkBubble:function(){var k=h.findDOMNode(this.refs.bubble),l=g.getElementDimensions(k).width,m=h.findDOMNode(this.refs.content),n=(m)?(g.getElementDimensions(m).width+g.measureElementBox(h.findDOMNode(this.refs.contentWrapper),'width',true,false,false)):0,o=n+i;if(n>0&&o<this.props.maxWidth&&l-o-this.getBoxWidth()>0)this.setState({bubbleWidth:o});}};e.exports=j;},null);
__d("ChatBubble.react",["DOMDimensions","MercuryMessageBody.react","MessageBubbleMixin","React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=j,n=m.PropTypes,o=null,p=j.createClass({displayName:"ChatBubble",mixins:[i],propTypes:{attachments:n.node,body:n.string,maxWidth:n.number.isRequired,threadID:n.string},_renderContent:function(){if(!this.props.body)return null;return (j.createElement("div",{className:"_d97",ref:"contentWrapper"},j.createElement("span",{className:"_5yl5",ref:"content"},j.createElement(h,{body:this.props.body,ranges:this.props.ranges,threadID:this.props.threadID}))));},render:function(){return (j.createElement("div",j.__spread({},this.props,{className:l("_5w1r",this.props.className),ref:"bubble",style:{maxWidth:this.props.maxWidth,width:this.state.bubbleWidth}}),this._renderContent(),this.props.attachments));},contentWraps:function(){var q=j.findDOMNode(this.refs.content),r=q.getClientRects(),s=g.getElementDimensions(q).height;return (r&&r.length>1&&r[0].height<s);},getBoxWidth:function(){if(!o)o=g.measureElementBox(j.findDOMNode(this.refs.bubble),'width',true,true,false);return o;}});e.exports=p;},null);
__d("ChatMessage.react",["Bootloader","BootloadedComponent.react","ChatAnimatedGifs","ChatAuthorPhotoBlock.react","ChatBubble.react","CSS","ImmutableObject","MercuryAttachment","MercuryAttachments.react","MercuryAttachmentRenderer","MercuryAttachmentType","MercuryErrorInfo","MercuryIDs","MercuryMessageError.react","MercuryMessageInfo","MercuryShareStyleMap","React","cx","fbt","formatDate","isRTL","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba){b.__markCompiled&&b.__markCompiled();'use strict';var ca=w,da=ca.PropTypes,ea=w.createClass({displayName:"ChatMessage",propTypes:{message:da.instanceOf(m).isRequired,maxBubbleWidth:da.number.isRequired,onImageLoad:da.func,onStickerClick:da.func},componentDidMount:function(){l.conditionClass(w.findDOMNode(this),"_2cnu",this.isOneLine());},isOneLine:function(){var ga=this.props.message;return (u.isInbound(ga)&&!this.refs.attachmentsInside&&this.refs.bubble&&!this.refs.bubble.contentWraps());},shouldComponentUpdate:function(ga,ha){return ga.message!==this.props.message;},render:function(){var ga=this.props.message,ha=u.isInbound(ga),ia=s.isGroupChat(ga.thread_id),ja=aa(ga.body),ka=r.hasErrorStatus(ga),la=(("_5wd4")+(ha?' '+"_1nc7":'')+(!ha?' '+"_1nc6":'')+(ha&&ia?' '+"_5ysy":'')+(ka?' '+"_1zcs":'')+(ja?' '+"direction_rtl":'')+(!ja?' '+"direction_ltr":'')),ma=new Date(ga.timestamp);return (w.createElement(j,w.__spread({},this.props,{authorID:ga.author,className:ba(this.props.className,la),hideName:!ha||!ia,hidePhoto:!ha,timestamp:ga.timestamp,title:ha?null:z(ma,'g:ia')}),this._renderInner(),this._renderUndertext()));},_renderInner:function(){if(this.props.message.is_filtered_content)return (w.createElement("div",{className:"_5wd9",ref:"inner"},this._renderFilteredContent()));return (w.createElement("div",{className:"_5wd9",ref:"inner"},this._renderBubble(),this._renderAttachments('outside')));},_renderUndertext:function(){if(this.props.message.is_filtered_content)return null;return (w.createElement("div",{className:"_3ry4",ref:"undertext"},w.createElement(t,{className:"_5wda clearfix",message:this.props.message,ref:"status"}),this._renderSpoofWarning()));},_renderSpoofWarning:function(){return (this.props.message.is_spoof_warning?w.createElement(h,{bootloadPlaceholder:w.createElement("span",null),bootloadComponent:function(ga){g.loadModules(["MercurySpoofWarning.react"],ga);},authorID:this.props.message.author,className:"_5wdb"}):null);},_renderFilteredContent:function(){return w.createElement("div",{className:"_5wdc uiBoxYellow clearfix"},y._("This message has been temporarily removed because the sender's account requires verification, or it was identified as abusive."));},_renderAttachments:function(ga){var ha=this.props.message,ia=ga=='inside'?'attachmentsInside':'attachmentsOutside',ja=n.get(ha).filter(function(ka){var la=p.isBubblePreferred(ka)&&!((p.isPhotoAttachment(ka)||p.isVideoAttachment(ka))&&!ha.body);return (la&&ga==='inside')||(!la&&ga==='outside');});if(ja.length>0)return w.createElement(o,{className:((ga==='outside'?"_3e7u":'')),isChat:true,message:ha,attachments:ja,ref:ia,onImageLoad:this.props.onImageLoad,onStickerClick:this.props.onStickerClick,maxWidth:this.props.maxBubbleWidth});},_renderBubble:function(){var ga=this.props.message,ha=ga.body,ia=this._renderAttachments('inside'),ja=u.isInbound(ga);if(i.shouldHideBody(ga))ha='';if(ha||ia)return (w.createElement("div",{className:"_5wde"},w.createElement(k,{attachments:ia,body:ha,className:(("_5wdf")+(fa(ga,ja)?' '+"_3okg":'')),maxWidth:this.props.maxBubbleWidth,ranges:ga.ranges,ref:"bubble",threadID:ga.thread_id})));}});function fa(ga,ha){var ia=n.get(ga);if(!ga.body&&ia)return !ia.some(function(ja){if(ja.attach_type!==q.SHARE||!ja.share)return false;var ka=v.getStyleFactory(ja.share);if(ka){var la=ka.factory;return (la.requiresNoBubbleTail&&la.requiresNoBubbleTail(ja,ha));}return false;});return true;}e.exports=ea;},null);
__d("MercuryLogMessage.react",["DOM","Event","ImmutableObject","MercuryLogMessageRenderer","MercuryLogMessageType","React","cx","emptyFunction","formatDate","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();'use strict';var q=l,r=q.PropTypes,s=l.createClass({displayName:"MercuryLogMessage",propTypes:{maxWidth:r.number,message:r.instanceOf(i).isRequired,onImageLoad:r.func},getDefaultProps:function(){return {onImageLoad:n};},getInitialState:function(){return {messageText:null};},componentDidMount:function(){this.componentWillReceiveProps(this.props);},componentWillReceiveProps:function(t){j.renderText(t.message,function(u){this.setState({messageText:u});}.bind(this));},shouldComponentUpdate:function(t,u){return (this.state.messageText!=u.messageText||t.maxWidth!==this.props.maxWidth);},componentDidUpdate:function(){var t=l.findDOMNode(this.refs.attachment);j.renderAttachmentLegacy(t,this.props.message);g.scry(t,'img').forEach(function(u){var v=h.listen(u,'load',function(){this.props.onImageLoad(u);v.remove();}.bind(this));}.bind(this));},render:function(){return (l.createElement("div",l.__spread({},this.props,{className:p(this.props.className,"_5ye6"),style:Object.assign({},this.props.style,this._getStyle()),title:o(new Date(this.props.message.timestamp),'g:ia')}),j.renderIcon(this.props.message),l.createElement("div",{className:"_5ye7"},this.state.messageText),l.createElement("div",{className:"_5ye8",ref:"attachment"})));},_getStyle:function(){return this.props.maxWidth?{maxWidth:this.props.maxWidth}:null;}});e.exports=s;},null);
__d("ChatConversation.react",["ChatDateBreak.react","ChatMessage.react","ImmutableObject","MercuryActionType","MercuryLogMessage.react","React","cx","invariant"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();'use strict';var o=l,p=o.PropTypes,q=1000*60*60,r=l.createClass({displayName:"ChatConversation",propTypes:{maxBubbleWidth:p.number.isRequired,messages:p.arrayOf(p.instanceOf(i)).isRequired,onImageLoad:p.func,onStickerClick:p.func},componentWillReceiveProps:function(s){n(s.maxBubbleWidth===this.props.maxBubbleWidth);},render:function(){var s=this.props.messages,t=[];for(var u=0;u<s.length;u++){var v=s[u],w=(u>0)?s[u-1]:null;if(!w||v.timestamp-w.timestamp>q)t.push(l.createElement(g,{date:new Date(v.timestamp),key:'db:'+v.message_id}));if(v.action_type==j.LOG_MESSAGE){t.push(l.createElement(k,{className:"_5w0o",key:v.message_id,message:v,onImageLoad:this.props.onImageLoad}));}else t.push(l.createElement(h,{key:v.message_id,message:v,maxBubbleWidth:this.props.maxBubbleWidth,onImageLoad:this.props.onImageLoad,onStickerClick:this.props.onStickerClick}));}return l.createElement("div",null,t);}});e.exports=r;},null);
__d("MercuryTypingAnimation.react",["React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=g,k=j.PropTypes,l=g.createClass({displayName:"MercuryTypingAnimation",propTypes:{color:k.oneOf(['light','dark'])},getDefaultProps:function(){return {color:'dark'};},render:function(){var m=(("_4a0v")+(this.props.color==='light'?' '+"_4a0w":'')+(this.props.color==='dark'?' '+"_4a0x":''));return (g.createElement("div",{className:i(this.props.className,m)},g.createElement("div",{className:"_4b0g"},g.createElement("div",{className:"_5pd7"}),g.createElement("div",{className:"_5pd7"}),g.createElement("div",{className:"_5pd7"}))));}});e.exports=l;},null);
__d("ChatTypingIndicator.react",["ChatAuthorPhotoBlock.react","MercuryTypingAnimation.react","ReactComponentWithPureRenderMixin","React","cx"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=j,m=l.PropTypes,n=j.createClass({displayName:"ChatTypingIndicator",mixins:[i],propTypes:{userID:m.string,showName:m.bool},render:function(){var o=this.props,p=o.userID,q=o.showName;return (j.createElement(g,{authorID:p,className:(("_5wd4")+(' '+"_1nc7")+(q?' '+"_5ysy":'')),hideName:!q},j.createElement("div",{className:"_5wd9"},j.createElement(h,{className:"_3e2s",ref:"bubble"}))));},getBubble:function(){return this.refs.bubble;}});e.exports=n;},null);
__d("ChatTypingIndicators.react",["ChatTypingIndicator.react","DOM","MercuryIDs","MercuryThreadInformer","MercuryTypingReceiver","MercuryParticipants","React","SubscriptionsHandler","Tooltip","createObjectFrom","emptyFunction","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){b.__markCompiled&&b.__markCompiled();var s=m,t=s.PropTypes,u=m.createClass({displayName:"ChatTypingIndicators",propTypes:{indicatorClass:t.func,indicatorsWillShow:t.func,indicatorsDidShow:t.func,rootClassName:t.string,threadID:t.string.isRequired,viewer:t.string.isRequired},getDefaultProps:function(){return {indicatorClass:g,indicatorsWillShow:q,indicatorsDidShow:q};},getInitialState:function(){return {typingUserIDs:[]};},componentDidMount:function(){var v=j.getForFBID(this.props.viewer),w=k.getForFBID(this.props.viewer);this._subscriptions=new n();this._subscriptions.addSubscriptions(w.addRetroactiveListener('state-changed',this.typingStateChanged),v.subscribe('messages-received',this.messagesReceived));},componentWillReceiveProps:function(v){if(v.threadID!=this.props.threadID)this.setState({typingUserIDs:[]});},componentWillUpdate:function(v,w){if(w.typingUserIDs.length>0)this.props.indicatorsWillShow();},componentDidUpdate:function(){if(this.state.typingUserIDs.length>0)this.props.indicatorsDidShow();l.getMulti(this.state.typingUserIDs,function(v){if(this.isMounted())this.state.typingUserIDs.forEach(function(w){var x=v[w],y=this.refs[w].getBubble();if(y)o.set(m.findDOMNode(y),this.renderTooltip(x.short_name),'above','left');}.bind(this));}.bind(this));},componentWillUnmount:function(){this._subscriptions.release();},render:function(){var v=i.isGroupChat(this.props.threadID);return (m.createElement("div",{className:this.props.rootClassName},this.state.typingUserIDs.map(function(w){return this._renderTypingIndicator(w,!!v);}.bind(this))));},_renderTypingIndicator:function(v,w){var x=this.props.indicatorClass;return (m.createElement(x,{key:v,ref:v,showName:w,userID:v}));},renderTooltip:function(v){var w=h.create('span');m.render(m.createElement("span",null,r._("{name} is typing...",[r.param("name",v)])),w);return w;},typingStateChanged:function(v){if(this.props.threadID in v)this.setState({typingUserIDs:v[this.props.threadID].slice().sort()});},messagesReceived:function(v,w){if(this.props.threadID in w){var x=w[this.props.threadID],y=p(x.map(function(z){return z.author;}));this.setState({typingUserIDs:this.state.typingUserIDs.filter(function(z){return !y[z];}).sort()});}}});e.exports=u;},null);
__d("MercuryMessageList",["immutable","LogHistory","Map","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=h.getInstance('mercury_message_list');function l(n){this.$MercuryMessageList0=g.List(n||[]);this.$MercuryMessageList1();}l.prototype.append=function(n){var o;this.$MercuryMessageList0=(o=this.$MercuryMessageList0).push.apply(o,n);this.$MercuryMessageList1();m('append',n);};l.prototype.prepend=function(n){var o;this.$MercuryMessageList0=(o=this.$MercuryMessageList0).unshift.apply(o,n);this.$MercuryMessageList1();m('prepend',n);};l.prototype.update=function(n){var o=n.filter(function(p){return this.contains(p);}.bind(this));if(o.length===0)return;this.$MercuryMessageList0=this.$MercuryMessageList0.withMutations(function(p){o.forEach(function(q){var r=this.$MercuryMessageList2.get(q.message_id);if(r!==(void 0))p.set(r,q);}.bind(this));}.bind(this));m('update',o);};l.prototype.reorder=function(n){this.$MercuryMessageList0=g.List(n);this.$MercuryMessageList1();m('reorder',n);};l.prototype.at=function(n){return this.$MercuryMessageList0.get(n);};l.prototype.contains=function(n){return this.$MercuryMessageList2.has(n.message_id);};l.prototype.toArray=function(){return this.$MercuryMessageList0.toArray();};l.prototype.toMap=function(){return new i(g.Seq(this.$MercuryMessageList0).map(function(n){return [n.message_id,n];}));};l.prototype.$MercuryMessageList1=function(){this.$MercuryMessageList2=new i(g.Seq(this.$MercuryMessageList0).map(function(n,o){return [n.message_id,o];}));};function m(event,n){j(function(){k.debug(event,{messageIDs:n.map(function(o){return o.message_id;})});},0);}e.exports=l;},null);
__d("MercuryMessageStore",["MercuryAPIArgsSource","LogHistory","MercuryViewer","MercuryMessageList","SubscriptionsHandler","MercuryThreadlistConstants","mixInEventEmitter","setImmediate","setTimeoutAcrossTransitions","MercuryMessages","MercuryThreadInformer","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();'use strict';var p=b('MercuryMessages').get(),q=b('MercuryThreadInformer').get(),r=b('MercuryThreads').get(),s=h.getInstance('mercury_message_store');function t(v,w){this.$MercuryMessageStore0=v;this.$MercuryMessageStore1=new j();this.$MercuryMessageStore2=1;this.$MercuryMessageStore3=null;this.$MercuryMessageStore4=0;this.$MercuryMessageStore5=w||l.RECENT_MESSAGES_LIMIT;this.$MercuryMessageStore6=new k();this.$MercuryMessageStore6.addSubscriptions(q.subscribe('messages-received',function(x,y){return this.$MercuryMessageStore8(y);}.bind(this)),q.subscribe('messages-updated',function(x,y){return y[this.$MercuryMessageStore0]&&this.$MercuryMessageStore9(y[this.$MercuryMessageStore0]);}.bind(this)),q.subscribe('messages-reordered',function(x,y){return y[this.$MercuryMessageStore0]&&this.$MercuryMessageStorea();}.bind(this)));s.debug('constructed',{threadID:this.$MercuryMessageStore0});this.$MercuryMessageStoreb();}t.prototype.setNewThreadID=function(v){this.$MercuryMessageStorec=v;};t.prototype.destroy=function(){this.$MercuryMessageStore6&&this.$MercuryMessageStore6.release();s.debug('destroyed',{threadID:this.$MercuryMessageStore0});};t.prototype.subscribe=function(v){return this.addRetroactiveListener('updated',v);};t.prototype.fetchMoreMessages=function(){if(this.hasFetchedAll())return false;this.$MercuryMessageStoreb();return true;};t.prototype.hasFetchedAll=function(){if(p.hasLoadedExactlyNMessages(this.$MercuryMessageStore0,this.$MercuryMessageStore4)&&p.hasLoadedAllMessages(this.$MercuryMessageStore0))return true;return r.isNewEmptyLocalThread(this.$MercuryMessageStore0);};t.prototype.$MercuryMessageStoreb=function(){var v=this.$MercuryMessageStore4+this.$MercuryMessageStore5*this.$MercuryMessageStore2;s.debug('fetching',{threadID:this.$MercuryMessageStore0,limit:v});p.getThreadMessagesRange(this.$MercuryMessageStore0,0,v,this.$MercuryMessageStored.bind(this),null,g.MERCURY);if(this.$MercuryMessageStore2<10)this.$MercuryMessageStore2+=1;if(p.hasLoadedNMessages(this.$MercuryMessageStore0,v))n(function(){this.$MercuryMessageStorea();}.bind(this));};t.prototype.$MercuryMessageStored=function(v){if(v&&v.length){this.$MercuryMessageStore3=v[0].timestamp;this.$MercuryMessageStore4=v.length;s.debug('fetched',{threadID:this.$MercuryMessageStore0,earliestMessageTimestamp:this.$MercuryMessageStore3,count:this.$MercuryMessageStore4});}else if(v&&!v.length&&!this.$MercuryMessageStore4)this.$MercuryMessageStoree(t.THREAD_IS_EMPTY);};t.prototype.$MercuryMessageStore8=function(v){var w=[],x=v[this.$MercuryMessageStore0];if(x&&x.length)w=w.concat(x);if(this.$MercuryMessageStorec){var y=v[this.$MercuryMessageStorec];if(y&&y.length){w=w.concat(y);this.$MercuryMessageStorec=null;}}if(w.length){this.$MercuryMessageStore1.append(w);this.$MercuryMessageStore4+=w.length;var z=w.every(function(aa){return aa.author!=i.getID();});this.$MercuryMessageStoree(t.MESSAGES_RECEIVED,{allFromOthers:z});}};t.prototype.$MercuryMessageStore9=function(v){this.$MercuryMessageStore1.update(p.getMessagesFromIDs(Object.keys(v)));this.$MercuryMessageStoref();this.$MercuryMessageStoree(t.MESSAGES_CHANGED);};t.prototype.$MercuryMessageStorea=function(){if(!this.$MercuryMessageStore3)return;this.$MercuryMessageStore1.reorder(p.getThreadMessagesSinceTimestamp(this.$MercuryMessageStore0,this.$MercuryMessageStore3));this.$MercuryMessageStoref();this.$MercuryMessageStoree(t.MESSAGES_REORDERED);};t.prototype.$MercuryMessageStoree=function(v,w){var x=this.$MercuryMessageStore1.toArray();this.releaseHeldEventType('updated');this.emitAndHold('updated',Object.assign({messages:x,eventType:v},w));u(this.$MercuryMessageStore0,v,x);};t.prototype.$MercuryMessageStoref=function(){var v=this.$MercuryMessageStore1.at(0);if(v)this.$MercuryMessageStore3=v.timestamp;};function u(v,w,x){o(function(){s.debug('update:'+w,{threadID:v,messageIDs:x.map(function(y){return y.message_id;})});},0);}Object.assign(t,{MESSAGES_FETCHED:'fetched',MESSAGES_CHANGED:'changed',MESSAGES_RECEIVED:'received',MESSAGES_REORDERED:'reordered',THREAD_IS_EMPTY:'thread-is-empty'});m(t,{updated:true});e.exports=t;},null);
__d("ChatTabMessagesView",["Animation","Arbiter","BanzaiLogger","Bootloader","CSS","ChatConfig","ChatConversation.react","ChatPerfInstrumentation","ChatTabViewEvents","ChatTypingIndicators.react","ChatWelcomeMessage","CurrentUser","DOM","Event","MercuryLastMessageIndicator.react","LiveTimer","MercuryViewer","MercuryMessageStore","MessengerContextBannerBootloader","MessengerHotLikePreviewEvents","React","MercuryShareAttachmentRenderLocations","Scroll","ServerTime","StickerActions","StickerState","StickerStoreController","Style","SubscriptionsHandler","UserAgent_DEPRECATED","arrayContains","getElementPosition","throttle"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma){b.__markCompiled&&b.__markCompiled();'use strict';var na=70,oa=null,pa=20;function qa(sa){if(oa===null){var ta=sa.childNodes[0];ha.set(sa,'overflow','scroll');oa=ta.clientWidth-na;ha.set(sa,'overflow','');}return oa;}function ra(sa,ta,ua,va,wa,xa,ya,za,ab){this.loadingIcon=wa;this.threadID=sa;this.sheetController=ta;this.scrollContainer=ua;this.conversationElem=va;this.contextBannerEligible=ab;this.contextBannerElem=null;this.tabView=za;v.restart(da.get()/1000);this._loadingMoreMessages=false;this._initialLoadFinished=false;function bb(){o.inform('interaction-with-tab',sa);}this._subscriptions=new ia();this._subscriptions.addSubscriptions(h.subscribe('overflow-applied-to-body',this.scrollToBottom.bind(this)),t.listen(this.scrollContainer,'mousedown',bb));if(ja.firefox()){var cb=('WheelEvent' in window)?'wheel':'DOMMouseScroll';this.scrollContainer.addEventListener(cb,bb,false);}else this._subscriptions.addSubscriptions(t.listen(this.scrollContainer,'mousewheel',bb));this._subscriptions.addSubscriptions(t.listen(this.scrollContainer,'scroll',ma(this.scrolling,50,this)));if(l.get('chat_react')){var db;aa.render(aa.createElement(p,{threadID:this.threadID,indicatorsWillShow:function(){return db=this.isScrolledToBottom();}.bind(this),indicatorsDidShow:function(){return db&&this.scrollToBottom(true);}.bind(this),viewer:r.getID()}),ya);}else j.loadModules(["MercuryTypingIndicator"],function(fb){this.typingIndicator=new fb(this.threadID,ya,this);}.bind(this));var eb;this.lastMessageIndicatorNode=xa;this.lastMessageIndicator=aa.render(aa.createElement(u,{threadID:this.threadID,hideTyping:true,indicatorWillShow:function(){return eb=this.isScrolledToBottom();}.bind(this),indicatorDidShow:function(){return eb&&this.scrollToBottom(true);}.bind(this)}),this.lastMessageIndicatorNode);this.initializeConversation();}Object.assign(ra.prototype,{initializeConversation:function(){this._store=new x(this.threadID);this._conversation=aa.render(aa.createElement(m,{maxBubbleWidth:qa(this.scrollContainer),messages:[],onImageLoad:function(sa){var ta=this.scrollContainer,ua=ca.getTop(ta)+ta.clientHeight;if(ua+sa.offsetHeight>=ta.scrollHeight)this.scrollToBottom();}.bind(this),onStickerClick:this._onStickerClick.bind(this)}),this.conversationElem);this._subscriptions.addSubscriptions(this._store.subscribe(this._updateMessageFromStore.bind(this)),z.addListener(z.START,function(sa,ta){if(this.threadID!==ta)return;this._likePreview=sa;this._conversation.setProps({messages:this._getNormalizedMessages()},this.scrollToBottom.bind(this));this.scrollToBottom();this._scrollToBottomInterval=setInterval(this.scrollToBottom.bind(this),50);}.bind(this)),z.addListener(z.STOP,function(sa){if(this.threadID!==sa)return;this._likePreview=null;}.bind(this)),z.addListener(z.FINISH_ANIMATION,function(sa){clearInterval(this._scrollToBottomInterval);}.bind(this)),z.addListener(z.REMOVE,function(sa){if(this.threadID!==sa)return;clearInterval(this._scrollToBottomInterval);this._likePreview=null;this._conversation.setProps({messages:this._getNormalizedMessages()});}.bind(this)));},_updateMessageFromStore:function(sa){if(sa.eventType==x.MESSAGES_RECEIVED&&sa.allFromOthers&&!this.isScrolledToBottom()){this.sheetController.openNewMessagesSheet();this._newMessagesSheetOpened=true;}if(sa.eventType==x.MESSAGES_REORDERED){this._loadingMoreMessages=false;k.hide(this.loadingIcon);}var ta=this.isScrolledToBottom(),ua=this._getLoadingHeight(),va=this.scrollContainer.scrollHeight,wa=ca.getTop(this.scrollContainer);this._messages=sa.messages;var xa=q.getWelcomeMessage(this.threadID);if(xa)this._messages.push(xa);this._conversation.setProps({messages:this._getNormalizedMessages()},function(){if(ta||this._shouldScrollToBottom){this.scrollToBottom();this.setShouldScrollToBottom(false);}else if(sa.eventType==x.MESSAGES_REORDERED)this.scrollToPosition(this.scrollContainer.scrollHeight-va-ua+wa);if(!this._initialLoadFinished){this._initialLoadFinished=true;n.logCHAT_CONVERSATION_TTI();}if(this._store.hasFetchedAll()&&this.contextBannerEligible&&!this.contextBannerElem)y.bootload(this.threadID,ba.CHAT,function(ya){this.contextBannerElem=ya;ha.set(this.conversationElem,'padding-top','80px');s.prependContent(this.conversationElem,this.contextBannerElem);}.bind(this));}.bind(this));this.lastMessageIndicator.setProps({lastMessage:this._messages.length>0?this._messages[this._messages.length-1]:null});if(sa.eventType==x.MESSAGES_RECEIVED&&this._shouldShowStickerReplyNUX(this._messages)&&this.tabView&&this.tabView.isFocused())this.tabView.showStickerReplyNUX();if(sa.eventType==x.MESSAGES_CHANGED)this._checkToAnimateSticker();},setShouldScrollToBottom:function(sa){this._shouldScrollToBottom=sa;},scrolling:function(){this._checkToAnimateSticker();if(this.isScrolledNearTop()&&!this._loadingMoreMessages&&!this.isScrolledToBottom()&&!this.tabView._isDragDropActive)if(this._store.fetchMoreMessages()){k.show(this.loadingIcon);this._loadingMoreMessages=true;}if(!this._newMessagesSheetOpened)return;if(this.isScrolledToBottom()){this.sheetController.closeNewMessagesSheet();this._newMessagesSheetOpened=false;}},getScrollTop:function(){return this.scrollContainer&&ca.getTop(this.scrollContainer);},destroy:function(){s.scry(this.conversationElem,'.stickerContainer').forEach(function(sa){return aa.unmountComponentAtNode(sa);});aa.unmountComponentAtNode(this.conversationElem);this._subscriptions&&this._subscriptions.release();aa.unmountComponentAtNode(this.lastMessageIndicatorNode);delete this.lastMessageIndicator;this._store&&this._store.destroy();this.destroyed=true;},_getLoadingHeight:function(){return this.loadingHeight||this.loadingIcon.clientHeight;},_shouldShowStickerReplyNUX:function(sa){if(!fa.shouldShowStickerReplyNUX()||!sa.length)return false;var ta=sa[sa.length-1];if(ta.author===w.getID())return false;if(ta.has_attachment)return ta.attachments.some(function(ua){return ua.attach_type==='sticker';});return false;},isScrolledToBottom:function(sa){var ta=this.scrollContainer;sa=sa||pa;return ca.getTop(ta)+ta.clientHeight>=ta.scrollHeight-sa;},isScrolledNearTop:function(){return ca.getTop(this.scrollContainer)<this.scrollContainer.clientHeight;},scrollToBottom:function(sa){this.scrollToPosition(this.scrollContainer.scrollHeight,sa);},scrollToPosition:function(sa,ta){this._scrollTopAnimation&&this._scrollTopAnimation.stop();if(ta===true){this._scrollTopAnimation=(new g(this.scrollContainer)).to('scrollTop',sa).ease(g.ease.end).duration(400).go();}else ca.setTop(this.scrollContainer,sa);},_onStickerClick:function(sa,ta){if(!sa)return;i.log('StickersLoggerConfig',{event:'click_sticker',packid:sa,stickerid:ta});var ua=this.tabView;fa.onTrayDataReady(function(){if(ka(fa.getPackIDsInTray(),sa)){var va=fa.getPack(sa);if(va&&va.isPromoted)ea.addPack(sa);ua.setStickersFlyoutPackID(sa);}else ga.showStore(sa);});},_checkToAnimateSticker:function(){var sa=la(this.scrollContainer);h.inform('chatScrolled/'+this.threadID,{scrollTop:ca.getTop(this.scrollContainer),top:sa.y,viewHeight:sa.height});},setNewThreadID:function(sa){this._store.setNewThreadID(sa);},_getNormalizedMessages:function(){if(this._likePreview){this._messages.push(this._likePreview);}else this._messages=this._messages.filter(function(sa){return !sa.is_like_preview;});return this._messages;}});e.exports=ra;},null);
__d("ChatTabOfficeStatus",["fbt","formatDate","CSS"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=1,k=2,l=3,m={update:function(n,o){if(!n||!o||!o.officeStatus)return;this._updateIcon(n,o);this._updateTooltip(n,o);},_updateIcon:function(n,o){i.removeClass(n,'officeStatusNone');i.removeClass(n,'officeStatusAvailable');i.removeClass(n,'officeStatusSporadic');i.removeClass(n,'officeStatusOutOfOffice');switch(o.officeStatus){case j:i.addClass(n,'officeStatusAvailable');break;case k:i.addClass(n,'officeStatusSporadic');break;case l:i.addClass(n,'officeStatusOutOfOffice');break;default:i.addClass(n,'officeStatusNone');break;}},_updateTooltip:function(n,o){var p='';switch(o.officeStatus){case j:p+=g._("AVAILABLE");p+='\n';break;case k:p+=g._("SPORADIC");p+='\n';break;case l:p+=g._("OFF THE GRID");p+='\n';break;default:p+=g._("UNKNOWN");p+='\n';break;}if(o.officeStatusComment)p+=o.officeStatusComment;if(o.officeStatusLocation)p+=' ('+o.officeStatusLocation+')';if(o.officeStatusComment||o.officeStatusLocation)p+='\n';if(o.officeStatusEndDate){var q=h(o.officeStatusEndDate,'M d, Y');p+=g._("Until {date}",[g.param("date",q)]);}n.setAttribute('aria-label',p);n.setAttribute('data-hover','tooltip');}};e.exports=m;},null);
__d("ChatAddToThreadButton.react",["Link.react","ReactComponentWithPureRenderMixin","React","TrackingNodes","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=i,n=m.PropTypes,o=i.createClass({displayName:"ChatAddToThreadButton",mixins:[h],propTypes:{isFBAtWork:n.bool,onClick:n.func,shown:n.bool},render:function(){var p=this.props.isFBAtWork?l._("Add more co-workers to chat"):l._("Add more friends to chat"),q=j.getTrackingInfo(j.types.ADD_TO_THREAD);return (i.createElement(g,{"aria-label":p,className:(("addToThread")+(' '+"button")+(!this.props.shown?' '+"hidden_elem":'')),"data-ft":q,"data-hover":"tooltip","data-tooltip-alignv":"top",onClick:this.props.onClick}));}});e.exports=o;},null);
__d("ChatArchiveWarning.react",["Image.react","ReactComponentWithPureRenderMixin","React","cx","ix"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=i,m=l.PropTypes,n=i.createClass({displayName:"ChatArchiveWarning",mixins:[h],propTypes:{isFBAtWork:m.bool,shown:m.bool},render:function(){var o=this.props.isFBAtWork?k('images/chat/tab/archive-grey.png'):k('images/chat/tab/archive.png');return (i.createElement(g,{src:o,className:(("titanArchiveWarning")+(' '+"button")+(!this.props.shown?' '+"hidden_elem":'')),"data-hover":"tooltip","data-tooltip-alignh":"center","aria-label":"All employee-to-employee conversations will be archived"}));}});e.exports=n;},null);
__d("ChatCloseButton.react",["Link.react","ReactComponentWithPureRenderMixin","React","TrackingNodes","fbt"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=i,m=l.PropTypes,n=i.createClass({displayName:"ChatCloseButton",mixins:[h],propTypes:{onClick:m.func,onKeyUp:m.func,onMouseDown:m.func,active:m.bool},getDefaultProps:function(){return {active:false};},render:function(){var o=j.getTrackingInfo(j.types.CLOSE_BUTTON),p=k._("Press Esc to close"),q=k._("Close tab");return (i.createElement(g,{"aria-label":this.props.active?p:q,className:"close button","data-ft":o,"data-hover":"tooltip","data-tooltip-position":"above",onClick:this.props.onClick,onKeyUp:this.props.onKeyUp,onMouseDown:this.props.onMouseDown}));}});e.exports=n;},null);
__d("ChatPhotoUploader.react",["Bootloader","Image.react","InlineBlock.react","Link.react","MercuryConfig","Promise","React","SubscriptionsHandler","cx","emptyFunction","fbt","ix","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){b.__markCompiled&&b.__markCompiled();'use strict';var t=m,u=t.PropTypes,v=m.createClass({displayName:"ChatPhotoUploader",propTypes:{actionURI:u.string,allowCrossPage:u.bool,disabled:u.bool,imageClassName:u.string,imagesOnly:u.bool,linkClassName:u.string,onSubmit:u.func,onAllUploadsComplete:u.func,onLastUploadFail:u.func,onLastUploadCancel:u.func},getDefaultProps:function(){return {actionURI:k.upload_url,allowCrossPage:true,disabled:false,imageClassName:"_509w",imagesOnly:true,linkClassName:'',onSubmit:p,onAllUploadsComplete:p,onLastUploadFail:p,onLastUploadCancel:p};},shouldComponentUpdate:function(w,x){return w.actionURI!=this.props.actionURI||w.disabled!==this.props.disabled;},componentDidUpdate:function(w,x){if(this._uploader)this._uploader.setAllowCrossPage(this.props.allowCrossPage);},componentWillUnmount:function(){if(!this.isUploading()||!this.props.allowCrossPage)this._cleanup();},render:function(){var w=this.props.imagesOnly?q._("Add Photos"):q._("Add Files");return (m.createElement("form",{action:this.props.actionURI,className:"_vzk",title:w,method:"post",onClick:function(x){x.stopPropagation();if(this.props.disabled)x.preventDefault();}.bind(this),ref:"form"},m.createElement("input",{type:"hidden",name:"attach_id",ref:"attachID"}),m.createElement("input",{type:"hidden",name:"images_only",value:this.props.imagesOnly}),m.createElement(i,{onClick:this._bootloadChatAutoSendPhotoUploader,className:"_m _4q60 _3rzn"},m.createElement(j,{className:s("_4q61 _5f0v _509v",this.props.linkClassName)},m.createElement(h,{className:this.props.imageClassName,src:r('/images/chat/chat_camera_icon.png'),alt:q._("Camera")})),m.createElement("input",{disabled:this.props.disabled,type:"file",className:"_n",name:"attachment[]",multiple:"true",accept:this.props.imagesOnly?'image/*':'*',ref:"input",title:w}))));},_handleSubmit:function(w,x){this.props.onSubmit(w,x);},_handleAllUploadsCompleted:function(w,x){this.props.onAllUploadsComplete(w,x);if(!this.isMounted())this._cleanup();},_handleLastUploadFailed:function(w,x){this.props.onLastUploadFail(w,x);if(!this.isMounted())this._cleanup();},_handleLastUploadCanceled:function(w,x){this.props.onLastUploadCancel(w,x);if(!this.isMounted())this._cleanup();},isUploading:function(){return (this._uploader&&this._uploader.isUploading()||this._uploaderPromiseIsResolving);},_bootloadChatAutoSendPhotoUploader:function(){if(!this._uploaderPromise){this._uploaderPromiseIsResolving=true;this._uploaderPromise=new l(function(w){g.loadModules(["ChatAutoSendPhotoUploader"],function(x){this._uploaderPromiseIsResolving=false;this._uploader=new x(m.findDOMNode(this.refs.form),m.findDOMNode(this.refs.input),m.findDOMNode(this.refs.attachID));this._uploader.setAllowCrossPage(this.props.allowCrossPage);this._subscriptions=new n();this._subscriptions.addSubscriptions(this._uploader.subscribe('submit',this._handleSubmit),this._uploader.subscribe('all-uploads-completed',this._handleAllUploadsCompleted),this._uploader.subscribe('last-upload-failed',this._handleLastUploadFailed),this._uploader.subscribe('last-upload-canceled',this._handleLastUploadCanceled));w(this._uploader);}.bind(this));}.bind(this));}return this._uploaderPromise;},uploadFile:function(w){this._bootloadChatAutoSendPhotoUploader().then(function(x){x.uploadFile(w);});},_cleanup:function(){this._subscriptions&&this._subscriptions.release();this._uploader&&this._uploader.destroy();}});e.exports=v;},null);
__d("MessengerStickerActions",["MessengerDispatcher","keyMirror"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i=h({REPLACE_STICKER_STATE:null}),j={Types:i,handleStickerClick:function(k,l){g.dispatch({packID:k,stickerID:l,type:j.Types.REPLACE_STICKER_STATE});},showStickerTray:function(k){g.dispatch({showTray:true,type:j.Types.REPLACE_STICKER_STATE,threadID:k});},hideStickerTray:function(){g.dispatch({showTray:false,type:j.Types.REPLACE_STICKER_STATE});}};e.exports=j;},null);
__d("MessengerStore",["MessengerDispatcher","mixInEventEmitter"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';function i(){this.$MessengerStore0=g.register(this.__onDispatch.bind(this));}i.prototype.getDispatchToken=function(){return this.$MessengerStore0;};i.prototype.emitChange=function(){this.emit('change');};i.prototype.destroy=function(){g.unregister(this.$MessengerStore0);};h(i,{change:true});e.exports=i;},null);
__d("MessengerStickerStateStore",["MessengerStickerActions","MessengerStore","StickerActions","StickerState","StickerStoreController","SubscriptionsHandler","arrayContains"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';for(var n in h)if(h.hasOwnProperty(n))p[n]=h[n];var o=h===null?null:h.prototype;p.prototype=Object.create(o);p.prototype.constructor=p;p.__superConstructor__=h;function p(){h.call(this);this.$MessengerStickerStateStore0={showTray:false,packID:j.getTrayPackID(),threadID:(void 0)};this.$MessengerStickerStateStore1=new l();j.onTrayDataReady(function(){this.$MessengerStickerStateStore1.addSubscriptions(j.addListener(j.PACK_SELECTED,function(q){this.$MessengerStickerStateStore0=Object.assign({},this.$MessengerStickerStateStore0,{packID:q});this.emitChange();}.bind(this)));}.bind(this));}p.prototype.getState=function(){return this.$MessengerStickerStateStore0;};p.prototype.__onDispatch=function(q){switch(q.type){case g.Types.REPLACE_STICKER_STATE:var r=q.packID,s=!!q.showTray;if(r){if(m(j.getPackIDsInTray(),r)){var t=j.getPack(r);if(t&&t.isPromoted)i.addPack(r);i.selectPack(r);s=true;}else{r=this.$MessengerStickerStateStore0.packID;s=false;k.showStore(q.packID);}this.$MessengerStickerStateStore0.packID=r;}this.$MessengerStickerStateStore0.showTray=s;this.$MessengerStickerStateStore0.threadID=q.threadID;this.emitChange();break;}};e.exports=new p();},null);
__d("StickerContextualDialog.react",["ContextualLayerAutoFlip","ReactAbstractContextualDialog","ReactLayer","cx"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=47,l=i.createClass(h.createSpec({addedBehaviors:[g],displayName:'StickerXUIContextualDialog',theme:{wrapperClassName:"_53ii",arrowDimensions:{offset:k,length:16}}}));l.WIDTH={NORMAL:312,WIDE:400};e.exports=l;},null);
__d("ChatStickerButton.react",["BootloadedComponent.react","Bootloader","MessengerStickerStateStore","MessengerStickerActions","ReactComponentWithPureRenderMixin","React","ReactLayeredComponentMixin","StickerContextualDialog.react","StoreAndPropBasedStateMixin","XUISpinner.react","cx","emptyFunction","fbt","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){b.__markCompiled&&b.__markCompiled();'use strict';var u=l,v=u.PropTypes,w=278,x=l.createClass({displayName:"ChatStickerButton",_clickGuard:(false),mixins:[k,m,o(i)],propTypes:{className:v.string,ContextualDialogClass:v.func.isRequired,flyoutClassName:v.string,flyoutWidth:v.number,onStickerSelect:v.func.isRequired,onEmoticonSelect:v.func.isRequired,onFlyoutShown:v.func,onFlyoutHidden:v.func,threaadID:v.string},statics:{calculateState:function(y){var z=i.getState();return {shown:z.showTray&&y.threadID===z.threadID,packID:z.packID};}},getDefaultProps:function(){return {ContextualDialogClass:n,disabled:false,flyoutWidth:w,onStickerSelect:r,onEmoticonSelect:r};},render:function(){return (l.createElement("a",{onClick:this.showFlyout,onMouseDown:this._prepareForClick,title:s._("Choose a sticker or emoticon"),ref:"link"},l.createElement("span",{className:t(this.props.className,((this.state.shown?"open":'')))})));},renderLayers:function(){var y=this.props.ContextualDialogClass;return {contextualDialog:l.createElement(y,{alignment:this.props.flyoutAlignment,className:"_5e-r",contextRef:function(){return this.refs.link;}.bind(this),onBlur:this._hideFlyout,position:"above",shown:this.state.shown,width:this.props.flyoutWidth},l.createElement(g,{bootloadPlaceholder:l.createElement("div",{style:{padding:'30px',textAlign:'center'}},l.createElement(p,{size:"large"})),bootloadComponent:function(z){h.loadModules(["StickersFlyout.react"],z);},className:this.props.flyoutClassName,onShown:function(z){if(this.props.onFlyoutShown)this.props.onFlyoutShown(z);}.bind(this),onHidden:function(){if(this.props.onFlyoutHidden)this.props.onFlyoutHidden();}.bind(this),onEscKeyDown:this._hideFlyout,onStickerSelect:this._handleStickerSelected,onEmoticonSelect:this._handleEmoticonSelected,packID:this.state.packID,shown:this.state.shown}))};},_prepareForClick:function(){this._clickGuard=this.state.shown;},showFlyout:function(y){y&&y.stopPropagation();if(this._clickGuard||this.props.disabled){this._clickGuard=false;return;}j.showStickerTray(this.props.threadID);},_hideFlyout:function(){j.hideStickerTray();},_handleStickerSelected:function(y){this.props.onStickerSelect(y);},_handleEmoticonSelected:function(y){this._hideFlyout();this.props.onEmoticonSelect(y);}});e.exports=x;},null);
__d("ChatFileUploaderMixin",["SubscriptionsHandler","React"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i=h,j=i.PropTypes,k={propTypes:{attachmentsShelf:j.object,onFileUploaderMounted:j.func,onUploadFinished:j.func,onUpdateAttachmentsShelf:j.func,onSubmit:j.func},setUpSubscriptionsHandler:function(l){this._uploader=l;this._subscriptions=new g();this._subscriptions.addSubscriptions(this._uploader.subscribe(['all-uploads-completed','upload-canceled'],this._handleUploadFinished),this._uploader.subscribe('dom-updated',this._handleUpdateAttachmentsShelf),this._uploader.subscribe('submit',this._handleSubmit));this.props.onFileUploaderMounted(this._uploader);},componentWillUnmount:function(){this._subscriptions&&this._subscriptions.release();if(!this.props.uploaderIsFromHigherLevel)this._uploader&&this._uploader.destroy();},isUploading:function(){return this._uploader.isUploading();},getAttachments:function(){return this._uploader.getAttachments();},getImageFiles:function(){return this._uploader.getImageFiles();},getVideoFiles:function(){return this._uploader.getVideoFiles();},getAudioFiles:function(){return this._uploader.getAudioFiles();},getFiles:function(){return this._uploader.getFiles();},removeAttachments:function(){return this._uploader.removeAttachments();},_handleUploadFinished:function(){if(this.props.onUploadFinished)this.props.onUploadFinished();},_handleUpdateAttachmentsShelf:function(){if(this.props.onUpdateAttachmentsShelf)this.props.onUpdateAttachmentsShelf();},_handleSubmit:function(){if(this.props.onSubmit)this.props.onSubmit();}};e.exports=k;},null);
__d("ChatFileUploader.react",["ChatFileUploaderMixin","InlineBlock.react","MercuryConfig","React","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=j.createClass({displayName:"ChatFileUploader",mixins:[g],getDefaultProps:function(){return {uploaderIsFromHigherLevel:true};},shouldComponentUpdate:function(){return false;},componentDidMount:function(){var n=this.props.initFileUploaderFn(j.findDOMNode(this.refs.form),j.findDOMNode(this.refs.input),j.findDOMNode(this.refs.attachID));this.setUpSubscriptionsHandler(n);},render:function(){return (j.createElement("form",{ref:"form",action:i.upload_url,method:"post"},j.createElement("input",{type:"hidden",ref:"attachID",name:"attach_id"}),j.createElement(h,{className:"_m _4q60 itemLabel"},j.createElement("input",{type:"file",className:"_n",name:"attachment[]",multiple:"true",ref:"input"}),j.createElement("span",{className:"_4q61 itemAnchor"},l._("Add Files...")))));}});e.exports=m;},null);
__d("ChatTabMenu.react",["ChatFileUploader.react","ChatPrivacyActionController","MercuryConfig","MercuryIDs","MercuryFileUploader","MercuryMessengerBlockingUtils","MercuryThreadMuter","ReactComponentWithPureRenderMixin","React","PopoverMenu.react","ReactMenu","MenuSeparator.react","Toggler","TrackingNodes","WebMessengerThreadPermalinks","cx","fbt","goURI","MercuryThreadActions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){b.__markCompiled&&b.__markCompiled();'use strict';var y=b('MercuryThreadActions').get(),z=q.Item,aa=o,ba=aa.PropTypes,ca=o.createClass({displayName:"ChatTabMenu",mixins:[n],propTypes:{onFileUploaderMounted:ba.func,updatePrivacyLinkFunc:ba.func,nameConversationFunc:ba.func,leaveConversationFunc:ba.func,showParticipantsFunc:ba.func,deleteConversationFunc:ba.func,reportSpamFunc:ba.func,blockMessagesFunc:ba.func,unblockMessagesFunc:ba.func,createGroupFunc:ba.func,switchToWorkFunc:ba.func,isGroupChat:ba.bool,isEmptyChat:ba.bool,hasSwitchToWork:ba.bool,showAddFriend:ba.func,threadID:ba.string,attachmentsShelf:ba.object,onUploadFinished:ba.func,onUpdateAttachmentsShelf:ba.func,onSubmit:ba.func,enableDesktopNotif:ba.func},getInitialState:function(){return {url:null};},getDefaultProps:function(){return {show:true};},componentDidMount:function(){u.getThreadURI(this.props.threadID,function(da){this.isMounted()&&this.setState({url:da});}.bind(this));if(!this.props.isGroupChat)this._privacyActionController=new h(j.getUserIDFromThreadID(this.props.threadID),this.props.updatePrivacyLinkFunc);},_initFileUploader:function(da,ea,fa){if(this._fileUploader){this._fileUploader.updateElements(da,ea,fa);}else this._fileUploader=new k(this.props.attachmentsShelf,da,ea,fa);return this._fileUploader;},componentWillUnmount:function(){this._privacyActionController&&this._privacyActionController.destroy();this._fileUploader&&this._fileUploader.destroy();},_unmuteThread:function(){y.unmute(this.props.threadID);s.hide();},_togglePrivacyFunc:function(){this._privacyActionController.togglePrivacy();},getURL:function(){return this.state.url;},_renderFileUploader:function(){return (o.createElement(z,{className:"_37_x"},o.createElement(g,{onFileUploaderMounted:this.props.onFileUploaderMounted,attachmentsShelf:this.props.attachmentsShelf,initFileUploaderFn:this._initFileUploader,onUploadFinished:this.props.onUploadFinished,onUpdateAttachmentsShelf:this.props.onUpdateAttachmentsShelf,onSubmit:this.props.onSubmit})));},_renderOpenFullConversation:function(){if(this.state.url)return (o.createElement(z,{onclick:function(){return x(this.state.url);}.bind(this)},w._("See Full Conversation")));return null;},_renderAddFriend:function(){if(!this.props.showAddFriend)return null;return (o.createElement(z,{onclick:this.props.showAddFriend},w._("Add Friends to Chat...")));},_renderTogglePrivacy:function(){if(!this.props.isGroupChat&&this.props.privacyText)return (o.createElement(z,{onclick:this._togglePrivacyFunc},this.props.privacyText));return null;},_renderMuteConversation:function(){if(!this.props.isMuted){var da=m.showMuteChangeDialog.bind(null,this.props.threadID,null);return (o.createElement(z,{onclick:da},w._("Mute Conversation...")));}else return (o.createElement(z,{onclick:this._unmuteThread},w._("Unmute Conversation")));},_renderDeleteConversation:function(){return (o.createElement(z,{onclick:this.props.deleteConversationFunc},w._("Delete Conversation...")));},_renderReportSpam:function(){if(!this.props.isGroupChat)return (o.createElement(z,{onclick:this.props.reportSpamFunc},w._("Report as Spam or Abuse...")));return null;},_blockMessagesItem:function(){if(!this.props.isGroupChat&&l.gk_result&&!this.props.hasMessageBlocked)return (o.createElement(z,{onclick:this.props.blockMessagesFunc},w._("Block Messages...")));if(!this.props.isMultichat&&l.gk_result&&this.props.hasMessageBlocked)return (o.createElement(z,{onclick:this.props.unblockMessagesFunc},w._("Unblock Messages...")));return null;},_renderCreateGroup:function(){if(this.props.isGroupChat)return (o.createElement(z,{onclick:this.props.createGroupFunc},w._("Create Group")));return null;},_renderSwitchToWork:function(){if(this.props.hasSwitchToWork)return (o.createElement(z,{onclick:this.props.switchToWorkFunc},w._("Move to Work Account")));},_renderConversationName:function(){if(this.props.isGroupChat&&this.state.url)return (o.createElement(z,{onclick:this.props.nameConversationFunc},w._("Edit Conversation Name")));return null;},_renderLeaveConversation:function(){if(this.props.isGroupChat)return (o.createElement(z,{onclick:this.props.leaveConversationFunc},w._("Leave Conversation...")));return null;},_renderEnableDesktopNotifications:function(){if(i.DesktopNotificationsGK&&"Notification" in window&&Notification.permission!=="granted")return (o.createElement(z,{onclick:this.props.enableDesktopNotif},w._("Enable Desktop Notifications")));return null;},_renderPeopleList:function(){if(this.props.isGroupChat&&this.state.url)return (o.createElement(z,{onclick:this.props.showParticipantsFunc},w._("Edit Participants...")));return null;},render:function(){var da=this._renderReportSpam(),ea=this._blockMessagesItem(),fa=this._renderCreateGroup(),ga=o.createElement(q,{className:(("chatReact")+(!this.props.show?' '+"hidden_elem":''))},this._renderOpenFullConversation(),this._renderFileUploader(),this._renderAddFriend(),this._renderTogglePrivacy(),this._renderConversationName(),this._renderPeopleList(),o.createElement(r,null),this._renderSwitchToWork(),this._renderMuteConversation(),this._renderDeleteConversation(),this._renderLeaveConversation(),(da||ea)?(o.createElement(r,null)):null,ea,da,fa?(o.createElement(r,null)):null,fa,this._renderEnableDesktopNotifications()),ha=w._("Options"),ia=t.getTrackingInfo(t.types.DROPDOWN_BUTTON);return (o.createElement(p,{menu:ga},o.createElement("a",{"data-ft":ia,"data-hover":"tooltip","aria-label":ha,"data-tooltip-alignh":"center",className:(("button")+(this.props.isEmptyChat?' '+"hidden_elem":''))})));}});e.exports=ca;},null);
__d("ChatTabSheetListener",["ChatPrivacyActionController","MercuryIDs","MercuryParticipants","MercuryThreadInformer","MercuryThreads","MercuryViewer"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';function m(n,o){this.$ChatTabSheetListener0=o;this.$ChatTabSheetListener1=n;this.$ChatTabSheetListener2=h.getUserIDFromThreadID(this.$ChatTabSheetListener1);j.get().subscribe('threads-updated',function(){return this.$ChatTabSheetListener3();}.bind(this));if(this.$ChatTabSheetListener2)this.$ChatTabSheetListener4=new g(this.$ChatTabSheetListener2,function(p){return this.$ChatTabSheetListener5(p);}.bind(this));}m.prototype.destroy=function(){this.$ChatTabSheetListener4&&this.$ChatTabSheetListener4.destroy();};m.prototype.$ChatTabSheetListener3=function(){var n=k.get();n.getThreadMeta(this.$ChatTabSheetListener1,function(o){var p=l.getID(),q=o.participants.filter(function(r){return r!==p;});(q.length<1&&!n.isNewEmptyLocalThread(this.$ChatTabSheetListener1))?this.$ChatTabSheetListener0.openNoRecipientsSheet():this.$ChatTabSheetListener0.closeNoRecipientsSheet();}.bind(this));};m.prototype.$ChatTabSheetListener5=function(n){switch(n){case g.OFFLINE:this.$ChatTabSheetListener0.closeUserBlockedSheet();this.$ChatTabSheetListener0.openOfflineSheet();break;case g.NORMAL:this.$ChatTabSheetListener0.closeUserBlockedSheet();this.$ChatTabSheetListener0.closeOfflineSheet();break;case g.BLOCKED:this.$ChatTabSheetListener0.closeOfflineSheet();i.get(h.getParticipantIDFromUserID(this.$ChatTabSheetListener2),function(o){o.is_friend?this.$ChatTabSheetListener0.openUserBlockedSheet():this.$ChatTabSheetListener0.closeUserBlockedSheet();}.bind(this));break;}};e.exports=m;},null);
__d("ChatTabSheetController",["Bootloader","ChatTabSheetListener","Deferred","MercuryIDs"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();var k=function(l,m,n,o){this._threadID=l;this._rootElement=m;this._tabElement=n;this._view=o;this._deferred=new i();this._isLoading=false;this._listener=new h(this._threadID,this);};Object.assign(k.prototype,{openAddFriendsSheet:function(){this._load(function(){this._addFriendsTabSheet.open();}.bind(this));},openMessageBlockedTabSheet:function(){this._load(function(){this._threadIsMessageBlockedSheet.open();}.bind(this));},closeMessageBlockedTabSheet:function(){this._load(function(){this._threadIsMessageBlockedSheet.close();}.bind(this));},getAddFriendsParticipants:function(){return this._addFriendsTabSheet?this._addFriendsTabSheet.getParticipants():[];},openNameConversationSheet:function(l){this._load(function(){this._nameConversationTabSheet.open(l);}.bind(this));},openReadOnlySheet:function(){this._load(function(){this._readOnlyTabSheet.open();}.bind(this));},openNewMessagesSheet:function(){this._load(function(){this._newMessagesTabSheet.open();}.bind(this));},openUploadWarningTabSheet:function(){this._load(function(){this._uploadWarningTabSheet.open();}.bind(this));},openThreadIsMutedTabSheet:function(){this._load(function(){this._threadIsMutedTabSheet.open();}.bind(this));},openEmployeeAwaySheet:function(){this._load(function(){this._employeeAwaySheet.open();}.bind(this));},openOfflineSheet:function(){this._load(function(){this._offlineTabSheet.open();}.bind(this));},openUserBlockedSheet:function(){this._load(function(){this._userBlockedTabSheet.open();}.bind(this));},openNoRecipientsSheet:function(){this._load(function(){this._noRecipientsTabSheet.open();}.bind(this));},closeAddFriendsSheet:function(){this._lazy(function(){this._addFriendsTabSheet.close();}.bind(this));},closeAutomaticNameConversationSheet:function(){this._lazy(function(){if(this._nameConversationTabSheet&&this._nameConversationTabSheet.isAutomatic())this._nameConversationTabSheet.close();}.bind(this));},closeThreadIsMutedTabSheet:function(){this._lazy(function(){this._threadIsMutedTabSheet.close();}.bind(this));},closeNewMessagesSheet:function(){this._lazy(function(){this._newMessagesTabSheet.close();}.bind(this));},closeUploadWarningTabSheet:function(){this._lazy(function(){this._uploadWarningTabSheet.close();}.bind(this));},closeOfflineSheet:function(){this._lazy(function(){this._offlineTabSheet.close();}.bind(this));},closeUserBlockedSheet:function(){this._lazy(function(){this._userBlockedTabSheet.close();}.bind(this));},onClickMessagesBlockedSheet:function(l){this._lazy(function(){this._unblockMessagesSub=this._threadIsMessageBlockedSheet.subscribe('clicked',l);}.bind(this));},closeNoRecipientsSheet:function(){this._lazy(function(){this._noRecipientsTabSheet.close();}.bind(this));},onClickNewMessagesSheet:function(l){this._lazy(function(){this._newMessageClickSub=this._newMessagesTabSheet.subscribe('clicked',l);}.bind(this));},onClickThreadIsMutedSheet:function(l){this._lazy(function(){this._threadIsMutedClickSub=this._threadIsMutedTabSheet.subscribe('clicked',l);}.bind(this));},onResize:function(l){this._lazy(function(){this._sheetView.subscribe('resize',l);}.bind(this));},onTokensChanged:function(l){this._lazy(function(){this._addFriendsTabSheet.subscribe('chat/tokens-changed',l);}.bind(this));},onEscape:function(l){this._lazy(function(){this._addFriendsTabSheet.subscribe('esc-pressed',l);}.bind(this));},destroy:function(){this._listener&&this._listener.destroy();this._sheetView&&this._sheetView.destroy();this._offlineTabSheet&&this._offlineTabSheet.destroy();this._userBlockedTabSheet&&this._userBlockedTabSheet.destroy();this._newMessageClickSub&&this._newMessageClickSub.unsubscribe();this._threadIsMutedClickSub&&this._threadIsMutedClickSub.unsubscribe();},_load:function(l){this._bootload();this._deferred.then(l);},_lazy:function(l){this._deferred.then(l);},_bootload:function(){if(this._isLoading)return;this._isLoading=true;g.loadModules(["ChatAddFriendsTabSheet","ChatEmployeeAwaySheet","ChatNameConversationTabSheet","ChatNewMessagesTabSheet","ChatNoRecipientsTabSheet","ChatOfflineTabSheet","ChatReadOnlyTabSheet","ChatThreadIsMessageBlockedSheet","ChatThreadIsMutedTabSheet","ChatUploadWarningTabSheet","ChatUserBlockedTabSheet","MercurySheetView"],function(l,m,n,o,p,q,r,s,t,u,v,w){this._sheetView=new w(this._threadID,this._rootElement,this._tabElement);var x=this._threadID,y=this._rootElement,z=this._sheetView,aa=this._view;this._addFriendsTabSheet=new l(x,y,z,aa);this._employeeAwaySheet=new m(x,y,z);this._nameConversationTabSheet=new n(x,y,z);this._newMessagesTabSheet=new o(x,y,z);this._offlineTabSheet=new q(x,y,z);this._readOnlyTabSheet=new r(x,y,z);this._threadIsMessageBlockedSheet=new s(x,y,z);this._threadIsMutedTabSheet=new t(x,y,z);this._uploadWarningTabSheet=new u(x,y,z);this._userBlockedTabSheet=new v(x,y,z);if(!j.getUserIDFromThreadID(this._threadID))this._noRecipientsTabSheet=new p(x,y,z);this._deferred.resolve();}.bind(this));}});e.exports=k;},null);
__d("ChatTitleLink.react",["Link.react","MercuryThreadTitle.react","React","TrackingNodes","cx"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l=i,m=l.PropTypes,n=i.createClass({displayName:"ChatTitleLink",propTypes:{href:m.string,isNewThread:m.bool,thread:m.object,viewer:m.string},getDefaultProps:function(){return {href:null};},getTitle:function(){return this.refs.threadTitle.getTitle();},render:function(){if(!this.props.thread)return null;return (i.createElement(g,{"aria-level":"3",className:(("titlebarText")+(this.props.href===null?' '+"noLink":'')),"data-ft":j.getTrackingInfo(j.types.TITLE),"data-hover":"tooltip",href:this.props.href},i.createElement(h,{ref:"threadTitle",isNewThread:this.props.isNewThread,thread:this.props.thread,useAndSeparator:true,useShortName:!this.props.thread.is_canonical,viewer:this.props.viewer})));}});e.exports=n;},null);
__d("ChatVideoCallButton.react",["Link.react","ReactComponentWithPureRenderMixin","React","TrackingNodes","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=i,n=m.PropTypes,o=i.createClass({displayName:"ChatVideoCallButton",mixins:[h],propTypes:{onClick:n.func,onKeyUp:n.func,shown:n.bool,tooltipLabel:n.string},getDefaultProps:function(){return {tooltipLabel:(l._("Start a video call"))};},render:function(){var p=j.getTrackingInfo(j.types.VIDEOCHAT),q=JSON.stringify({videochat:'call_clicked_bhat_tab'});return (i.createElement(g,{"aria-label":this.props.tooltipLabel,className:(("videoicon")+(' '+"button")+(!this.props.shown?' '+"hidden_elem":'')),"data-ft":p,"data-gt":q,"data-hover":"tooltip","data-tooltip-position":"above",onClick:this.props.onClick,onKeyUp:this.props.onKeyUp}));}});e.exports=o;},null);
__d("EmoticonUtils",["EmoticonsList","Parent"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i='emoticon_',j=g.symbols,k={getEmoteFromTarget:function(l){var m=h.byClass(l,'emoticon');if(!m)return null;var n=null;m.className.split(' ').forEach(function(o){if(o.startsWith(i))n=o.substring(i.length);});return j[n]||null;},insertEmoticon:function(l,m,n){var o=m.substring(0,n.start),p=m.substring(n.end);if(n.start>0&&!o.endsWith(' '))l=' '+l;if(!p.startsWith(' '))l+=' ';var q=o+l+p;n.start+=l.length;n.end=n.start;return {result:q,start:n.start,end:n.end};}};e.exports=k;},null);
__d("MercuryShareImage.react",["ChatImageArrowDirection","ChatImageWithArrow.react","React","cx"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=i,l=k.PropTypes,m=i.createClass({displayName:"MercuryShareImage",propTypes:{height:l.number.isRequired,source:l.string.isRequired,width:l.number.isRequired},render:function(){return (i.createElement("div",{className:"_4hsl"},i.createElement(h,{arrowDirection:g.BOTH,height:this.props.height,source:this.props.source,width:this.props.width})));}});e.exports=m;},null);
__d("MessengerAttachmentImageBlock.react",["React","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=g,k=j.PropTypes,l=g.createClass({displayName:"MessengerAttachmentImageBlock",propTypes:{attachment:k.object.isRequired},render:function(){return (g.createElement("div",{className:i(this.props.className,this._computeClass())},this._renderImage(),g.createElement("div",{className:"_5swm"},this.props.children)));},_renderImage:function(){if(!this.props.attachment.media||!this.props.attachment.media.image)return null;var n=this._getDimensions(),o=n.height,p=n.width,q=o>p,r=m(o,p),s=o&&p?o/p*100:100,t=(q||r)?.2:1,u=(q||r)?s:52,v={backgroundImage:'url('+this.props.attachment.media.image+')',minHeight:'0px',paddingBottom:q&&s>150?'136px':u*t+'%'};if(this.props.attachment.description&&this.props.attachment.source)v.minHeight='112px';return (g.createElement("div",{className:"_3xn1",style:v}));},_computeClass:function(){if(!this.props.attachment.media||!this.props.attachment.media.image)return "_3xn3 _5swn";var n=this._getDimensions(),o=n.height,p=n.width,q=o>p;return (("_3xn3")+(m(o,p)&&!q?' '+"_3xn5":'')+(q?' '+"_3xn6":'')+(p>=o?' '+"_3xn7":''));},_getDimensions:function(){var n=this.props.attachment.properties||{},o=n.height,p=n.width;if(o&&p){o=parseInt(o,10);p=parseInt(p,10);return {height:o,width:p};}return {height:0,width:0};}});function m(n,o){return n<=300&&o<=300;}e.exports=l;},null);
__d("MercuryFallbackShareAttachmentContent.react",["Image.react","ImageBlock.react","LineClamp.react","MercuryShareAttachmentRenderLocations","MercuryShareAttachmentReactShape","MercuryShareImage.react","MessengerAttachmentImageBlock.react","React","URI","cx","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){b.__markCompiled&&b.__markCompiled();'use strict';var r=n,s=r.PropTypes,t=72,u=n.createClass({displayName:"MercuryFallbackShareAttachmentContent",propTypes:{attachment:k,location:s.oneOf(j.getValues())},statics:{modifyURIUsingLocation:function(v,w){if(w===j.MESSENGER&&!v.getDomain())v.setDomain('facebook.com').setSubdomain(o.getRequestURI().getSubdomain()).setProtocol('https');return v;}},render:function(){var v=this.props.attachment,w=this.props.location,x=((j.CHAT===w?"_49or":'')+(j.WEB_INBOX===w?' '+"__nm":'')+(j.CHAT_PREVIEW===w?' '+"_324d":'')+(j.CHAT!==w?' '+"_tih":'')+(!(v&&v.media.image)?' '+"_49ou":'')),y=(n.createElement("div",{className:"__6j"},n.createElement("div",{className:"__6k"},v.title),n.createElement("div",{className:"__6l"},v.description),n.createElement("div",{className:"__6m"},v.source)));if(v.media&&v.media.image){if(j.CHAT===w||j.CHAT_PREVIEW===w){return (n.createElement(h,{className:x,spacing:"medium"},n.createElement(l,{height:t,source:v.media.image,width:t}),n.createElement("div",{style:{display:'flex',justifyContent:'center',flexDirection:'column',height:t}},y)));}else if(j.MESSENGER===w){var z;if(v.description)z=(n.createElement("div",{className:"__6l"},n.createElement(i,{customEllipsis:" ",lines:2,lineHeight:16},v.description)));var aa;if(v.source)aa=(n.createElement("div",{className:"__6m"},v.source));return (n.createElement(m,{className:x,attachment:v},n.createElement("div",{className:"__6j"},n.createElement("div",{className:"__6k"},n.createElement(i,{customEllipsis:" ",lines:2,lineHeight:18},v.title)),z,aa),this.props.children));}return (n.createElement(h,{className:q(this.props.className,x)},n.createElement(g,{className:"__6n",src:v.media.image,width:t}),y,this.props.children));}return (n.createElement("div",{className:q(this.props.className,x)},y,this.props.children));}});e.exports=u;},null);
__d("MercuryFallbackShareAttachment.react",["Link.react","MercuryFallbackShareAttachmentContent.react","MercuryShareAttachmentRenderLocations","MercuryShareAttachmentReactShape","React","URI","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n=k,o=n.PropTypes,p=k.createClass({displayName:"MercuryFallbackShareAttachment",propTypes:{attachment:j,location:o.oneOf(i.getValues())},renderLink:function(q){var r=this.props.location;if(i.isPreview(r))return q;var s=h.modifyURIUsingLocation(new l(this.props.attachment.uri),r);return (k.createElement(g,{className:"_5rw4",href:s,target:"_blank"},q));},render:function(){return this.renderLink(k.createElement(h,k.__spread({},this.props)));}});e.exports=p;},null);
__d("MercurySharePreview.react",["AsyncRequest","LeftRight.react","LoadingIndicator.react","MercuryFallbackShareAttachment.react","MercuryShareAttachmentRenderLocations","React","XUICloseButton.react","cx","invariant"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();var p=l,q=p.PropTypes,r=l.createClass({displayName:"MercurySharePreview",propTypes:{imageSize:q.shape({width:q.number.isRequired,height:q.number.isRequired}).isRequired,location:q.oneOf(k.getValues()).isRequired,share:q.shape({params:q.array,type:q.number}),uri:q.string,onClose:q.func,onUpdate:q.func},getInitialState:function(){return {attachmentData:null,loading:false};},componentWillMount:function(){this._requestID=1337;this._currentRequest=null;},componentWillUnmount:function(){this._reset();},componentWillReceiveProps:function(s){o(!(s.share&&s.uri));if(!s.share&&!s.uri)return this._reset();var t=this.state.attachmentData||this.state.loading;if(s.share&&!t){this._loadFromShare(s.share);}else if(s.uri&&!(t&&this.props.uri==s.uri))this._loadFromURI(s.uri);},componentDidUpdate:function(s,t){this.props.onUpdate&&this.props.onUpdate(this);},getShareData:function(){return this.state.attachmentData&&this.state.attachmentData.share_data;},isLoading:function(){return this.state.loading;},_loadFromShare:function(s){this._currentRequest=new g().setURI('/message_share_attachment/fromParams/').setData({image_height:this.props.imageSize.height,image_width:this.props.imageSize.width,share_params:s.params,share_type:s.type}).setHandler(this._onShareLoaded.bind(this,this._getNextRequestID()));this._currentRequest.send();this.setState({loading:true,attachmentData:null});},_loadFromURI:function(s){this._currentRequest=new g().setURI('/message_share_attachment/fromURI/').setData({image_height:this.props.imageSize.height,image_width:this.props.imageSize.width,uri:s}).setHandler(this._onShareLoaded.bind(this,this._getNextRequestID()));this._currentRequest.send();this.setState({loading:true,attachmentData:null});},_getNextRequestID:function(){return (++this._requestID);},_getCurrentRequestID:function(){return this._requestID;},_onShareLoaded:function(s,t){if(this._getCurrentRequestID()!==s)return;this.setState({loading:false,attachmentData:t.payload});},_close:function(){this._reset();this.props.onClose&&this.props.onClose();},_reset:function(){this._getNextRequestID();this._currentRequest&&this._currentRequest.abort();this._currentRequest=null;this.setState({loading:false,attachmentData:null});},render:function(){var s=(("_tig")+(' '+"_tih"));if(this.state.loading)return (l.createElement(h,{direction:h.DIRECTION.right,className:s},l.createElement(i,{className:"_tii",size:"large",color:"white"}),l.createElement(m,{className:"_tij",shade:"dark",size:"small",onClick:this._close})));var t=this.state.attachmentData;if(!t)return l.createElement("div",null);return (l.createElement("div",null,l.createElement(m,{className:"_tij",shade:"dark",size:"small",onClick:this._close}),l.createElement(j,{attachment:t,location:k.CHAT_PREVIEW})));}});e.exports=r;},null);
__d("MessengerHotLikeButton.react",["ImmutableObject","Keys","KeyStatus","Link.react","MercurySourceType","MessengerHotLikePreviewEvents","MessengerHotLikeUtils","ReactComponentWithPureRenderMixin","React","StickerConstants","fbt","MercuryMessageObject"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){b.__markCompiled&&b.__markCompiled();'use strict';var r=b('MercuryMessageObject').get(),s=o,t=s.PropTypes,u=o.createClass({displayName:"MessengerHotLikeButton",mixins:[n],componentDidMount:function(){this._subscription=l.addListener(l.FINISH_ANIMATION,function(v,w){if(v===this.props.threadID)this.props.sendSticker(w);}.bind(this));},componentWillUnmount:function(){this._subscription&&this._subscription.remove();},propTypes:{sendSticker:t.func.isRequired,threadID:t.string,disabled:t.bool},render:function(){return (o.createElement(j,{"aria-label":q._("Send a Like"),className:this.props.className,disabled:this.props.disabled,onClick:this._handleClickEvent,onMouseDown:this._handleMouseDown,onMouseUp:this._handleMouseUp},o.createElement("i",{style:{opacity:0,backgroundImage:'url('+m.getURIWithID(p.HOT_LIKE_LARGE_STICKER_ID)+')'}}),o.createElement("i",{style:{opacity:0,backgroundImage:'url('+m.getURIWithID(p.HOT_LIKE_SMALL_STICKER_ID)+')'}}),o.createElement("i",{style:{opacity:0,backgroundImage:'url('+m.getURIWithID(p.HOT_LIKE_MEDIUM_STICKER_ID)+')'}})));},_handleMouseDown:function(v){if(this.props.disabled||this._pressedSince){v.preventDefault();v.stopPropagation();}if(this.props.disabled||v.button!==0)return;this._pressedSince=Date.now();this._informPreviewStart();this._preparePop();},_handleMouseUp:function(){if(!this.props.threadID)return;if(!this._pressedSince)return;this._pressedSince=0;this._cancelPop();this._informPreviewStop();},_informPreviewStart:function(){l.emit(l.START,this._getFakeMessage(),this.props.threadID);},_informPreviewStop:function(){l.emit(l.STOP,this.props.threadID);},_informPreviewPop:function(){l.emit(l.POP,this.props.threadID);},_getFakeMessage:function(){var v=r.constructStickerMessageObject(p.HOT_LIKE_SMALL_STICKER_ID,k.MESSENGER_WEB,this.props.threadID);r.normalizeNewMessage(v);v.is_like_preview=true;v.like_preview_since=this._pressedSince;v.body='';return new g(v);},_preparePop:function(){this._cancelPop();this._popTimeout=setTimeout(this._informPreviewPop,m.SizeTimes.large);},_cancelPop:function(){clearTimeout(this._popTimeout);},_handleClickEvent:function(v){v.stopPropagation();if(this.props.disabled)return;if(i.getKeyDownCode()===h.RETURN)this.props.sendSticker(m.getStickerIDForTime(1));}});e.exports=u;},null);
__d("P2PAPIUtils",["CreditCardFormParam","fbt","guid"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j={genRequestID:function(){return 'id:'+i()+':'+Date.now();},getUncaughtErrorMessage:function(){return (h._("Sorry, something went wrong. Please try again later."));},prepareCardMutationData:function(k){var l={},m=k[g.CARD_NUMBER].replace(/ /g,'');l[g.CARD_NUMBER]=m;if(typeof k[g.CARD_EXPIRATION]==='string'){var n=k[g.CARD_EXPIRATION].split('/');l[g.MONTH]=n[0];l[g.YEAR]=n[1];l[g.CARD_EXPIRATION]={};l[g.CARD_EXPIRATION][g.MONTH]=l[g.MONTH];l[g.CARD_EXPIRATION][g.YEAR]=l[g.YEAR];}else{l[g.MONTH]=k[g.CARD_EXPIRATION][g.MONTH];l[g.YEAR]=k[g.CARD_EXPIRATION][g.YEAR];}return Object.assign({},k,l);}};e.exports=j;},null);
__d("XP2PBannerDismissalsUpdateController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/banner_dismissals\/_update\/",{banner_type:{type:"String",required:true}});},null);
__d("XP2PBannerStatesController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/banner_states\/",{});},null);
__d("XP2PBannerViewsUpdateController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/banner_views\/_update\/",{banner_type:{type:"String",required:true}});},null);
__d("XP2PCardBINValidateController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/card_bin\/validate\/",{bin_number:{type:"String",required:true}});},null);
__d("XP2PCreditCardDeleteController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/credit_cards\/_delete\/",{});},null);
__d("XP2PCreditCardUpdateController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/credit_cards\/_update\/",{});},null);
__d("XP2PCreditCardCreateController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/credit_cards\/_create\/",{});},null);
__d("XP2PCreditCardVerifyController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/credit_cards\/_verify\/",{});},null);
__d("XP2PCreditCardsController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/credit_cards\/",{type:{type:"Int",defaultValue:1}});},null);
__d("XMoneypennyPaymentsCreateController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/moneypenny\/payments\/_create\/",{});},null);
__d("XP2PPasswordProtectionStatusController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/password_protection_status\/",{});},null);
__d("XP2PPasswordProtectionStatusUpdateController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/password_protection_status\/_update\/",{});},null);
__d("XP2PPresetCreditCardSetController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/preset_credit_card\/_set\/",{});},null);
__d("XP2PTransactionsCreateController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/transactions\/_create\/",{});},null);
__d("XP2PTransactionsController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/transactions\/",{since:{type:"Int"}});},null);
__d("XP2PTransactionsDeclineController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/transactions\/_decline\/",{});},null);
__d("XP2PTransactionsCancelController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/transactions\/_cancel\/",{});},null);
__d("XP2PUserEligibilityController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/p2p\/user_eligibility\/",{user_ids:{type:"StringVector",required:true}});},null);
__d("P2PAPI",["AsyncRequest","CreditCardFormParam","P2PActions","P2PAPIUtils","P2PBannerType","P2PPasswordProtectionParam","P2PPaymentCreditCardsTypes","P2PTransferParam","ImmutableObject","Set","URI","XP2PBannerDismissalsUpdateController","XP2PBannerStatesController","XP2PBannerViewsUpdateController","XP2PCardBINValidateController","XP2PCreditCardDeleteController","XP2PCreditCardUpdateController","XP2PCreditCardCreateController","XP2PCreditCardVerifyController","XP2PCreditCardsController","XMoneypennyPaymentsCreateController","XP2PPasswordProtectionStatusController","XP2PPasswordProtectionStatusUpdateController","XP2PPresetCreditCardSetController","XP2PTransactionsCreateController","XP2PTransactionsController","XP2PTransactionsDeclineController","XP2PTransactionsCancelController","XP2PUserEligibilityController","emptyFunction"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja){b.__markCompiled&&b.__markCompiled();'use strict';var ka=new p(),la={getAllCreditCards:function(){var ma=(z.getURIBuilder()).getURI();new g().setData({type:m.SENDING}).setURI(ma).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true).setHandler(function(na){var oa=na.getPayload();if(!oa.error)i.updateCreditCards(oa);}.bind(this)).send();},createTransaction:function(ma){var na=(ea.getURIBuilder()).getURI(),oa={},pa=ma.formData,qa=ma.success||ja,ra=ma.error||ja;oa[h.CREDENTIAL_ID]=pa[h.CREDENTIAL_ID];oa.amount=pa.amount;oa.receiver_id=pa.receiverId;oa.offline_threading_id=j.genRequestID();oa.group_thread_fbid=pa.group_thread_fbid;new g().setData(oa).setMethod('POST').setURI(na).setAllowCrossPageTransition(true).setHandler(function(sa){var ta=sa?sa.getPayload():{};if(ta.error){ra(ta.error);}else{qa(ta);this.getAllCreditCards();}}.bind(this)).setErrorHandler(function(){ra({message:j.getUncaughtErrorMessage()});}.bind(this)).send();},addCreditCard:function(ma){i.ignoreCreditCardChannelEvents();var na=(x.getURIBuilder()).getURI().getPath(),oa=new q('/ajax/payment/token_proxy.php').addQueryData('tpe',na);ma=j.prepareCardMutationData(ma);var pa=new o(ma);new g().setData(ma).setMethod('POST').setURI(oa).setHandler(function(qa){var ra=qa.getPayload(),sa={};if(!ra.errors){sa[h.CREDENTIAL_ID]=ra[h.CREDENTIAL_ID];sa.isPreset=ra.isPreset;sa.isVerified=ra.isVerified;sa.passwordProtection=ra.passwordProtection;pa=o.set(pa,sa);i.addCreditCard(pa);if(ra.isPreset){i.transferAccepted();i.bannerCompleted(k.ADD_CARD_TO_UNLOCK);this.getBannerStates();}}else i.addCreditCardError(Object.assign({requestID:pa.requestID},ra));i.allowCreditCardChannelEvents();}.bind(this)).setErrorHandler(function(){i.addCreditCardError({requestID:pa.requestID,errors:{general:{message:j.getUncaughtErrorMessage()}}});i.allowCreditCardChannelEvents();}.bind(this)).send();},getTransactions:function(ma){ma=ma||{};var na={},oa=ma,pa=(fa.getURIBuilder()).getURI(),qa=new o(oa);if(oa.since)na.since=oa.since;return new g().setData(na).setURI(pa).setMethod('GET').setReadOnly(true).setHandler(function(ra){var sa=ra.getPayload();if(!sa.error){i.updateTransfers(sa);}else i.updateTransfersError(Object.assign({requestID:qa.requestID},sa));}.bind(this)).setErrorHandler(function(){i.updateTransfersError({error:{message:j.getUncaughtErrorMessage()},requestID:qa.requestID});}.bind(this)).send();},getNUXTransactions:function(){var ma=(new Date()),na=Math.round((ma.setDate(ma.getDate()-15))/1000),oa=(fa.getURIBuilder()).getURI();return new g().setData({since:na}).setURI(oa).setMethod('GET').setReadOnly(true).setHandler(function(pa){var qa=pa.getPayload();if(!qa.error)i.updateNUXTransfers(qa);}.bind(this)).send();},updatePresetCreditCard:function(ma){var na=(da.getURIBuilder()).getURI();new g().setData(ma).setURI(na).setMethod('POST').setHandler(function(oa){var pa=oa.getPayload();if(!pa.error){i.updatePresetCreditCard(Object.assign({},pa,{requestID:ma.requestID}));i.transferAccepted();}else i.updatePresetCreditCardError(Object.assign({},pa,{requestID:ma.requestID}));}.bind(this)).setErrorHandler(function(){i.updatePresetCreditCardError({error:{message:j.getUncaughtErrorMessage()},requestID:ma.requestID});}.bind(this)).send();},updateCreditCard:function(ma){i.ignoreCreditCardChannelEvents();var na=(w.getURIBuilder()).getURI().getPath(),oa=new q('/ajax/payment/token_proxy.php').addQueryData('tpe',na);ma=j.prepareCardMutationData(ma);var pa=new o(ma);new g().setData(ma).setMethod('POST').setURI(oa).setHandler(function(qa){var ra=qa.getPayload();if(!ra.errors){i.updateCreditCard(pa);}else i.updateCreditCardError(Object.assign({},ra,{requestID:pa.requestID}));i.allowCreditCardChannelEvents();}.bind(this)).setErrorHandler(function(){i.updateCreditCardError({errors:{general:{message:j.getUncaughtErrorMessage()}},requestID:pa.requestID});i.allowCreditCardChannelEvents();}.bind(this)).send();},deleteCreditCard:function(ma){var na=(v.getURIBuilder()).getURI();new g().setData(ma).setMethod('POST').setURI(na).setHandler(function(oa){var pa=oa.getPayload();if(!pa.error){i.deleteCreditCard(Object.assign({},pa,{requestID:ma.requestID}));}else i.deleteCreditCardError(Object.assign({},pa,{requestID:ma.requestID}));}.bind(this)).setErrorHandler(function(){i.deleteCreditCardError({error:{message:j.getUncaughtErrorMessage()},requestID:ma.requestID});}.bind(this)).send();},getPasswordProtectionSetting:function(ma){var na=(ba.getURIBuilder()).getURI(),oa=ma.success||ja,pa=ma.error||ja;new g().setURI(na).setMethod('GET').setReadOnly(true).setHandler(function(qa){var ra=qa?qa.getPayload():[];if(ra.error){pa();}else oa(ra);}.bind(this)).setErrorHandler(function(){pa();}.bind(this)).send();},setPasswordProtectionSetting:function(ma){var na=(ca.getURIBuilder()).getURI(),oa=ma.formData,pa=ma.success||ja,qa=ma.error||ja,ra={};ra[l.STATUS]=oa[l.STATUS];new g().setData(ra).setURI(na).setMethod('POST').setHandler(function(sa){var ta=sa?sa.getPayload():{};if(ta.error){qa(ta.error);}else pa();}.bind(this)).setErrorHandler(function(){qa();}.bind(this)).send();},declineTransaction:function(ma){var na=(ga.getURIBuilder()).getURI(),oa=ma.formData,pa=ma.success||ja,qa=ma.error||ja,ra={};ra[n.TRANSFER_ID]=oa[n.TRANSFER_ID];new g().setData(ra).setURI(na).setMethod('POST').setHandler(function(sa){var ta=sa?sa.getPayload():{},ua={};if(ta.error){qa(ta.error);}else{pa();ua[n.TRANSFER_ID]=ra[n.TRANSFER_ID];i.transferDeclined(ua);}}.bind(this)).setErrorHandler(function(){qa();}.bind(this)).send();},cancelTransaction:function(ma){var na=(ha.getURIBuilder()).getURI(),oa=ma.formData,pa=ma.success||ja,qa=ma.error||ja,ra={};ra[n.TRANSFER_ID]=oa[n.TRANSFER_ID];new g().setData(ra).setURI(na).setMethod('POST').setHandler(function(sa){var ta=sa?sa.getPayload():{};if(ta.error){qa(ta.error);}else pa();}.bind(this)).setErrorHandler(function(){qa();}.bind(this)).send();},verifyCreditCard:function(ma){var na=(y.getURIBuilder()).getURI().getPath(),oa=new q('/ajax/payment/token_proxy.php').addQueryData('tpe',na);new g().setData(ma).setMethod('POST').setURI(oa).setHandler(function(pa){var qa=pa.getPayload();if(!qa.error){i.verifyCreditCard(Object.assign({},qa,{requestID:ma.requestID}));}else i.verifyCreditCardError(Object.assign({},qa,{requestID:ma.requestID}));}.bind(this)).setErrorHandler(function(){i.verifyCreditCardError({error:{message:j.getUncaughtErrorMessage()},requestID:ma.requestID});}.bind(this)).send();},validateBINNumber:function(ma){ma=ma||{};var na=new o(ma),oa=(u.getURIBuilder()).setString('bin_number',ma.binNumber).getURI();return new g().setURI(oa).setMethod('GET').setReadOnly(true).setHandler(function(pa){var qa=pa.getPayload();if(!qa.error){i.binNumberValidated(Object.assign({},qa,{requestID:ma.requestID}));}else i.binNumberValidatedError(Object.assign({},qa,{requestID:na.requestID}));}.bind(this)).send();},getUserEligibility:function(ma){ma=ma||{};var na=(ia.getURIBuilder()).setStringVector('user_ids',ma.userIDs).getURI();return new g().setURI(na).setMethod('GET').setReadOnly(true).setHandler(function(oa){var pa=oa.getPayload();if(!pa.error)i.userEligibilityUpdated(pa);}.bind(this)).send();},getBannerStates:function(){var ma=(s.getURIBuilder()).getURI();new g().setURI(ma).setMethod('GET').setReadOnly(true).setHandler(function(na){var oa=na.getPayload();if(!oa.error)i.bannerStatesUpdated(oa);}.bind(this)).send();},incrementBannerViews:function(ma){if(!ka.has(ma)){ka.add(ma);var na=(t.getURIBuilder()).setString('banner_type',ma).getURI();new g().setMethod('POST').setURI(na).send();}},incrementBannerDismissals:function(ma){var na;i.bannerDismissed(ma);na=(r.getURIBuilder()).setString('banner_type',ma).getURI();new g().setMethod('POST').setURI(na).send();},createMoneypennyTransfer:function(ma){var na=(aa.getURIBuilder()).getURI();new g().setMethod('POST').setURI(na).setData({item_id:ma.item_id,credential_id:ma.credential_id,amount:ma.amount,external_request_id:ma.external_request_id}).setHandler(function(oa){var pa=oa.getPayload();if(!pa.error){i.moneypennyTransferCreated(Object.assign({},pa,{requestID:ma.requestID}));this.getAllCreditCards();}else i.moneypennyTransferCreatedError(Object.assign({},pa,{requestID:ma.requestID}));}.bind(this)).setErrorHandler(function(){i.moneypennyTransferCreatedError({error:{message:j.getUncaughtErrorMessage()},requestID:ma.requestID});}).send();}};e.exports=la;},null);
__d("P2PBannerStore",["EventEmitter","P2PActionConstants","P2PAPI","P2PDispatcher","invariant"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l,m={},n=false,o=false;for(var p in g)if(g.hasOwnProperty(p))r[p]=g[p];var q=g===null?null:g.prototype;r.prototype=Object.create(q);r.prototype.constructor=r;r.__superConstructor__=g;function r(){g.call(this);l=j.register(this.onEventDispatched.bind(this));}r.prototype.onEventDispatched=function(s){var t=s.type,u=s.data;switch(t){case h.BANNER_STATES_UPDATED:this.handleBannerStatesUpdated(u);this.emit('change');break;case h.BANNER_DISMISSED:this.handleBannerDismissed(u);this.emit('change');break;case h.BANNER_COMPLETED:this.handleBannerCompleted(u);this.emit('change');break;}};r.prototype.handleBannerStatesUpdated=function(s){n=true;m=s;};r.prototype.handleBannerDismissed=function(s){var t=this.getBannerState(s);t.hasBeenDismissed=true;};r.prototype.shouldShowBanner=function(s){var t;if(!o){i.getBannerStates();o=true;return false;}if(!n)return false;t=this.getBannerState(s);return (t.eligible&&!t.hasBeenDismissed);};r.prototype.handleBannerCompleted=function(s){var t=this.getBannerState(s);t.eligible=false;};r.prototype.getBannerState=function(s){var t=m[s];k(t);return t;};e.exports=new r();},null);
__d("P2PChatThreadBanner.react",["Image.react","Layout.react","P2PAPI","P2PLogger","P2PPaymentLoggerEvent","React","cx","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();'use strict';var o=h.FillColumn,p=h.Column,q=l,r=q.PropTypes,s=l.createClass({displayName:"P2PChatThreadBanner",propTypes:{bannerType:r.string.isRequired,bodyText:r.string,loggerEventFlow:r.string.isRequired,onClick:r.func,titleText:r.string.isRequired},componentDidMount:function(){this.log(k.UI_ACTN_CHAT_THREAD_BANNER_VIEWED,{});i.incrementBannerViews(this.props.bannerType);},log:function(t,u){j.log(t,Object.assign({www_event_flow:this.props.loggerEventFlow},u));},handleClick:function(t){t.stopPropagation();if(this.props.onClick)this.props.onClick();this.log(k.UI_ACTN_CHAT_THREAD_BANNER_CLICKED,{});i.incrementBannerDismissals(this.props.bannerType);},handleClose:function(t){t.stopPropagation();this.log(k.UI_ACTN_CHAT_THREAD_BANNER_DISMISSED,{});i.incrementBannerDismissals(this.props.bannerType);},render:function(){var t;if(this.props.bodyText)t=l.createElement("div",{className:"_1w2e"},this.props.bodyText);return (l.createElement("div",{className:"_1w2f",onClick:this.handleClick},l.createElement("div",{className:"_3jht",onClick:this.handleClose},l.createElement(g,{className:"_47dg",height:9,src:n('/images/p2p/chat-thread-banner-close.png'),width:9})),l.createElement(h,null,l.createElement(p,{className:"_1w2g"},l.createElement(g,{className:"_1w2h",height:15,src:n('/images/p2p/thread-banner-dollar.png'),width:15})),l.createElement(o,{className:"_1w2i"},l.createElement("div",{className:(("_1w2j")+(!!t?' '+"_1w2k":''))},this.props.titleText),t))));}});e.exports=s;},null);
__d("P2PChatThreadBannerContainer.react",["P2PActions","P2PBannerStore","P2PBannerType","P2PChatThreadBanner.react","P2PPaymentLoggerEventFlow","React","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n=l,o=n.PropTypes,p=l.createClass({displayName:"P2PChatThreadBannerContainer",propTypes:{threadID:o.string},getInitialState:function(){return {receiverNUXBannerShown:h.shouldShowBanner(i.RECEIVER_NUX),senderNUXBannerShown:h.shouldShowBanner(i.SENDER_NUX)};},bannerStoreSub:(null),componentDidMount:function(){this.bannerStoreSub=h.addListener('change',this.onBannerStoreChange);},componentWillUnmount:function(){if(this.bannerStoreSub){this.bannerStoreSub.remove();this.bannerStoreSub=null;}},onBannerStoreChange:function(){this.setState({receiverNUXBannerShown:h.shouldShowBanner(i.RECEIVER_NUX),senderNUXBannerShown:h.shouldShowBanner(i.SENDER_NUX)});},showSendMoneyDialog:function(){if(this.props.threadID)g.chatSendViewOpened({threadID:this.props.threadID});},renderReceiverNUXBanner:function(){return (l.createElement(j,{bannerType:i.RECEIVER_NUX,bodyText:m._("It's free and secure."),loggerEventFlow:k.UI_FLOW_RECEIVER_NUX_CHAT_THREAD_BANNER,key:"receiver_nux_banner",onClick:this.showSendMoneyDialog,titleText:m._("You Can Send Money to Friends!")}));},renderSenderNUXBanner:function(){return (l.createElement(j,{bannerType:i.SENDER_NUX,bodyText:m._("It's free and secure."),key:"sender_nux_banner",loggerEventFlow:k.UI_FLOW_SENDER_NUX_CHAT_THREAD_BANNER,onClick:this.showSendMoneyDialog,titleText:m._("Now You Can Send Money!")}));},render:function(){var q;if(this.state.senderNUXBannerShown){q=this.renderSenderNUXBanner();}else if(this.state.receiverNUXBannerShown)q=this.renderReceiverNUXBanner();return (l.createElement("div",null,q));}});e.exports=p;},null);
__d("P2PAbstractSendMoneyButton.react",["React","TooltipLink.react","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=g,l=k.PropTypes,m=g.createClass({displayName:"P2PAbstractSendMoneyButton",propTypes:{isDialogOpen:l.bool.isRequired,isDisabled:l.bool.isRequired,isMessenger:l.bool.isRequired,onClick:l.func.isRequired,onMouseOver:l.func,recipientName:l.string},_clickGuard:(false),render:function(){return (g.createElement(h,{alignH:"center",className:((this.props.isDialogOpen?"open":'')+(this.props.isDisabled?' '+"disabled":'')+(!this.props.isMessenger?' '+"_5uqy":'')+(this.props.isMessenger?' '+"_3ggc":'')),href:"#",onClick:this._handleClick,onMouseDown:this._prepareForClick,onMouseOver:this.props.onMouseOver,position:"above",title:this._getLinkTitle(),tooltip:this._getDisabledTitle()}));},_getLinkTitle:function(){if(this.props.isDisabled)return null;return (j._("Send Money"));},_getDisabledTitle:function(){if(!this.props.isDisabled)return null;return (j._("{receiverName} isn't able to receive money right now.",[j.param("receiverName",this.props.recipientName)]));},_prepareForClick:function(){this._clickGuard=this.props.isDialogOpen;},_handleClick:function(n){n.stopPropagation();if(this._clickGuard){this._clickGuard=false;return;}this.props.onClick();}});e.exports=m;},null);
__d("P2PSendMoneyButton.react",["BootloadedComponent.react","Bootloader","CurrentEnvironment","P2PAbstractSendMoneyButton.react","React","Run","emptyFunction"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n=k,o=n.PropTypes,p=i.messengerdotcom,q=k.createClass({displayName:"P2PSendMoneyButton",propTypes:{isNewEmptyLocalThread:o.bool,isGroupChat:o.bool,onTrigger:o.func,participants:o.arrayOf(o.object),threadID:o.string,threadFBID:o.string},getDefaultProps:function(){return {participants:[]};},render:function(){return (k.createElement(g,k.__spread({bootloadComponent:r,bootloadPlaceholder:this._renderPlaceholder()},this.props)));},_renderPlaceholder:function(){return (k.createElement(j,{isDialogOpen:false,isDisabled:true,isMessenger:p,onClick:m,onMouseOver:s,recipientName:this._getRecipientName()}));},_getRecipientName:function(){var t=this.props.participants;if(!this.props.isGroupChat&&t&&t.length>0)return t[0].short_name;return null;}});function r(t){l.onAfterLoad(function(){h.loadModules(["P2PSendMoneyButtonImpl.react"],t);});}function s(){h.loadModules(["P2PSendMoneyButtonImpl.react"],m);}e.exports=q;},null);
__d("XPagesMercuryIndicatorController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/pages\/messaging\/mercury\/indicator\/",{});},null);
__d("PagesMercuryChatTabIndicatorHandler",["AsyncRequest","FBID","MercuryIDs","XPagesMercuryIndicatorController"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();function k(l,m){"use strict";this.$PagesMercuryChatTabIndicatorHandler0=i.getUserIDFromThreadID(l);this.$PagesMercuryChatTabIndicatorHandler1=m;}k.prototype.checkResponsiveness=function(){"use strict";if(!this.$PagesMercuryChatTabIndicatorHandler0||h.isUser(this.$PagesMercuryChatTabIndicatorHandler0))return;var l=j.getURIBuilder().getURI();new g().setURI(l).setMethod('POST').setData({page_id:this.$PagesMercuryChatTabIndicatorHandler0}).setHandler(function(m){var n=m.payload;if(n.responsiveness)this.$PagesMercuryChatTabIndicatorHandler1(n.responsiveness);}.bind(this)).send();};e.exports=k;},null);
__d("SelectionPosition",["Event","InputSelection","SubscriptionsHandler"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();function j(k){"use strict";this.$SelectionPosition0=k;this.$SelectionPosition1={start:0,end:0};this.$SelectionPosition2=new i();this.$SelectionPosition3=false;this.updatePos();this.enable();}j.prototype.getPos=function(){"use strict";return Object.assign({},this.$SelectionPosition1);};j.prototype.setPos=function(k,l){"use strict";this.$SelectionPosition1={start:k,end:l};this.restore();};j.prototype.updatePos=function(){"use strict";this.$SelectionPosition1=h.get(this.$SelectionPosition0);};j.prototype.restore=function(){"use strict";h.set(this.$SelectionPosition0,this.$SelectionPosition1.start,this.$SelectionPosition1.end);};j.prototype.enable=function(){"use strict";if(!this.$SelectionPosition3){this.$SelectionPosition2.addSubscriptions(g.listen(this.$SelectionPosition0,'keyup',this.updatePos.bind(this)),g.listen(this.$SelectionPosition0,'click',this.updatePos.bind(this)));this.$SelectionPosition3=true;}};j.prototype.disable=function(){"use strict";if(this.$SelectionPosition3){this.$SelectionPosition2.release();this.$SelectionPosition3=false;}};e.exports=j;},null);
__d("XStickerReplyNUXController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/stickers\/tooltip\/",{});},null);
__d("ChatTabView",["Animation","AsyncDialog","AsyncRequest","AsyncSignal","AvailableList","AvailableListConstants","BanzaiODS","BootloadedComponent.react","Bootloader","ChatAddToThreadButton.react","ChatArchiveWarning.react","ChatBehavior","ChatCloseButton.react","ChatConfig","ChatEmployeeAwayWarning","ChatOpenTab","ChatPhotoUploader.react","ChatPrivacyActionController","ChatQuietLinks","ChatStickerButton.react","ChatStickerTriggerController","ChatTabActions","ChatTabMenu.react","ChatTabMessagesView","ChatTabOfficeStatus","ChatTabSheetController","ChatTabViewEvents","ChatTabViewInstances","ChatTitleLink.react","ChatVisibility","ChatVideoCallButton.react","MercuryConstants","CurrentUser","CSS","CurrentLocale","Dialog","Dock","DOM","DOMEvent","DOMQuery","DragDropTarget","EmoticonsList","EmoticonUtils","Event","FBRTCCallabilityStore","FBID","Focus","ImmutableObject","Input","Keys","Locale","LogHistory","MercuryConfig","MercuryIDs","MercuryLogMessageType","MercuryMessengerBlockingUtils","MercuryParticipants","MercuryShareAttachmentRenderLocations","MercurySharePreview.react","MercurySourceType","MercuryThreadInfo","MercuryThreadMetadataRawRenderer","MercuryTypingAnimation.react","MercuryViewer","MessengerHotLikeButton.react","MessagingTag","NubController","P2PChatThreadBannerContainer.react","P2PGKValues","P2PSendMoneyButton.react","PagesMercuryChatTabIndicatorHandler","Parent","PhotosUploadWaterfall","PresenceStatus","Promise","React","Run","Scroll","SelectionPosition","StickerActions","StickerConfig","StickerConstants","StickerState","Style","SubscriptionsHandler","SyntheticMouseEvent","ChatTabTemplates","TextAreaControl","Toggler","Tooltip","TypingDetectorController","URLScraper","URI","UserAgent_DEPRECATED","WaterfallIDGenerator","WebMessengerDeleteThreadDialog","WebMessengerThreadPermalinks","NFXChatHeadGK","XNFXStartForMessageThreadController","XStickerReplyNUXController","XUISpinner.react","cancelAnimationFrame","copyProperties","createCancelableFunction","csx","cx","emptyFunction","fbt","getActiveElement","isEmpty","requestAnimationFrame","requireWeak","setIntervalAcrossTransitions","ChatReactInput","MercuryTypingReceiver","MercuryMessageActions","MercuryMessages","MercuryMessageObject","MercuryThreadIDMap","MercuryServerRequests","MercuryThreadInformer","MercuryThreadMetadataRenderer","MercuryThreadActions","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,va,wa,xa,ya,za,ab,bb,cb,db,eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb,sb,tb,ub,vb,wb,xb,yb,zb,ac,bc,cc,dc,ec,fc,gc,hc,ic,jc,kc,lc,mc,nc,oc,pc,qc,rc,sc,tc,uc,vc,wc,xc,yc,zc,ad,bd,cd,dd,ed,fd,gd,hd,id,jd,kd,ld,md,nd,od){b.__markCompiled&&b.__markCompiled();'use strict';var pd=b('ChatReactInput').module,qd=b('MercuryTypingReceiver').get(),rd=b('MercuryMessageActions').get(),sd=b('MercuryMessages').get(),td=b('MercuryMessageObject').get(),ud=b('MercuryThreadIDMap').get(),vd=b('MercuryServerRequests').get(),wd=b('MercuryThreadInformer').get(),xd=b('MercuryThreadMetadataRenderer').get(),yd=b('MercuryThreadActions').get(),zd=b('MercuryThreads').get(),ae,be=new cc(function(df){nd(['P2PTransferStore'],function(ef){ae=ef;df(ef);});}),ce=/^\s*$/,de=ha,ee,fe=10,ge=960,he=fb.getInstance('chat_tab_view');function ie(df,ef){var ff=ra.create('div');ef=ef&&ef.filter(function(jf){return jf!=rb.getID();});if(ld(ef))return rc.remove(df);var gf=ef.length,hf=gf-fe;if(hf>1)ef=ef.slice(0,fe);kb.getMulti(ef,function(jf){for(var kf in jf){var lf=jf[kf],mf=oc[':fb:mercury:chat:multichat-tooltip-item'].build();ra.setContent(mf.getNode('name'),lf.name);var nf=hb.getUserIDFromParticipantID(kf),of=nf&&bc.get(nf)==l.ACTIVE;na.conditionShow(mf.getNode('icon'),of);na.conditionClass(mf.getNode('name'),'tooltipItemWithIcon',of);ra.appendContent(ff,mf.getRoot());}if(hf>1){var pf=jd._("and {number of hidden chat participants} more.",[jd.param("number of hidden chat participants",hf)]);ra.appendContent(ff,ra.create('div',{},pf));}rc.set(df,ff,'above');});}var je={},ke=null,le=false;function me(df,ef,ff){if(ff){je[df]=ef;if(!ke)ke=od(ne,600);}else{na.removeClass(ef,'highlightTitle');delete je[df];}}function ne(){for(var df in je){var ef=je[df];if(ef.parentNode){na.conditionClass(ef,'highlightTitle',le);}else delete je[df];}le=!le;if(!Object.keys(je).length){clearInterval(ke);ke=null;}}function oe(df){var ef=hb.tokenize(df);switch(ef.type){case 'user':return oc[':fb:mercury:chat:user-tab'].build();}return oc[':fb:mercury:chat:multichat-tab'].build();}function pe(df){var ef=df._getInputValue(),ff=df._fileUploader.getAttachments();if(ve(df))re(df,ef,ff,function(gf){var hf=df._fileUploader.getImageFiles();if(hf.length>0){gf.image_ids=hf;gf.has_attachment=true;}var jf=df._fileUploader.getAnimatedImageFiles();if(jf.length>0){gf.gif_ids=jf;gf.has_attachment=true;}var kf=df._fileUploader.getVideoFiles();if(kf.length>0){gf.video_ids=kf;gf.has_attachment=true;}var lf=df._fileUploader.getAudioFiles();if(lf.length>0){gf.audio_ids=lf;gf.has_attachment=true;}var mf=df._fileUploader.getFiles();if(mf.length>0){gf.file_ids=mf;gf.has_attachment=true;}rd.send(gf,function(nf){var of=zd.getThreadMetaNow(nf);if(gb.CoreGraphEnabled&&of&&of.folder===tb.PENDING)yd.movePendingToInbox(nf);});df._fileUploader.removeAttachments();if(df._sharePreview)df._sharePreview.setProps({share:null,uri:null});if(!t.get('chat_react_input'))df._getNode('input').value='';df._typingDetector&&df._typingDetector.resetState();df._messagesView&&df._messagesView.setShouldScrollToBottom(true);});}function qe(df,ef){if(ef===0)return;xe(df,ac.POST_PUBLISHED,{count:ef});df._waterfallID=wc.generate();}function re(df,ef,ff,gf){zd.getThreadMeta(df._threadID,function(hf){var jf=nb.CHAT_WEB,kf=td.constructUserGeneratedMessageObject(ef,jf,df._threadID);if(ff.length>0){kf.has_attachment=true;kf.raw_attachments=ff;}if(df._sharePreview){var lf=df._sharePreview.getShareData();if(lf){kf.has_attachment=true;kf.shareable_attachment=lf;}}if(zd.isNewEmptyLocalThread(df._threadID)){var mf=df._sheetController.getAddFriendsParticipants();df._sheetController.closeAddFriendsSheet();if(mf===null||mf.length===0)return;mf=mf.filter(function(pf){return pf!=rb.getID();});if(mf.length===0){kf.thread_id=hb.getThreadIDFromUserID(ma.getID());}else if(mf.length===1){kf.thread_id=hb.getThreadIDFromParticipantID(mf[0]);}else yd.addParticipants(df._threadID,mf);}if(zd.isEmptyLocalThread(df._threadID)){kf.message_id=hb.tokenize(df._threadID).value;var nf=zd.getThreadMetaNow(hf.thread_id);kf.specific_to_list=Array.from(nf.participants);}if(typeof kf!='undefined')kf.signatureID=df._signatureID;kf.ui_push_phase=la.UIPushPhase;gf(kf);if(df._threadID!==kf.thread_id&&!df._photoUploader.isUploading()){var of=df._getInputValue();ba.closeTab(df._threadID);v.openThread(kf.thread_id,'ChatTabView',null,ef?id:function(pf){return pf.appendTextToInput(of);});}});}function se(df){df._blocked=true;df._sheetController.openUploadWarningTabSheet();}function te(df){return (df._fileUploader.isUploading()||df._photoUploader.isUploading()||(df._sharePreview&&df._sharePreview.isLoading()));}function ue(df){return (df._fileUploader&&df._fileUploader.isUploading());}function ve(df){var ef=df._getInputValue();if(!ce.test(ef))return true;if(df._fileUploader.getAttachments().length>0||df._fileUploader.getImageFiles().length>0||df._fileUploader.getAnimatedImageFiles().length>0||df._fileUploader.getVideoFiles().length>0||df._fileUploader.getAudioFiles().length>0||df._fileUploader.getFiles().length>0)return true;if(df._sharePreview&&df._sharePreview.getShareData())return true;return false;}function we(df){df._nubController.flyoutContentChanged();var ef=df._getNode('attachmentShelf');fc.setTop(ef,ef.scrollHeight);}function xe(df,ef,ff){ac.sendSignal(ed({qn:df._waterfallID,step:ef,uploader:ac.APP_CHAT},ff||{}));}function ye(df,ef,ff,gf,hf){var jf,kf,lf;if(ef)vd.ensureThreadIsFetched(ef);this._threadID=df;this._signatureID=ff;this._eventListeners=[];this._tabTemplate=oe(df);this._tabElem=this._tabTemplate.getRoot();if(hf&&hf.getTabElem()){this.insertBefore(hf);}else this.appendTo(gf);this._stickersFlyoutShown=false;this._messagesView=null;this._titlebar=this._getNode('nubFlyoutTitlebar');this._iconsContainerNode=this._getNode('iconsContainer');this._inputContainerNode=this._getNode('inputContainer');this._pagesMessageIndicator=this._getNode('pagesMessageIndicator');this._waterfallID=wc.generate();this._subscriptionsHandler=new mc();this._initializeSheetController();var mf=[id,this._initializeHotLike.bind(this),this._initializeHeader.bind(this),this._initializeUIListeners.bind(this),this._initializeAutoSendPhotoUploader.bind(this),this._initializeTitleHREF.bind(this),this._initializeP2P.bind(this),this._initializeInput.bind(this),this._initializeStickers.bind(this),function(){zd.getThreadMeta(this._threadID,function(pf){this._setUpMutingSettings(pf);this._setUpMessageBlockStatus(pf);}.bind(this));y.removeEmptyHrefs(this._tabElem);}.bind(this),function(){this.updateAvailableStatus();this.updateTab();this._setCloseTooltip(false);}.bind(this),this._initializeUnloadListeners.bind(this),this._initializeDragDropTarget.bind(this),this._initializePageMessagingIndicator.bind(this),this._initializeP2PChatThreadBannerContainer.bind(this)];be.then(this._onP2PTransferStoreLoaded.bind(this));if(t.get('chat_defer_initialization',false)){var nf=function(pf){if(!pf.length){delete this._initFrame;return;}var qf=pf.shift();this._initFrame=md(function(){nf(pf);});qf();}.bind(this);nf(mf);}else{var of;for(jf=mf,kf=Array.isArray(jf),lf=0,jf=kf?jf:jf[typeof Symbol=="function"?Symbol.iterator:"@@iterator"]();;){if(kf){if(lf>=jf.length)break;of=jf[lf++];}else{lf=jf.next();if(lf.done)break;of=lf.value;}of();}}de.set(df,this);this._logOpenTab();}function ze(df){if(df._photoUploader.isUploading())xe(df,ac.CANCEL_DURING_UPLOAD);}function af(){var df,ef,ff,gf;for(df=de.values(),ef=Array.isArray(df),ff=0,df=ef?df:df[typeof Symbol=="function"?Symbol.iterator:"@@iterator"]();;){if(ef){if(ff>=df.length)break;gf=df[ff++];}else{ff=df.next();if(ff.done)break;gf=ff.value;}gf.updateAvailableStatus();gf.updateMultichatTooltip();}}function bf(){var df,ef,ff,gf;for(df=de.values(),ef=Array.isArray(df),ff=0,df=ef?df:df[typeof Symbol=="function"?Symbol.iterator:"@@iterator"]();;){if(ef){if(ff>=df.length)break;gf=df[ff++];}else{ff=df.next();if(ff.done)break;gf=ff.value;}gf.updateCallLink();}}k.subscribe(l.ON_AVAILABILITY_CHANGED,af);ya.addListener(bf);r.subscribe(r.ON_CHANGED,function(){var df,ef,ff,gf;for(df=de.keys(),ef=Array.isArray(df),ff=0,df=ef?df:df[typeof Symbol=="function"?Symbol.iterator:"@@iterator"]();;){if(ef){if(ff>=df.length)break;gf=df[ff++];}else{ff=df.next();if(ff.done)break;gf=ff.value;}zd.getThreadMeta(gf,function(hf){de.get(gf)._updateUnreadCount(hf);});}});qd.addRetroactiveListener('state-changed',function(df){for(var ef in df){var ff=df[ef]&&df[ef].length,gf=de.get(ef);gf&&gf.showTypingIndicator(ff);}});wd.subscribe('threads-updated',function(df,ef){var ff,gf,hf,jf;for(ff=de.keys(),gf=Array.isArray(ff),hf=0,ff=gf?ff:ff[typeof Symbol=="function"?Symbol.iterator:"@@iterator"]();;){if(gf){if(hf>=ff.length)break;jf=ff[hf++];}else{hf=ff.next();if(hf.done)break;jf=hf.value;}var kf=de.get(jf);ef[jf]&&kf.updateTab();if(kf._newThreadIDFromPhotoUpload&&!kf._photoUploader.isUploading()&&ef[kf._newThreadIDFromPhotoUpload]){ba.closeTab(kf._threadID);v.openThread(kf._newThreadIDFromPhotoUpload,'ChatTabView');kf._newThreadIDFromPhotoUpload=null;}}});wd.subscribe('threads-deleted',function(df,ef){var ff,gf,hf,jf;for(ff=de.keys(),gf=Array.isArray(ff),hf=0,ff=gf?ff:ff[typeof Symbol=="function"?Symbol.iterator:"@@iterator"]();;){if(gf){if(hf>=ff.length)break;jf=ff[hf++];}else{hf=ff.next();if(hf.done)break;jf=hf.value;}ef[jf]&&ba.closeTab(jf,'thread_deleted');}});Object.assign(ye.prototype,{getThreadID:function(){return this._threadID;},getTabElem:function(){return this._tabElem;},showAddFriend:function(){setTimeout((function(){this._sheetController.openAddFriendsSheet();}).bind(this),0);},showNameConversation:function(df){setTimeout((function(){this._sheetController.openNameConversationSheet(df);}).bind(this),0);},hideAutomaticNameConversation:function(){setTimeout((function(){this._sheetController.closeAutomaticNameConversationSheet();}).bind(this),0);},isVisible:function(){return na.shown(this._tabElem);},setVisibleState:function(df,ef){var ff=na.shown(this._tabElem),gf=na.hasClass(this._tabElem,'opened');na.conditionShow(this._tabElem,df);na.conditionClass(this._tabElem,'opened',ef);if(!(ff&&gf)&&df&&ef){if(!this._messagesView){var hf=hb.tokenize(this._threadID);this._messagesView=new da(this._threadID,this._sheetController,this._getNode('scrollingArea'),this._getNode('conversation'),this._getNode('loadingIndicator'),this._getNode('lastMessageIndicator'),this._getNode('typingIndicator'),this,gb.CoreGraphEnabled&&gb.ShowContextBanner&&hf.type==='user');}this._nubController.flyoutContentChanged();this._messagesView.scrollToBottom();}},focus:function(){if(na.hasClass(this._tabElem,'opened')){this._focusInput();}else this._getNode('dockButton').focus();},isFocused:function(){var df=kd();return zb.byClass(df,"_50mz")===this._tabElem;},hasEmptyInput:function(){var df;if(t.get('chat_react_input')){if(!this._chatInput||!this._chatInput.isMounted())return false;df=this._chatInput.getValue();}else df=this._getNode('input').value;return ce.test(df);},getInputElem:function(){if(t.get('chat_react_input')){if(!this._chatInput||!this._chatInput.isMounted())return null;return dc.findDOMNode(this._chatInput);}else return this._getNode('input');},setStickersFlyoutPackID:function(df){if(this._stickerButton){this._setPackIDReact(df);}else this._setPackIDLegacy(df);},loadShareFromParams:function(df,ef){if(this._sharePreview)this._sharePreview.setProps({share:{params:ef,type:df},uri:null});},_linkDropped:function(df){if(this._sharePreview)this._sharePreview.setProps({share:null,uri:df});},_filesDropped:function(df){if(this._fileUploader)this._fileUploader.addDroppedFiles(df);},_setPackIDLegacy:function(df){var ef=this._stickersFlyout;if(!this._stickersFlyoutToggler||!ef||!ef.isMounted())return;hc.selectPack(df);this._toggleStickersFlyoutShownLegacy(true);},_setPackIDReact:function(df){if(!this._stickerButton.isMounted())return;hc.selectPack(df);this._toggleStickersFlyoutShownReact(true);},_toggleStickersFlyoutShownReact:function(df){this._stickerButton.showFlyout();this._stickersFlyoutShown=df;},_toggleStickersFlyoutShownLegacy:function(df){if(df){qc.show(this._stickersFlyoutToggler);}else qc.hide(this._stickersFlyoutToggler);this._stickersFlyoutShown=df;},_hideStickersFlyoutIfShown:function(){if(this._stickersFlyoutToggler&&this._stickersFlyout&&this._stickersFlyoutShown)this._toggleStickersFlyoutShownLegacy(false);},showStickerReplyNUX:function(){if(ee)return;var df=this._getNode('stickerButtonContainer')||this._getNode('emoticons');new i(bd.getURIBuilder().getURI()).setRelativeTo(df).setData({thread_id:this._threadID}).setHandler(function(ef){kc.clearShowStickerReplyNUX();}).send();},insertBefore:function(df){ra.insertBefore(df.getTabElem(),this._tabElem);},appendTo:function(df){ra.appendContent(df,this._tabElem);},nextTabIs:function(df){var ef=df&&df.getTabElem();return this._tabElem.nextSibling==ef;},getScrollTop:function(){return fc.getTop(ra.find(this._tabElem,'.fbNubFlyoutBody.scrollable'));},setScrollTop:function(df){fc.setTop(ra.find(this._tabElem,'.fbNubFlyoutBody.scrollable'),df);},_unmountComponentAtNodeSafe:function(df){var ef=this._getNode(df);ef&&dc.unmountComponentAtNode(ef);},destroy:function(){this._initFrame&&dd(this._initFrame);this._selectionPosition&&this._selectionPosition.disable();while(this._eventListeners.length)this._eventListeners.pop().remove();if(this._dropTarget)this._dropTarget.disable();this._checkUnsentMessages&&this._checkUnsentMessages.cancel();this._logUnsentPhotos&&this._logUnsentPhotos.cancel();this._messagesView&&this._messagesView.destroy();this._sheetController&&this._sheetController.destroy();dc.unmountComponentAtNode(this._getNode('animationContainer'));dc.unmountComponentAtNode(this._getNode('menuContainer'));if(t.get('chat_react_header')){dc.unmountComponentAtNode(this._getNode('addToThreadContainer'));this._unmountComponentAtNodeSafe('archiveContainer');this._unmountComponentAtNodeSafe('videoCallButtonContainer');dc.unmountComponentAtNode(this._getNode('closeButtonContainer'));dc.unmountComponentAtNode(this._getNode('titleContainer'));}if(this._sharePreview&&this._sharePreview.isMounted())dc.unmountComponentAtNode(dc.findDOMNode(this._sharePreview));try{dc.unmountComponentAtNode(this._getNode('photoUploaderContainer'));}catch(df){m.bumpEntityKey('chat.web','chattab.unmount_failed');}if(t.get('chat_react_sticker_button')){dc.unmountComponentAtNode(this._getNode('stickerButtonContainer'));}else dc.unmountComponentAtNode(this._getNode('stickers'));if(this._stickerTriggerController)this._stickerTriggerController.destroy();this._subscriptionsHandler&&this._subscriptionsHandler.release();if(t.get('chat_react_input')){dc.unmountComponentAtNode(this._getNode('inputContainer'));}else cb.reset(this._getNode('input'));if(this._getNode('hotLikeContainer'))dc.unmountComponentAtNode(this._getNode('hotLikeContainer'));if(this._orionTriggerContainer){dc.unmountComponentAtNode(this._orionTriggerContainer);this._orionTriggerContainer=null;this._orionTrigger=null;}if(this._p2pChatThreadBannerContainer){dc.unmountComponentAtNode(this._p2pChatThreadBannerContainer);this._p2pChatThreadBannerContainer=null;}this._unsubscribeP2PTransferStore();ra.remove(this._tabElem);de["delete"](this._threadID);qa.unregisterNubController(this._nubController);},updateAvailableStatus:function(){zd.getThreadMeta(this._threadID,function(df){var ef=l.OFFLINE,ff=this._getCanonicalUserID();if(ff){ef=bc.get(ff);}else{var gf=df.participants.map(function(jf){return hb.getUserIDFromParticipantID(jf);});ef=bc.getGroup(gf);}if(!ja.isOnline())ef=l.OFFLINE;this.updateCallLink();na.conditionClass(this._tabElem,"_5238",ef===l.ACTIVE);na.conditionClass(this._tabElem,"_5239",ef===l.MOBILE);var hf=this._getNode('presenceIndicator');switch(ef){case l.ACTIVE:hf.setAttribute('alt',jd._("Online"));break;case l.MOBILE:hf.setAttribute('alt',jd._("Mobile"));break;default:hf.removeAttribute('alt');break;}}.bind(this));},updateTab:function(){zd.getThreadMeta(this._threadID,function(df){var ef=[this._getNode('name')];if(!t.get('chat_react_header')){ef.push(this._getNode('titlebarText'));}else if(this._title.isMounted())this._title.setProps({thread:df},function(){this._getNode('chatWrapper').setAttribute('aria-label',this._title.getTitle());}.bind(this));xd.renderAndSeparatedParticipantList(this._threadID,ef,{names_renderer:pb.renderShortNames,check_length:true});this._updateControls(df);this._updateMessageBlockSettings(df);this._updateMutingSettings(df);this._updateUnreadCount(df);this.updateMultichatTooltip();this._updateArchiveWarning(df);this._updateEmployeeAwayWarning(df);this._updateOfficeStatus(df);this._updateNewThread(df);this._updateNameConversationSheet(df);this._updateReadOnlySheet(df);this._updateSwitchToWork(df);}.bind(this));},_updateNameConversationSheet:function(df){if(ob.canReply(df)&&!df.name&&!df.is_canonical&&!df.name_conversation_sheet_dismissed&&!df.has_email_participant&&!df.read_only&&!zd.isEmptyLocalThread(df.thread_id)){this.showNameConversation(true);}else this.hideAutomaticNameConversation();},_updateReadOnlySheet:function(df){var ef=ob.canReply(df),ff=zd.isEmptyLocalThread(df.thread_id);if(!ef&&!ff)this._sheetController.openReadOnlySheet();},updateSignatureID:function(df){this._signatureID=df;},_updateMessageBlockSettings:function(df){this._setUpMessageBlockStatus(df);},_setUpMutingSettings:function(df){var ef=ob.isMuted(df);if(ef)this._sheetController.openThreadIsMutedTabSheet();this._updateActionMenu(ef);},_updateMutingSettings:function(df){var ef=ob.isMuted(df),ff=this._reactChatTabMenu.props.isMuted;if(ef&&!ff){this._sheetController.openThreadIsMutedTabSheet();}else if(!ef&&ff)this._sheetController.closeThreadIsMutedTabSheet();this._updateActionMenu(ef);},_updateActionMenu:function(df){this._reactChatTabMenu.isMounted()&&this._reactChatTabMenu.setProps({isMuted:df});},_setUpMessageBlockStatus:function(df){this._reactChatTabMenu.setProps({hasMessageBlocked:df.message_blocked});if(df.message_blocked){this._sheetController.openMessageBlockedTabSheet();}else this._sheetController.closeMessageBlockedTabSheet();},_updateArchiveWarning:function(df){if(ma.isEmployee())kb.getMulti(df.participants,this._showArchiveWarningIfAllParticipantsAreEmployees.bind(this));},_updateEmployeeAwayWarning:function(df){u.updateEmployeeAwayWarning(df,function(){this._sheetController.openEmployeeAwaySheet();}.bind(this),function(){});},_updateOfficeStatus:function(df){var ef=this._getNode('officeStatus');if(!ef||hb.isGroupChat(df.thread_id))return;var ff=hb.getParticipantIDFromUserID(df.canonical_fbid);kb.get(ff,function(gf){ea.update(ef,gf);});},_updateSwitchToWork:function(df){if(ma.isEmployee()&&ma.hasWorkUser()&&hb.isGroupChat(df.thread_id)){kb.getMulti(df.participants,function(ef){this._showSwitchToWork(this._isEmployeesOnly(ef));}.bind(this));}else this._showSwitchToWork(false);},_updateControls:function(df,ef){var ff=false;if(df&&df.thread_id){var gf=hb.tokenize(df.thread_id);if(gf.type==='user'){var hf=gf.value;ff=!za.isUser(hf);}}var jf=ob.canReply(df)&&(!ld(df.participants)||!!ef);na.conditionShow(this._inputContainerNode,jf);na.conditionShow(this._iconsContainerNode,jf);if(this._reactChatTabMenu.isMounted()){this._reactChatTabMenu.setProps({isEmptyChat:zd.isNewEmptyLocalThread(df.thread_id),show:jf});if(ff)this._reactChatTabMenu.setProps({showAddFriend:null});}var kf=jf&&!ff;if(t.get('chat_react_header')){this._addToThreadButton.isMounted()&&this._addToThreadButton.setProps({shown:kf});}else na.conditionShow(this._getNode('addToThreadLink'),kf);this._resizeInputContainer();this._updateOrionTrigger(kf);},_updateOrionTrigger:function(df){if(df)if(this._orionTrigger){this._setOrionTriggerProps();}else if(!this._orionTrigger)this._renderOrionTrigger();},_setOrionTriggerProps:function(){this.getParticipantIDsForOrionNUX(function(df,ef){kb.getMulti(df,function(ff){var gf=[],hf,jf=zd.isNewEmptyLocalThread(this._threadID);for(var kf in ff){hf=this._getUserIdFromParticipantID(kf);if(hf!==ma.getID())gf.push(bb.set(ff[kf],{userID:hf}));}this._orionTrigger.setProps({participants:gf,isNewEmptyLocalThread:jf,isGroupChat:hb.isGroupChat(this._threadID)&&!jf,threadID:this._threadID,threadFBID:ef});}.bind(this));}.bind(this));},_getUserIdFromParticipantID:function(df){return hb.getUserIDFromParticipantID(df);},_onP2PTransferStoreChange:function(){this._renderOrionTrigger();if(this._canP2PSend())this._unsubscribeP2PTransferStore();},_unsubscribeP2PTransferStore:function(){if(this._transferStoreSub){this._transferStoreSub.remove();this._transferStoreSub=null;}},_isP2PEnabled:function(){return wb.P2PEnabled;},_canP2PSend:function(){return (this._isP2PEnabled()||(ae&&ae.hasTransfers())||(ae&&ae.hasAccepted()));},_renderOrionTrigger:function(){if(hb.isGroupChat(this._threadID)&&!wb.P2PGroupSendWWW)return false;if(this._canP2PSend()){this._orionTriggerContainer=this._getNode('orionTriggerContainer');this._orionTrigger=dc.render(dc.createElement(xb,{onTrigger:this._orionTriggered.bind(this)}),this._orionTriggerContainer);na.addClass(this._inputContainerNode,"_11d6");this._setOrionTriggerProps();}},getParticipantIDsForOrionNUX:function(df){var ef=this._sheetController.getAddFriendsParticipants(),ff=this._getCanonicalUserID();if(ff){df([hb.getParticipantIDFromUserID(ff)]);}else if(zd.isNewEmptyLocalThread(this._threadID)&&ef){df(ef);}else zd.getThreadMeta(this._threadID,function(gf){df(gf.participants,gf.thread_fbid);}.bind(this));},_resizeInputContainer:function(){var df=this._tabElem.clientWidth,ef=2,ff=df-(this._inputContainerNode.clientWidth+ef),gf=eb.isRTL()?'left':'right';lc.set(this._iconsContainerNode,gf,ff+'px');if(!t.get('chat_react_input'))pc.getInstance(this._getNode('input')).update();},_updateNewThread:function(df){if(zd.isNewEmptyLocalThread(df.thread_id))this.showAddFriend();},_isEmployeesOnly:function(df){for(var ef in df)if(!df[ef].employee)return false;return true;},_showArchiveWarningIfAllParticipantsAreEmployees:function(df){var ef=this._isEmployeesOnly(df),ff=t.get('chat_react_header'),gf=ff?this._getNode('archiveContainer'):this._getNode('titanArchiveWarning');if(gf){if(this._titlebarTooltipAnchor)na.conditionClass(this._titlebarTooltipAnchor,'narrowTitleBar',ef);if(ff){this._archiveWarning.isMounted()&&this._archiveWarning.setProps({shown:ef});}else na.conditionShow(gf,ef);}},_showSwitchToWork:function(df){if(this._reactChatTabMenu.isMounted())this._reactChatTabMenu.setProps({hasSwitchToWork:df});},updateMultichatTooltip:function(){zd.getThreadMeta(this._threadID,function(df){if(!df.is_canonical){var ef;if(t.get('chat_react_header')){ef=dc.findDOMNode(this._title);}else ef=this._titlebarTooltipAnchor;ie(ef,df.participants);}}.bind(this));},_getNode:function(df){return this._tabTemplate.getNode(df);},_getCanonicalUserID:function(){return hb.getUserIDFromThreadID(this._threadID);},_listen:function(df,event,ef,ff){var gf=this._getNode(df);if(gf){this._eventListeners.push(xa.listen(gf,event,ef.bind(this)));}else if(!ff)throw new Error('Could not find node "'+df+'"');},_closePreClicked:function(df){this._closeMouseDown=true;},_closeClicked:function(df){ze(this);ba.closeTab(this._threadID);if(df instanceof nc){df.stopPropagation();return;}df.kill();},_closeEnter:function(df){if(df.keyCode===db.RETURN)this._closeClicked(df);},_nubClicked:function(df){df.kill();return ga.inform('nub-activated',this._threadID);},_dockKeyDown:function(event){if(event.keyCode===db.RETURN||event.keyCode===db.SPACE){ga.inform('nub-activated',this._threadID);event.kill();}else this._handleHotkeyPressed(event);},_handleHotkeyPressed:function(event){if(event.keyCode===db.ESC){this._handleEscape();if(t.get('chat_react_input'))event=new sa(event);event.kill();}else if(event.keyCode===db.TAB)this._handleTabPressed(event);},_handleTabPressed:function(event){if(!event.ctrlKey){var df=ga.inform('tab-pressed',{id:this._threadID,shiftPressed:event.shiftKey});if(t.get('chat_react_input'))event=new sa(event);!df&&event.kill();return true;}},_handleEscape:function(){if(this._stickersFlyoutShown){this._stickerButton?this._toggleStickersFlyoutShownReact(false):this._toggleStickersFlyoutShownLegacy(false);return;}ze(this);if(this.hasEmptyInput()){ga.inform('esc-pressed',this._threadID);}else{var df=jd._("Are you sure you want to close this chat window?"),ef=jd._("You haven't sent your message."),ff=new pa().setTitle(df).setBody(ef).setButtons([pa.CLOSE,pa.CANCEL]).setHandler(ga.inform.bind(ga,'esc-pressed',this._threadID,null)).setModal(true).show(),gf=ff.getButtonElement('yes');gf&&ab.set(gf);}},_titleClicked:function(event){var df=event.getTarget();if(!zb.byClass(df,'titlebarText')&&!zb.byClass(df,'uiSelector')&&!zb.byClass(df,'addToThread')&&!zb.byClass(df,'optionMenu')&&!zb.byClass(df,'videoicon')&&!zb.byClass(df,'close')){event.kill();ba.lowerTab(this._threadID);this.focus();}},_callEnter:function(df){if(df.keyCode===db.RETURN)this._callClicked(df);},_callClicked:function(df){if(df.target)df.target.blur();var ef=this._getCanonicalUserID();if(this._videoCallLinkEnabled){var ff='chat_tab_icon';if(df.target&&na.hasClass(df.target,'video_call_tour'))ff='chat_tab_icon_tour';ga.inform('video-call-clicked',{threadID:this._threadID,userID:ef,clickSource:ff});}if(t.get('chat_react_header')){df.stopPropagation();}else return false;},_addFriendLinkClicked:function(){this.showAddFriend();},_nameConversationLinkClicked:function(){this.showNameConversation();},_showParticipantsClicked:function(){ud.getFBIDFromClientID(this._threadID,function(df){h.send(new i(new uc('/ajax/browser/dialog/multichat_members/').addQueryData({id:df})));});},_deleteConversation:function(){xc.show(this._threadID);},_unsubscribeLinkClicked:function(){var df=[];df.push({name:'unsubscribe',label:jd._("Leave Conversation"),handler:this._unsubscribeToThread.bind(this)});df.push(pa.CANCEL);new pa().setTitle(jd._("Leave Conversation?")).setBody(jd._("You will stop receiving messages from this conversation and people will see that you left.")).setButtons(df).show();},_switchToWorkUserClicked:function(){var df=[];df.push({name:'move',label:jd._("Move Conversation"),handler:this._switchToWork.bind(this)});df.push(pa.CANCEL);new pa().setTitle(jd._("Move Conversation to Work Account?")).setBody(jd._("Do you want to move this conversation so that it shows in your work account instead?")).setButtons(df).show();},_getUserParticipants:function(df){var ef=[];df.forEach(function(ff){var gf=hb.getUserIDFromParticipantID(ff);gf&&ef.push(gf);});return ef;},_createGroupClicked:function(){zd.getThreadMeta(this._threadID,function(df){if(!df.is_canonical){var ef=new uc('/ajax/groups/create_get.php').addQueryData({ref:'web_messenger_dock',parent_id:'0'}),ff=this._getUserParticipants(df.participants);ef.addQueryData({members:ff});if(df.name)ef.addQueryData({name:df.name});h.send(new i(ef));}}.bind(this));},_enableDesktopNotif:function(){Notification.requestPermission();},_reportSpamClicked:function(){var df=this._getCanonicalUserID(),ef=new uc('/ajax/chat/report.php').addQueryData({id:df}).addQueryData({src:'top_report_link'});if(zc.result)ef=ad.getURIBuilder().setString('thread_fbid',df).setEnum('location','www_chat_head').getURI();h.send(new i(ef));},_messageBlockedClicked:function(){var df=JSON.stringify({reportable_ent_token:this._getCanonicalUserID(),initial_action_name:jb.block_messages});h.send(new i(new uc('/ajax/nfx/messenger_direct_action').addQueryData({story_location:'messenger',context:df})));},_messageUnblockedClicked:function(){var df=JSON.stringify({reportable_ent_token:this._getCanonicalUserID(),initial_action_name:jb.block_messages});new i(new uc('/ajax/nfx/messenger_undo_block').addQueryData({story_location:'messenger',context:df})).send();},_inputPasted:function(event){if(vc.chrome()){var df=event.clipboardData||event.originalEvent.clipboardData;if(!df||!df.items||df.items.length<1)return;var ef=df.items[0].type;if(ef!=='image/png')return;if(df.items[0].getAsFile){var ff=df.items[0].getAsFile();this._photoUploader.uploadFile(ff);}}},_focusInput:function(){if(t.get('chat_react_input')){this._chatInput&&this._chatInput.isMounted()&&this._chatInput.focus();}else this._getNode('input').focus();},_focusTab:function(){na.addClass(this._tabElem,'focusedTab');this.tryMarkAsRead();this._closeMouseDown=false;this._setCloseTooltip(true);ga.inform('focus-tab',this._threadID);},_blurTab:function(){na.removeClass(this._tabElem,'focusedTab');!this._closeMouseDown&&this._setCloseTooltip(false);},_setCloseTooltip:function(df){if(t.get('chat_react_header')){this._closeButton.isMounted()&&this._closeButton.setProps({active:df});return;}var ef=this._getNode('titlebarCloseButton'),ff=df?jd._("Press Esc to close"):jd._("Close tab");rc.set(ef,ff,'above');},_inputKeyDown:function(event){this.tryMarkAsRead();if(event.keyCode===db.RETURN&&!event.shiftKey){var df=zd.getThreadMetaNow(this._threadID);if(df.is_canonical&&!df.can_reply&&jb.gk_result){this._showMessageBlockedDialog(df);event.kill&&event.kill();return;}if(ue(this)){se(this);event.kill&&event.kill();return;}pe(this);if(this._stickerTriggerController)this._stickerTriggerController.activateAfterparty();event.kill&&event.kill();return;}if(event.keyCode===db.DOWN&&event.shiftKey&&this.hasEmptyInput()){event.kill&&event.kill();ba.lowerTab(this._threadID);this.focus();return;}this._handleHotkeyPressed(event);},_showMessageBlockedDialog:function(df){var ef=this._getCanonicalUserID();if(!ef)return;var ff='fbid:'+ef;kb.get(ff,function(gf){o.loadModules(["MessageBlockedDialog"],function(hf){hf.show(df.can_reply,df.message_blocked,gf.short_name);});});},_initializeInput:function(){if(!t.get('chat_react_input')){var df=this._inputContainerNode.clientHeight;pc.getInstance(this._getNode('input')).subscribe('resize',function(){var ef=this._inputContainerNode.clientHeight;if(ef!=df)this._nubController.flyoutContentChanged();df=ef;}.bind(this));this._listen('input','focus',this._focusTab);this._listen('input','blur',this._blurTab);this._listen('input','paste',this._inputPasted);if(vc.firefox()&&oa.get()=='ko_KR'){this._listen('input','keyup',this._inputKeyDown);}else this._listen('input','keydown',this._inputKeyDown);this._initializeThingsWithInputFn(this._tabTemplate.getNode('input'));}else this._chatInput=dc.render(dc.createElement(pd,{initializeThingsWithInputFn:this._initializeThingsWithInputFn.bind(this),inputChanged:function(ef){if(this._stickerTriggerController)this._stickerTriggerController.updateInput(ef);}.bind(this),inputKeyDown:this._inputKeyDown.bind(this),onAddMention:this._onAddMention.bind(this),onBlur:this._blurTab.bind(this),onEscape:this._handleEscape.bind(this),onFocus:this._focusTab.bind(this),onTab:this._handleTabPressed.bind(this),openFlyoutFn:this._toggleStickersFlyoutShownLegacy.bind(this,true),stickersFlyoutToggler:this._stickersFlyoutToggler,searchTriggeredWord:function(){this._toggleStickersFlyoutShownLegacy(true);this._searchStickers(this._stickerTriggerController.getTriggeredWord());}.bind(this),resizeFn:function(ef){lc.set(this._getNode('inputContainer'),'height',ef+'px');this._nubController.flyoutContentChanged();}.bind(this),uploadPhotoFn:function(ef){this._photoUploader&&this._photoUploader.uploadFile(ef);}.bind(this)}),this._getNode('chatInputContainer'));},_initializeSharePreview:function(df,ef){this._sharePreview=dc.render(dc.createElement(mb,{imageSize:{width:ge,height:ge},location:lb.CHAT_PREVIEW,onClose:this._focusInput.bind(this),onUpdate:function(){we(this);this._unblockSend();}.bind(this)}),this._getNode('shareAttachmentShelf'));xa.listen(df,'keyup',function(){var ff=ef?ef():df.value;!ff.length&&this._urlScraper.reset();}.bind(this));this._urlScraper=new tc(df,ef);this._urlScraper.subscribe('match',function(ff,gf){this._sharePreview.setProps({share:null,uri:(gf&&gf.url)});}.bind(this));},_initializeThingsWithInputFn:function(df,ef){this._initializeSharePreview(df,ef);zd.getThreadMeta(this._threadID,function(ff){if(gb.CoreGraphEnabled&&ff&&ff.folder===tb.PENDING){na.hide(this._getNode('footer'));var gf=ra.create('div');ra.appendContent(this._getNode('chatConv'),gf);dc.render(dc.createElement(n,{bootloadPlaceholder:dc.createElement("div",{style:{height:27}}),bootloadComponent:function(hf){o.loadModules(["ChatPendingActions.react"],hf);},onDeleteClick:function(hf){xc.show(this._threadID);}.bind(this),onReplyClick:function(hf){ra.remove(gf);na.show(this._getNode('footer'));this._updateControls(ff);}.bind(this)}),gf);}ud.getFBIDFromClientID(this._threadID,function(hf){this._typingDetector=new sc(this._getCanonicalUserID(),df,'mercury-chat',null,hf,ef);}.bind(this));}.bind(this));},_getInputValue:function(){if(t.get('chat_react_input')){if(!this._chatInput||!this._chatInput.isMounted())return '';return this._chatInput.getValue()||'';}else return this._tabTemplate.getNode('input').value||'';},appendTextToInput:function(df){if(t.get('chat_react_input')){if(this._chatInput&&this._chatInput.isMounted())this._chatInput.appendText(df);}else this._getNode('input').value+=df;},_hasUnfinishedPost:function(){return ve(this)||te(this);},tryMarkAsRead:function(){if(!this._messagesView||this._messagesView.isScrolledToBottom()){yd.markRead(this._threadID);yd.markSeen(this._threadID);return true;}return false;},_chatConvClicked:function(df){this.tryMarkAsRead();if(zb.byTag(df.getTarget(),'a')||ra.getSelection())return;this.focus();},_inputContainerClicked:function(df){this.tryMarkAsRead();this.focus();},_initializePageMessagingIndicator:function(){if(!this._pagesMessageIndicator)return;na.hide(this._pagesMessageIndicator);this._pagesMessageIndicatorHandler=new yb(this._threadID,function(df){if(!df)return;ra.setContent(this._pagesMessageIndicator,df);na.show(this._pagesMessageIndicator);}.bind(this));this._pagesMessageIndicatorHandler.checkResponsiveness();},showTypingIndicator:function(df){this._renderTypingIndicator();na.conditionClass(this._tabElem,"_54m8",df);},_renderTypingIndicator:function(){var df=na.hasClass(this._tabElem,'highlightTab')?'light':'dark';dc.render(dc.createElement(qb,{color:df}),this._getNode('animationContainer'));},_updateUnreadCount:function(df){var ef=df.unread_count;if(typeof ef!='undefined'){var ff=!!ef&&(!r.showsTabUnreadUI||r.showsTabUnreadUI()),gf=this._getNode('numMessages');na.conditionShow(gf,ff);na.conditionClass(this._tabElem,'highlightTab',ff);this._renderTypingIndicator();me(this._threadID,this._tabElem,ff);ra.setContent(gf,ef);}},updateCallLink:function(){var df=this._getCanonicalUserID();if(!df||df===ma.getID()||!za.isUser(df)){if(t.get('chat_react_header')){this._videoCallButton.isMounted()&&this._videoCallButton.setProps({shown:false});}else{var ef=this._getNode('videoCallLink');if(ef)na.hide(ef);}this._videoCallLinkEnabled=false;return;}this._videoCallLinkEnabled=ya.isCallable(df);na.conditionClass(this._tabElem,"_4hwz",this._videoCallLinkEnabled);kb.get(hb.getParticipantIDFromUserID(df),function(ff){var gf=ya.callButtonTooltip(df,ff.short_name);this._setVideoCallTooltip(gf);}.bind(this));},_setVideoCallTooltip:function(df){if(t.get('chat_react_header')){this._videoCallButton.isMounted()&&this._videoCallButton.setProps({tooltipLabel:df});}else rc.set(this._getNode('videoCallLink'),df);},_setPrivacyLinkText:function(df){this._reactChatTabMenu.isMounted()&&this._reactChatTabMenu.setProps({privacyText:df});},_updatePrivacyLink:function(df){var ef;if(df==x.OFFLINE){ef=jd._("Go online");this._setPrivacyLinkText(ef);return;}var ff=this._getCanonicalUserID();if(!ff)return;var gf='fbid:'+ff;kb.get(gf,function(hf){if(!hf.is_friend){ef=null;}else if(df==x.BLOCKED){ef=jd._("Turn On Chat for {name}",[jd.param("name",hf.short_name)]);}else ef=jd._("Turn Off Chat for {name}",[jd.param("name",hf.short_name)]);this._setPrivacyLinkText(ef);}.bind(this));},_unsubscribeToThread:function(){if(!zd.isEmptyLocalThread(this._threadID)){var df=td.constructLogMessageObject(nb.CHAT_WEB,this._threadID,ib.UNSUBSCRIBE,{removed_participants:[rb.getID()]});rd.send(df);}ba.closeTab(this._threadID,'unsubscribed');return true;},_switchToWork:function(){if(!zd.isEmptyLocalThread(this._threadID)){var df=td.constructLogMessageObject(nb.CHAT_WEB,this._threadID,ib.SWITCH_TO_WORK,{removed_participants:[rb.getID()]});rd.send(df);}ba.closeTab(this._threadID,'unsubscribed');return true;},_initializeSheetController:function(){this._sheetController=new fa(this._threadID,this._getNode('sheet'),this._tabElem,this);this._sheetController.onClickMessagesBlockedSheet(function(){yd.unblockMessages(this._threadID);this.focus();}.bind(this));this._sheetController.onClickNewMessagesSheet(function(){this._messagesView&&this._messagesView.scrollToBottom();this.focus();this.tryMarkAsRead();}.bind(this));this._sheetController.onClickThreadIsMutedSheet(function(){yd.unmute(this._threadID);this.focus();}.bind(this));this._sheetController.onTokensChanged(function(df,ef){zd.getThreadMeta(this._threadID,function(ff){this._updateControls(ff,ef.token_count);}.bind(this));}.bind(this));this._nubController=new ub().init(this._tabElem);this._sheetController.onResize(function(){this._nubController.flyoutContentChanged();}.bind(this));this._nubController.subscribe('resize',function(){this._resizeInputContainer();}.bind(this));},_initializeHeader:function(){this._initializeReactMenu(this._getNode('fileAttachmentShelf'));this._initializeArchiveWarning();this._initializeAddToThreadButton();this._initializeVideoCallButton();this._initializeCloseButton();this._initializeTitle();},_initializeReactMenu:function(df){var ef=this._getNode('menuContainer'),ff=hb.isGroupChat(this._threadID),gf=zd.isNewEmptyLocalThread(this._threadID),hf=this._sheetController.openAddFriendsSheet.bind(this._sheetController);if(ef)this._reactChatTabMenu=dc.render(dc.createElement(ca,{onFileUploaderMounted:this.setFileUploader.bind(this),updatePrivacyLinkFunc:this._updatePrivacyLink.bind(this),nameConversationFunc:this._nameConversationLinkClicked.bind(this),showParticipantsFunc:this._showParticipantsClicked.bind(this),leaveConversationFunc:this._unsubscribeLinkClicked.bind(this),deleteConversationFunc:this._deleteConversation.bind(this),reportSpamFunc:this._reportSpamClicked.bind(this),blockMessagesFunc:this._messageBlockedClicked.bind(this),unblockMessagesFunc:this._messageUnblockedClicked.bind(this),createGroupFunc:this._createGroupClicked.bind(this),switchToWorkFunc:this._switchToWorkUserClicked.bind(this),isGroupChat:ff,isEmptyChat:gf,showAddFriend:hf,threadID:this._threadID,attachmentsShelf:df,onUploadFinished:this._unblockSend.bind(this),onUpdateAttachmentsShelf:we.bind(this,this),onSubmit:this._focusInput.bind(this),enableDesktopNotif:function(){this._enableDesktopNotif();}.bind(this)}),ef);},_initializeArchiveWarning:function(){if(t.get('chat_react_header'))this._archiveWarning=dc.render(dc.createElement(q,{isFBAtWork:t.IsWorkUser,shown:true}),this._getNode('archiveContainer'));},_initializeAddToThreadButton:function(){if(t.get('chat_react_header')){this._addToThreadButton=dc.render(dc.createElement(p,{isFBAtWork:t.get('IsWorkUser',false),onClick:this._addFriendLinkClicked.bind(this),shown:true}),this._getNode('addToThreadContainer'));}else this._listen('addToThreadLink','click',this._addFriendLinkClicked,true);},_initializeVideoCallButton:function(){if(!hb.getUserIDFromThreadID(this._threadID))return;var df=null;if(t.get('chat_react_header')){this._videoCallButton=dc.render(dc.createElement(ka,{shown:true,onClick:this._callClicked.bind(this),onKeyUp:this._callEnter.bind(this)}),this._getNode('videoCallButtonContainer'));df=dc.findDOMNode(this._videoCallButton);}else{df=this._getNode('videoCallLink');this._listen('videoCallLink','click',this._callClicked,true);this._listen('videoCallLink','keyup',this._callEnter,true);}},_initializeCloseButton:function(){if(t.get('chat_react_header')){this._closeButton=dc.render(dc.createElement(s,{onClick:this._closeClicked.bind(this),onKeyUp:this._closeEnter.bind(this),onMouseDown:this._closePreClicked.bind(this)}),this._getNode('closeButtonContainer'));}else{this._listen('titlebarCloseButton','click',this._closeClicked);this._listen('titlebarCloseButton','keyup',this._closeEnter);this._listen('titlebarCloseButton','mousedown',this._closePreClicked);}},_initializeTitle:function(){if(t.get('chat_react_header')){var df=zd.getThreadMetaNow(this._threadID);this._title=dc.render(dc.createElement(ia,{isNewThread:zd.isNewEmptyLocalThread(this._threadID),thread:df,viewer:ma.getID()}),this._getNode('titleContainer'));}},_initializeTitleHREF:function(){yc.getThreadURI(this._threadID,function(ef){return this._setTitleHref(ef);}.bind(this));if(!hb.getUserIDFromThreadID(this._threadID))this._titlebarTooltipAnchor=this._getNode('titlebarText');var df=this._getCanonicalUserID();if(this._getCanonicalUserID()){kb.get(hb.getParticipantIDFromUserID(df),function(ef){if(ef.href)this._setTitleHref(ef.href);}.bind(this));}else if(this._reactChatTabMenu.getURL())this._setTitleHref(this._reactChatTabMenu.getURL());},_initializeUIListeners:function(){if(this._pagesMessageIndicator)this._listen('scrollingArea','scroll',function(event){var df=event.target;if(df.scrollHeight-df.offsetHeight!==df.scrollTop)new g(this._pagesMessageIndicator).to('height',0).duration(100).hide().go();}.bind(this));this._listen('closeButton','click',this._closeClicked);this._listen('dockButton','click',this._nubClicked);this._listen('dockButton','keydown',this._dockKeyDown);this._listen('nubFlyoutTitlebar','click',this._titleClicked);this._listen('chatConv','click',this._chatConvClicked);this._listen('inputContainer','click',this._inputContainerClicked);this._listen('sheet','keydown',function(event){if(!event.getModifiers().any&&event.keyCode===db.TAB){this._focusInput();event.kill();}}.bind(this));if(this._getNode('officeStatus'))this._listen('officeStatus','click',function(){return false;},true);},setFileUploader:function(df){this._fileUploader=df;},_initializeAutoSendPhotoUploader:function(){this._photoUploader=dc.render(dc.createElement(w,{onSubmit:this._handlePUSubmit.bind(this),onAllUploadsComplete:this._handlePUAllUploadsCompleted.bind(this),onLastUploadFail:this._handlePULastUploadFailed.bind(this),onLastUploadCancel:this._handlePULastUploadCanceled.bind(this)}),this._getNode('photoUploaderContainer'));},_initializeStickers:function(){this._stickersFlyoutToggler=this._getNode('emoticons');if(t.get('chat_react_input')&&ic.WebStickerTrigger){this._stickerTriggerController=new aa(this._getNode('stickersTriggerFlyoutContainer'),this._getNode('emoticonIndicator'),this._stickersFlyoutToggler,this._stickerSelected.bind(this),this._searchStickers.bind(this));if(this._chatInput)this._stickerTriggerController.setInput(this._chatInput);}if(kc.shouldShowStickerSearchNUX())this._listen('emoticons','click',function(){if(kc.shouldShowStickerSearchNUX()){hc.selectPack(jc.SEARCH_PACK_ID);kc.clearShowStickerSearchNUX();}},true);if(t.get('chat_react_sticker_button')){this._stickerButton=dc.render(dc.createElement(z,{className:"_4vui",flyoutAlignment:"left",onFlyoutShown:this._onFlyoutShown.bind(this),onFlyoutHidden:this._onFlyoutHidden.bind(this),onStickerSelect:this._stickerSelected.bind(this),onEmoticonSelect:this._emoticonSelected.bind(this),threadID:this._threadID}),this._getNode('stickerButtonContainer'));m.bumpEntityKey('chat.web','sticker_button.mounting_attempted');}else{var df=this._getNode('stickers');if(df)var ef=new cc(function(gf){this._stickersFlyout=dc.render(dc.createElement(n,{bootloadPlaceholder:dc.createElement("div",{style:{padding:'30px',textAlign:'center'}},dc.createElement(cd,{size:"large"})),bootloadComponent:function(hf){gf(hf);},onStickerSelect:function(hf){this._stickerSelected(hf);}.bind(this),onShown:this._onFlyoutShown.bind(this),onHidden:this._onFlyoutHidden.bind(this),onEmoticonSelect:this._emoticonSelected.bind(this),onEscKeyDown:this._hideStickersFlyoutIfShown.bind(this)}),df);}.bind(this)),ff=qc.listen('show',this._stickersFlyoutToggler,function(){qc.unsubscribe(ff);ef.then(function(gf){o.loadModules(["StickersFlyout.react"],gf);});});this._eventListeners.push(kc.addListener(kc.PACK_SELECTED,function(gf){if(this._stickersFlyout&&this._stickersFlyout.isMounted())this._stickersFlyout.setProps({packID:gf});}.bind(this)));}},_initializeDragDropTarget:function(){var df=ta.scry(this._tabElem,"._1ia");if(df&&df.length>0){this._dropTarget=new ua(df[0]);this._dropTarget.setOnFilesDropCallback(this._filesDropped.bind(this));this._dropTarget.setOnURLDropCallback(this._linkDropped.bind(this));this._dropTarget.enable();}},_initializeP2PChatThreadBannerContainer:function(){var df=ta.scry(this._tabElem,"._2hc2");if(df&&df.length>0){this._p2pChatThreadBannerContainer=df[0];dc.render(dc.createElement(vb,{threadID:this._threadID}),this._p2pChatThreadBannerContainer);}},_initializeP2P:function(){if(this._isP2PEnabled())this._renderOrionTrigger();},_onP2PTransferStoreLoaded:function(){if(!this._isP2PEnabled()){this._transferStoreSub=ae.addListener('change',this._onP2PTransferStoreChange.bind(this));}else this._renderOrionTrigger();},_initializeHotLike:function(){if(this._getNode('hotLikeContainer')){dc.render(dc.createElement(sb,{className:"_3s0d",sendSticker:this._stickerSelected.bind(this),threadID:this._threadID}),this._getNode('hotLikeContainer'));na.addClass(this._inputContainerNode,"_n4k");}},_initializeUnloadListeners:function(){this._checkUnsentMessages=fd(function(){if(this._hasUnfinishedPost())return jd._("You haven't sent your message yet. Do you want to leave without sending?");if(sd.getNumberLocalMessages(this._threadID))return jd._("Your message is still being sent. Are you sure you want to leave?");return null;}.bind(this));ec.onBeforeUnload(this._checkUnsentMessages,false);this._logUnsentPhotos=fd(ze.bind(null,this));ec.onUnload(this._logUnsentPhotos);},_handlePUSubmit:function(df,ef){xe(this,ac.UPLOAD_START,ef);re(this,'',[],function(ff){if(this._threadID!==ff.thread_id){this._newThreadIDFromPhotoUpload=ff.thread_id;if(this._messagesView)this._messagesView.setNewThreadID(ff.thread_id);}ff.content_attachment=null;rd.addAttachmentPlaceholder(ff,ef.upload_id,ef);}.bind(this));cf('submit',ef);this._focusInput();},_handlePULastUploadFailed:function(df,ef){xe(this,ac.CLIENT_ERROR,ef);cf('failed',ef);rd.cancelAttachmentPlaceholder(ef.upload_id,ef);var ff=jd._("Photo Upload Failed"),gf=jd._("Please try again. Make sure you are uploading a valid photo.");new pa().setTitle(ff).setBody(gf).setButtons(pa.OK).show();},_handlePULastUploadCanceled:function(df,ef){xe(this,ac.CANCEL_DURING_UPLOAD,ef);cf('canceled',ef);rd.cancelAttachmentPlaceholder(ef.upload_id,ef);},_handlePUAllUploadsCompleted:function(df,ef){xe(this,ac.ALL_UPLOADS_DONE,ef);cf('completed',ef);rd.confirmAttachmentPlaceholder(ef.upload_id,ef);var ff=ef.image_ids.length||ef.attachments.length;qe(this,ff);},_stickerSelected:function(df){re(this,'',[],function(ef){ef.has_attachment=true;ef.sticker_id=df;rd.send(ef);this.focus();}.bind(this));this._messagesView&&this._messagesView.scrollToBottom();},_emoticonSelected:function(df){var ef=va.symbols[df];if(!ef)return;if(t.get('chat_react_input')){this._chatInput.insertEmoticon(ef);return;}this._selectionPosition=this._selectionPosition||new gc(this._getNode('input'));var ff=pc.getInstance(this._getNode('input')),gf=ff.getValue(),hf=wa.insertEmoticon(ef,gf,this._selectionPosition.getPos());ff.setValue(hf.result);this._selectionPosition.setPos(hf.start,hf.end);},_orionTriggered:function(){re(this,'',[],function(df){this.focus();}.bind(this));this._messagesView&&this._messagesView.scrollToBottom();},_addStickerSearchNUXIndicator:function(){na.addClass(this._getNode('emoticonIndicator'),'nux');ee=false;},_onFlyoutShown:function(df){if(t.get('chat_react_sticker_button')){var ef=this._stickersFlyout.props.packID;if(ef!==jc.SEARCH_PACK_ID)this.focus();}if(this._stickerTriggerController){this._stickerTriggerController.onFlyoutShown(df);}else df();this._stickersFlyoutShown=true;},_searchStickers:function(df,ef){this._stickersFlyout.isMounted()&&this._stickersFlyout.setProps({packID:jc.SEARCH_PACK_ID,trigger:df},ef);},_onFlyoutHidden:function(){this._stickersFlyoutShown=false;this.focus();},_setTitleHref:function(df){if(t.get('chat_react_header')){this._title.isMounted()&&this._title.setProps({href:df});}else{var ef=this._getNode('titlebarText');ef.setAttribute('href',df);ef.removeAttribute('rel');na.removeClass(ef,'noLink');}},_onAddMention:function(df){this._linkDropped((new uc(df.getURI())).getQualifiedURI().toString());},_unblockSend:function(){if(!this._blocked||ue(this))return;this._blocked=false;pe(this);this._sheetController.closeUploadWarningTabSheet();},_logOpenTab:function(){new j('/ajax/chat/opentab_tracking.php',{threadID:this._threadID,userID:this._getCanonicalUserID(),signatureID:this._signatureID}).send();}});function cf(df,ef){he.debug('photo_uploader:'+df,Object.assign({},ef));}e.exports=ye;},null);
__d("ChatTabTypeaheadDataSource",["MercuryTypeaheadConstants","MercuryTypeaheadDataSource"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();for(var i in h)if(h.hasOwnProperty(i))k[i]=h[i];var j=h===null?null:h.prototype;k.prototype=Object.create(j);k.prototype.constructor=k;k.__superConstructor__=h;function k(l){"use strict";l=l||{};l.maxResults=g.COMPOSER_CHATTAB_MAX;h.call(this,l);this.$ChatTabTypeaheadDataSource0=true;}k.prototype.buildData=function(l){"use strict";var m=[],n=[],o=[],p=[],q=[];l.forEach(function(r){var s=j.getEntry.call(this,r);switch(s.render_type){case g.FRIEND_TYPE:m.push(r);break;case g.THREAD_TYPE:if(this.$ChatTabTypeaheadDataSource0)n.push(r);break;case g.NON_FRIEND_TYPE:o.push(r);break;case g.FB4C_TYPE:p.push(r);break;case g.PAGE_TYPE:if(this.$ChatTabTypeaheadDataSource0)q.push(r);break;default:this.logQuery({event:'chat_tab_render_type_error'});break;}},this);return j.buildData.call(this,m.concat(p,n,q,o));};k.prototype.query=function(l,m,n,o){"use strict";this.logQuery({event:'query_chat_tab',query:l});return j.query.call(this,l,m,n,o);};k.prototype.respond=function(l,m,n){"use strict";var o=j.respond.call(this,l,m,n);this.logResponse({event:'query_response_chat_tab',response_query:l,response_uids:m});return o;};k.prototype.setShowThreads=function(l){"use strict";this.$ChatTabTypeaheadDataSource0=l;};e.exports=k;},null);
__d("XOfferSetNotificationsController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/offers\/v2\/notifications\/",{offer:{type:"Int",required:true},enable:{type:"Bool",defaultValue:false}});},null);
__d("XOfferSendPlatformNotificationController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/offers\/v2\/send_platform_notification\/",{});},null);
__d("OffersUtil",["DOM","DOMQuery","CSS","Event","AsyncRequest","XOfferSetNotificationsController","XOfferSendPlatformNotificationController"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();var n={attachHideShowClickListener:function(o,p,q){j.listen(o,'click',function(){var r=h.scry(h.getRootElement(),p),s=h.scry(h.getRootElement(),q);for(var t=0;t<r.length;t++)i.hide(r[t]);for(var u=0;u<s.length;u++)i.show(s[u]);});},registerRedirectAfter:function(o,p){setTimeout(function(){window.location.href=o;},p);},attachDeletelLinkClickListener:function(o,p,q,r,s){j.listen(o,'click',function(){new k().setURI(q).setHandler(function(t){var u=t.getPayload();if(u){p.className=r;}else p.className=s;}).send();});},listen:function(o,p){j.listen(o,'click',p.show.bind(p));},showRegistered:function(o,p){j.listen(o,'click',function(){p.show();});},logGoToWebsiteClick:function(o,p){j.listen(o,'click',function(){new k().setURI(p).send();});},sendPlatformNotification:function(){var o=m.getURIBuilder().getURI();new k().setURI(o).send();}};e.exports=n;},null);
__d("SyncRequestNotificationBeeperItemContents.react",["Animation","CloseButton.react","ImageBlock.react","NotificationUserActions","React","SyncRequest.react","SyncRequestStatusEnum","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();var o=k.createClass({displayName:"SyncRequestNotificationBeeperItemContents",_markAsRead:function(){j.markNotificationsAsRead([this.props.beep.notificationID]);this.props.onHide();},_onClose:function(){this._markAsRead();this.props.onHide();},_doFlash:function(){new g(k.findDOMNode(this.refs.inner)).from('opacity','0').to('opacity','1').duration(200).go();},componentDidMount:function(){if(this.props.beep.rendererData.status!=m.PENDING)this.props.onReadyToHide(this.props.beep.notificationID);},componentDidUpdate:function(p){if(this.props.beep.rendererData.status!=m.PENDING&&p.beep.rendererData.status==m.PENDING)this.props.onReadyToHide(this.props.beep.notificationID);},onRequestStatusUpdate:function(p,q){if(p!=m.PENDING&&q==m.PENDING)this.props.onReadyToHide(this.props.beep.notificationID);},render:function(){var p=this.props.beep,q=p.rendererData;return (k.createElement("div",{ref:"inner"},k.createElement(h,{className:"_3soc",onClick:this._onClose,size:"medium"}),k.createElement(i,{className:"_3soj"},k.createElement("img",{src:p.actors[0].profile_picture.uri,className:"_3sok"}),k.createElement("div",{className:"_3sol"},k.createElement(l,{app:q.app,creationTime:q.creation_time,requestId:q.id.toString(),receiver:q.receiver,sender:q.sender,status:q.status,timeout:q.timeout,timeRemaining:q.time_remaining,viewerId:q.receiver.id,onStatusUpdate:this.onRequestStatusUpdate})))));}});e.exports=o;},null);
__d("LiveMessageReceiver",["Arbiter","ChannelConstants","emptyFunction","shield"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();function k(l){this.eventName=l;this.subs=null;this.handler=i;this.shutdownHandler=null;this.registered=false;this.appId=1;}Object.assign(k,{getAppMessageType:function(l,m){return 'live_message/'+l+':'+m;},route:function(l){var m=function(n){var o=k.getAppMessageType(l.app_id,l.event_name);g.inform(o,n,g.BEHAVIOR_PERSISTENT);};m(l.response);}});Object.assign(k.prototype,{setAppId:function(l){this.appId=l;return this;},setHandler:function(l){this.handler=l;this._dirty();return this;},setRestartHandler:i,setShutdownHandler:function(l){this.shutdownHandler=j(l);this._dirty();return this;},_dirty:function(){if(this.registered){this.unregister();this.register();}},register:function(){var l=function(n,o){return this.handler(o);}.bind(this),m=k.getAppMessageType(this.appId,this.eventName);this.subs={};this.subs.main=g.subscribe(m,l);if(this.shutdownHandler)this.subs.shut=g.subscribe(h.ON_SHUTDOWN,this.shutdownHandler);this.registered=true;return this;},unregister:function(){if(!this.subs)return this;for(var l in this.subs)if(this.subs[l])this.subs[l].unsubscribe();this.subs=null;this.registered=false;return this;}});e.exports=k;},null);
__d("initLiveMessageReceiver",["Arbiter","ChannelConstants","LiveMessageReceiver"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();g.subscribe(h.getArbiterType('app_msg'),function(j,k){i.route(k.obj);});},null);