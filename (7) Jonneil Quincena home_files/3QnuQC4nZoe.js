/*!CK:629849407!*//*1435215259,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["Mq40C"]); }

__d("ChatSidebarSections",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={MORE_ONLINE_FRIENDS:"more_online_friends",MORE_ONLINE_COWORKERS:"more_online_coworkers",OFFLINE_USERS:"offline_users",ORDERED_LIST:"ordered_list",ORDERED_COWORKERS:"ordered_coworkers",TYPEAHEAD:"typeahead",NOW_PINNED_LIST:"now_pinned_list"};},null);
__d("ChatTypeaheadEvent",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports={ABANDONED_QUERY:"abandoned_query",NEW_QUERY:"new_query",RESULT_SELECTED:"result_selected"};},null);
__d("AppsDivebarDisplayController",["AppsDivebarConfigData","AsyncRequest","Arbiter","CSS","UIPagelet","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();var m='173',n={isVisible:function(){if(typeof(this._visible)!='undefined')return this._visible;this._visible=!g.hidden;return this._visible;},showApps:function(){this._visible=true;var o={fb_source_category:'sidebar'};k.loadFromEndpoint('GamesDivebarPagelet','pagelet_canvas_nav_content',o);j.show('apps_gripper');j.show('pagelet_canvas_nav_content');j.addClass('pagelet_canvas_nav_content',"_4woj");i.inform('AppsDivebar/show-apps');new h('/ajax/feed/apps/resize').setData({height:''+m,menu:true}).setMethod('POST').send();},hideApps:function(){this._visible=false;j.hide('pagelet_canvas_nav_content');j.hide('apps_gripper');i.inform('AppsDivebar/hide-apps');new h('/ajax/feed/apps/resize').setData({height:'1',menu:true}).setMethod('POST').send();}};e.exports=n;},null);
__d("AsyncLoader",["copyProperties","AsyncRequest","BaseAsyncLoader"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();function j(k,l){this._endpoint=k;this._type=l;}g(j.prototype,i.prototype);j.prototype.send=function(k,l,m,n,o){new h(k).setData({ids:l}).setHandler(n).setErrorHandler(o).setAllowCrossPageTransition(true).setMethod('GET').setReadOnly(true).send();};e.exports=j;},null);
__d("ChatHovercard",["Arbiter","AsyncLoader","Bootloader","JSLogger","debounce"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=5,m=new h('/ajax/chat/hovercard/sidebar.php','hover'),n=j.create('chat_hovercard');g.subscribe('Hovercard/dirty',m.reset.bind(m));function o(s,t){m.get(s,function(u){setTimeout(function(){if(!u){n.error('fetch_failure',{id:s});return;}i.loadModules(["Hovercard"],function(v){var w=v.getDialog(u);if(!w){n.error('no_hovercard',{id:s,endpoint:u});return;}if(s==t.getActiveID())t.showHovercard(s,w);});},0);});}function p(s,t){var u=[];function v(y){if(y>=0&&y<s.length)u.push(s[y]);}var w=s.indexOf(t);if(w>-1){v(w);for(var x=1;x<l;x++){v(w+x);v(w-x);}}return u.filter(function(y){return y;});}function q(s,t){var u=t.getActiveID();if(u){var v=s.getShowingUsers(),w=p(v,u);m.get(w,function(){});}}function r(s){var t=s.getHoverController();t.registerDefault(o);t.subscribe('hover',k(q.bind(null,s,t),100));}e.exports=r;},null);
__d("ChatOrderedListHover",["ArbiterMixin","CSS","ErrorUtils","Event","LayerHideOnBlur","Parent","cx","mixin","setTimeoutAcrossTransitions","shield"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();function q(w){h.addClass(w,'fetching');}function r(w){h.removeClass(w,'fetching');}var s=n(g);for(var t in s)if(s.hasOwnProperty(t))v[t]=s[t];var u=s===null?null:s.prototype;v.prototype=Object.create(u);v.prototype.constructor=v;v.__superConstructor__=s;function v(w){"use strict";this._orderedList=w;this._root=w.getRoot();j.listen(this._root,'mouseover',this._mouseOver.bind(this));j.listen(this._root,'mouseleave',this._mouseLeave.bind(this));w.subscribe('click',p(this._hide,this));}v.prototype._mouseOver=function(event){"use strict";if(this._paused)return;var w=event.getTarget(),x=l.byClass(w,"_42fz")||l.byClass(w,"_5a58");x&&this._setActiveItem(x);};v.prototype._mouseLeave=function(event){"use strict";this._setActiveItem(null);};v.prototype._clearTimeouts=function(){"use strict";this._showTimeout&&clearTimeout(this._showTimeout);this._showTimeout=null;this._hideTimeout&&clearTimeout(this._hideTimeout);this._hideTimeout=null;};v.prototype._hide=function(){"use strict";if(this._showingDialog){this._showingDialog.hide();this._showingDialog=null;this._showingID=null;}};v.prototype._show=function(){"use strict";var w=this.getActiveID(),x=false;if(this._defaultHandler){x=true;i.applyWithGuard(this._defaultHandler,{},[w,this]);}if(x&&this._showingID!=this.getActiveID())q(this._activeItem);};v.prototype._setActiveItem=function(w){"use strict";if(w!=this._activeItem){this._clearTimeouts();this._activeItem&&r(this._activeItem);this._activeItem=null;var x=w?0:100;this._hideTimeout=o(function(){if(this.getActiveID()!=this._showingID)this._hide();}.bind(this),x);if(w){this._activeItem=w;var y=x+500;this._showTimeout=o(function(){this._show();}.bind(this),y);this.inform('hover');}else this.inform('leave');}};v.prototype.registerDefault=function(w){"use strict";this._defaultHandler=w;};v.prototype.getActiveID=function(){"use strict";var w=this._activeItem&&this._orderedList.getUserForNode(this._activeItem);return w||null;};v.prototype.showHovercard=function(w,x){"use strict";if(w==this.getActiveID()&&w!=this._showingID){this._clearTimeouts();r(this._activeItem);this._hide();this._showingDialog=x;this._showingID=w;var y=x.subscribe('mouseenter',this._setActiveItem.bind(this,this._activeItem)),z=x.subscribe('mouseleave',function(){y.unsubscribe();this._setActiveItem(null);}.bind(this)),aa=x.subscribe('hide',function(){this.inform('hovercard_hide');y.unsubscribe();z.unsubscribe();aa.unsubscribe();}.bind(this));x.enableBehavior(k).setContext(this._activeItem).setPosition('left').show();this.inform('hovercard_show');}};Object.assign(v.prototype,{_root:null,_activeItem:null,_hideTimeout:null,_showTimeout:null,_showingDialog:null,_showingID:null,_defaultHandler:null});e.exports=v;},null);
__d("ChatSidebarConstants",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g={LITESTAND_CLASSIC_SIZE:32,IMAGE_SIZE:28};Object.assign(g,{getImageSize:function(h){if(h===false)return g.IMAGE_SIZE;return g.LITESTAND_CLASSIC_SIZE;},getItemHeight:function(h){if(h===false)return g.IMAGE_SIZE+4;return g.LITESTAND_CLASSIC_SIZE+4;}});e.exports=g;},null);
__d("ChatQuietLinks",["Event","DOM","UserAgent_DEPRECATED","DataStore","Parent"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l={},m={silenceLinks:function(q){n(q,this.removeEmptyHrefs.bind(this));},nukeLinks:function(q){n(q,this.removeAllHrefs.bind(this));},removeEmptyHrefs:function(q){o(q,function(r){return !r||r==='#';});},removeAllHrefs:function(q){o(q);}};function n(q,r){var s=!!i.chrome(),t=!!i.chrome()||i.ie()>=9||i.firefox()>=4;if(l[h.getID(q)])return;l[h.getID(q)]=true;if(!t)return;if(!s){r&&r(q);return;}g.listen(q,'mouseover',function u(v){var w=k.byTag(v.getTarget(),'a');if(w){var x=w.getAttribute('href');if(p(x)){j.set(w,'stashedHref',w.getAttribute('href'));w.removeAttribute('href');}}});g.listen(q,'mouseout',function u(v){var w=k.byTag(v.getTarget(),'a'),x=w&&j.remove(w,'stashedHref');if(p(x))w.setAttribute('href',x);});g.listen(q,'mousedown',function(u){if(!u.isDefaultRequested())return true;var v=k.byTag(u.getTarget(),'a'),w=v&&j.get(v,'stashedHref');if(p(w))v.setAttribute('href',w);});}function o(q,r){var s=h.scry(q,'a');if(r)s=s.filter(function(t){return r(t.getAttribute('href'));});s.forEach(function(t){t.removeAttribute('href');t.setAttribute('tabindex',0);});}function p(q){return q&&q!=='#';}e.exports=m;},null);
__d("ChatSidebarItem.react",["AvailableListConstants","XUIBadge.react","ChatConfig","ChatSidebarConstants","Image.react","Link.react","ReactComponentWithPureRenderMixin","React","SplitImage.react","TextWithEmoticons.react","cx","ix"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){b.__markCompiled&&b.__markCompiled();var s=n,t=s.PropTypes,u=9,v=n.createClass({displayName:"ChatSidebarItem",mixins:[m],propTypes:{image:t.string,images:t.array,birthday:t.bool,context:t.string,detailedStatus:t.string,href:t.string,imageSize:t.number,name:t.string,onClick:t.func,status:t.number,statusTime:t.string,unreadCount:t.number,nowData:t.object},render:function(){var w=(("_55ln")+(this.props.context?' '+"_55lo":'')+(this.props.unreadCount?' '+"_5bom":''));return (n.createElement(l,{className:w,href:{url:this.props.href},onClick:this.props.onClick,rel:"ignore"},n.createElement("div",{className:"_55lp"},n.createElement("div",{className:"_56p9"},n.createElement(o,{size:this.props.imageSize||j.IMAGE_SIZE,srcs:this.props.image||this.props.images}),n.createElement("div",{className:"_568w"})),n.createElement("div",{className:"_5bon"},this.renderBirthday(),this.renderUnreadCount(),this.renderStatus()),n.createElement("div",{className:"_55lr"},n.createElement(p,{renderEmoticons:true,renderEmoji:true,text:this.props.name})),n.createElement("div",{className:"_55ls"},this.props.context))));},renderUnreadCount:function(){var w=this.props.unreadCount;if(!w||!i.get('unread_count_enabled'))return null;return (n.createElement(h,{count:w,maxcount:u,type:"regular"}));},renderStatus:function(){if(i.get('badger_www_nub')&&this.props.nowData&&this.props.nowData.icon&&this.props.nowData.background_color){var w=this.props.nowData,x={backgroundColor:'#'+w.background_color,borderRadius:'6px',height:'16px',padding:'4px',width:'16px'},y=w.icon.filepath?'/'+w.icon.filepath:w.icon.uri;return (n.createElement("div",{className:"_568z"},n.createElement(k,{className:"_568_",src:y,style:x})));}var z=this.getStatusSrc();if(!z&&!this.props.statusTime)return null;var aa=z?n.createElement(k,{className:"_568_",src:z}):null,ba=true,ca=this.props.unreadCount||0;if(ca>0&&i.get('unread_replace_presence'))return null;if(i.get('remove_lat')){aa=this.props.statusTime?null:aa;ba=false;}else if(i.get('unread_replace_lat')&&ca>0){aa=this.props.statusTime?null:aa;ba=false;}return (n.createElement("div",{className:"_568z"},ba?this.renderLastActiveTime():null,this.renderDetailedPresence(),aa));},renderLastActiveTime:function(){return (n.createElement("div",{className:"_568-"},this.props.statusTime));},renderDetailedPresence:function(){if(i.get('remove_surface')){return null;}else if(i.get('unread_replace_surface')){var w=this.props.unreadCount||0;if(w>0)return null;}return (n.createElement("div",{className:"_5t35"},this.props.detailedStatus));},renderBirthday:function(){if(!this.props.birthday)return null;var w=r('/images/gifts/icons/cake_icon.png');return (n.createElement(k,{className:"_5dv3",src:w}));},getStatusSrc:function(){switch(this.props.status){case g.ACTIVE:return r('/images/litestand_classic/sidebar/online.png');case g.MOBILE:return r('/images/litestand_classic/sidebar/pushable.png');}return null;}});e.exports=v;},null);
__d("ChatSidebarThread.react",["ChatSidebarItem.react","ChatOpenTab","WebMessengerPermalinkConstants","React","MercuryThreadMetadataRawRenderer","Tooltip.react","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();var n=j,o=n.PropTypes,p=j.createClass({displayName:"ChatSidebarThread",getInitialState:function(){return {maxNumParticipantsToRender:10};},propTypes:{image:o.string,imageSize:o.number,name:o.string,participants:o.array,numOtherParticipants:o.number,referrer:o.string,status:o.number,threadFBID:o.string,unreadCount:o.number},_renderParticipants:function(){var s=[],t=this.props.participants.length,u=this.props.numOtherParticipants,v=Math.min(this.state.maxNumParticipantsToRender,t);if(u-v==1)v--;for(var w=0;w<v;w++){var x=this.props.participants[w];s.push(j.createElement("li",{key:x.id},x.name));}if(v<u)s.push(j.createElement("li",{key:"more-participants"},m._("and {num} more...",[m.param("num",u-v)])));return (j.createElement("ul",null,s));},render:function(){var s=this.props.name,t=q(this.props.threadFBID,this.props.participants,this.props.numOtherParticipants),u=s?t:undefined,v=i.getURIPathForThreadID(this.props.threadFBID),w=r(this.props.image,this.props.participants),x=s?s:t;return (j.createElement(l,{display:"block",position:"above",tooltip:this._renderParticipants()},j.createElement(g,{context:u,href:v,imageSize:this.props.imageSize,image:this.props.image,images:w,name:x,onClick:this._openTab,referrer:this.props.referrer,status:this.props.status,unreadCount:this.props.unreadCount})));},_openTab:function(s){s.preventDefault();h.openThread(this.props.threadFBID,this.props.referrer);}});function q(s,t,u){return k.renderRawParticipantList(s,t,u,{names_renderer:k.renderShortNames});}function r(s,t){if(s)return null;return t.map(function(u){return u.image_src;});}e.exports=p;},null);
__d("ChatSidebarGroupThreadsGroup.react",["ChannelConnection","ChatSidebarThread.react","ChatSidebarSections","ChatSidebarConstants","PresencePrivacy","PresenceStatus","React","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();var o=m,p=o.PropTypes,q=m.createClass({displayName:"ChatSidebarGroupThreadsGroup",propTypes:{groups:p.array.isRequired},render:function(){return (m.createElement("ul",null,this.props.groups.map(this._renderGroup)));},_renderGroup:function(r){var s=r.mercury_thread.participants,t=g.disconnected(),u=k.isUserOffline();return (m.createElement("li",{className:(("_42fz")+(t?' '+"_570-":'')+(u?' '+"_1dcc":'')),"data-id":r.uid,key:r.uid},m.createElement(h,{image:r.mercury_thread.image_src,imageSize:j.getImageSize(),name:r.mercury_thread.name,participants:r.participants_to_render,numOtherParticipants:s.length-1,referrer:i.ORDERED_LIST,status:l.getGroup(s),threadFBID:r.uid})));}});e.exports=q;},null);
__d("ChatSidebarActions",["ChatDispatcher","keyMirror"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();'use strict';var i=h({INIT:null,HIDE:null,SET_ENABLED:null,SHOW:null,TOGGLE:null}),j={Types:i,init:function(){g.dispatch({type:i.INIT});},disable:function(){g.dispatch({type:i.SET_ENABLED,enabled:false});},enable:function(){g.dispatch({type:i.SET_ENABLED,enabled:true});},hide:function(){g.dispatch({type:i.HIDE});},show:function(){g.dispatch({type:i.SHOW});},toggle:function(){g.dispatch({type:i.TOGGLE});}};e.exports=j;},null);
__d("ChatSidebarStore",["ChatDispatcher","ChatOptions","ChatSidebarActions","FluxStore"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';for(var k in j)if(j.hasOwnProperty(k))m[k]=j[k];var l=j===null?null:j.prototype;m.prototype=Object.create(l);m.prototype.constructor=m;m.__superConstructor__=j;function m(){j.call(this,g);this.$ChatSidebarStore0={initialized:false,visible:true,enabled:!!h.getSetting('sidebar_mode')};}m.prototype.__onDispatch=function(n){var o=n.type,p=Object.assign({},this.$ChatSidebarStore0);switch(o){case i.Types.INIT:this.$ChatSidebarStore0.initialized=true;break;case i.Types.HIDE:this.$ChatSidebarStore0.visible=false;break;case i.Types.SHOW:this.$ChatSidebarStore0.visible=true;break;case i.Types.SET_ENABLED:this.$ChatSidebarStore0.enabled=n.enabled;break;case i.Types.TOGGLE:this.$ChatSidebarStore0.enabled=!this.$ChatSidebarStore0.enabled;break;}for(var q in this.$ChatSidebarStore0)if(this.$ChatSidebarStore0.hasOwnProperty(q))if(this.$ChatSidebarStore0[q]!==p[q]){this.__emitChange();break;}};m.prototype.getState=function(){return this.$ChatSidebarStore0;};m.prototype.isInitialized=function(){return this.$ChatSidebarStore0.initialized;};e.exports=new m();},null);
__d("ChatSidebarOptionsListener",["Arbiter","ChatOptions","ChatSidebarActions","ChatSidebarStore"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k={listen:function(){g.subscribe('chat/option-changed',function(l,m){if(m.name==='sidebar_mode'){var n=!!h.getSetting('sidebar_mode');if(n===j.getState().enabled)return;if(n){i.enable();}else i.disable();}});}};e.exports=k;},null);
__d("ChatSidebarComposeLink.react",["ChatOpenTab","React","TooltipLink.react","URI","fbt"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=h,m=l.PropTypes,n=h.createClass({displayName:"ChatSidebarComposeLink",propTypes:{className:m.string.isRequired},componentDidMount:function(){g.listenOpenEmptyTab(h.findDOMNode(this),'sidebar');},render:function(){var o=k._("New Message");return (h.createElement(i,{ajaxify:new j('/ajax/messaging/composer.php'),className:this.props.className,tooltip:o,rel:"dialog"}));}});e.exports=n;},null);
__d("ChatSidebarDropdownConstants",[],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();var g={SOUND:'sound',ADVANCED_SETTINGS:'advanced_settings',TURN_OFF_DIALOG:'turn_off_dialog',CLOSE_ALL_TABS:'close_all_tabs',SIDEBAR:'sidebar',HIDE_GROUPS:'hide_groups',ONLINE:'online',PAUSE:'pause',SHOW_APPS:'show_apps',HIDE_APPS:'hide_apps',SHOW_TICKER:'show_ticker',HIDE_TICKER:'hide_ticker'};e.exports=g;},null);
__d("ChatSidebarDropdown.react",["AppsDivebarDisplayController","Arbiter","AsyncRequest","ChatVisibility","ChatConfig","ChatOptions","ChatSidebarDropdownConstants","ChatTabActions","ContextualDialogArrow","ContextualLayerAutoFlip","Link.react","LogHistory","MenuSeparator.react","PopoverMenu.react","PresenceState","ReactComponentWithPureRenderMixin","React","ReactXUIMenu","SubscriptionsHandler","TrackingNodes","URI","cx","emptyFunction","fbt","ge","joinClasses"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa){b.__markCompiled&&b.__markCompiled();'use strict';var ga=x.Item,ha=x.SelectableItem,ia=x.SelectableMenu,ja=w,ka=ja.PropTypes,la=r.getInstance('blackbird'),ma=w.createClass({displayName:"ChatSidebarDropdown",mixins:[v],propTypes:{className:ka.string,isNormalSidebar:ka.bool,onClickPause:ka.func.isRequired,onHide:ka.func,onShow:ka.func,onToggleSidebar:ka.func.isRequired},getDefaultProps:function(){return {className:'',isNormalSidebar:true,onHide:ca,onShow:ca};},getInitialState:function(){return {appsVisible:g.isVisible(),isTickerVisible:this._getTickerVisibility(),pendingChange:false};},componentDidMount:function(){this._subscriptions=new y();this._subscriptions.addSubscriptions(h.subscribe(['Ticker/resized','ticker/show'],function(){this.setState({isTickerVisible:this._getTickerVisibility()});}.bind(this)),h.subscribe(['AppsDivebar/show-apps','AppsDivebar/hide-apps'],function(){this.setState({appsVisible:g.isVisible()});}.bind(this)));},componentWillUnmount:function(){this._subscriptions&&this._subscriptions.release();},_getTickerVisibility:function(){var na=ea('pagelet_ticker');return !!(na&&na.offsetHeight!==0);},_logVisibilityChange:function(na,oa){var pa=oa?'sidebar_dropdown_visibility_error':'sidebar_dropdown_set_visibility';la.debug(pa,{action:na});},_changeSetting:function(na,oa){if(this.state.pendingChange)return;this.setState({pendingChange:true});var pa={};pa[na]=!oa;l.setSetting(na,!oa,'mini_sidebar_menu');new i('/ajax/chat/settings.php').setHandler(u.doSync).setErrorHandler(function(){return l.setSetting(na,oa,'mini_sidebar_menu_error');}).setFinallyHandler(function(){return this.setState({pendingChange:false});}.bind(this)).setData(pa).setAllowCrossPageTransition(true).send();},_onClickOption:function(na,oa){var pa=true;switch(na){case m.SOUND:this._changeSetting(na,oa);break;case m.ADVANCED_SETTINGS:case m.TURN_OFF_DIALOG:h.inform('chat/advanced-settings-dialog-opened');this._logVisibilityChange(na,false);break;case m.CLOSE_ALL_TABS:n.closeAllTabs();this._logVisibilityChange(na,false);break;case m.HIDE_GROUPS:this._changeSetting(na,oa);break;case m.SIDEBAR:this.props.onToggleSidebar();pa=false;break;case m.ONLINE:!j.isOnline()?j.goOnline():this._logVisibilityChange(na,true);break;case m.PAUSE:this.props.onClickPause(!oa);break;case m.SHOW_TICKER:h.inform('ChatSidebarDropdown/openTicker');break;case m.HIDE_TICKER:h.inform('ChatSidebarDropdown/closeTicker');break;case m.SHOW_APPS:g.showApps();break;case m.HIDE_APPS:g.hideApps();break;}if(pa&&this.refs.menu)this.refs.menu.hidePopover();},_onItemClick:function(na,oa){var pa=oa.item.getValue(),qa=oa.item.isSelected&&oa.item.isSelected();this._onClickOption(pa,!!qa);},_renderChatSoundOption:function(){return (w.createElement(ha,{value:m.SOUND,selected:l.getSetting(m.SOUND)},da._("Chat Sounds")));},_renderAdvancedSettingsOption:function(){return (w.createElement(ga,{href:new aa('/ajax/chat/privacy/settings_dialog.php'),rel:"dialog",value:m.ADVANCED_SETTINGS},da._("Advanced Settings...")));},_renderCloseAllOption:function(){return (w.createElement(ga,{value:m.CLOSE_ALL_TABS},da._("Close All Chat Tabs")));},_renderHideSidebarOption:function(){return (w.createElement(ga,{className:"_2xvi",value:m.SIDEBAR},da._("Hide Sidebar")));},_renderHideGroupsOption:function(){if(!this.props.isNormalSidebar)return null;return (w.createElement(ha,{value:m.HIDE_GROUPS,selected:l.getSetting(m.HIDE_GROUPS)},da._("Hide Groups")));},_renderOnlineOption:function(){var na=j.isOnline(),oa=na?(new aa('/ajax/chat/privacy/settings_dialog.php')).addQueryData('dialog_type','turn_off_dialog'):'#',pa=na?da._("Turn Off Chat"):da._("Turn On Chat"),qa=na?m.TURN_OFF_DIALOG:m.ONLINE;return (w.createElement(ga,{href:oa,rel:na?'dialog':'',value:qa},pa));},_renderAppsOption:function(){if(!k.get('has_apps_option')||!this.props.isNormalSidebar)return null;var na=this.state.appsVisible,oa=na?da._("Hide Games"):da._("Show Games"),pa=na?m.HIDE_APPS:m.SHOW_APPS;return (w.createElement(ga,{value:pa},oa));},_renderPauseOption:function(){if(!k.get('has_pause_render_option'))return null;return (w.createElement(ha,{value:m.PAUSE},"Pause Rendering"));},_renderTickerToggleOption:function(){if(!k.get('has_ticker_toggle_option')||!this.props.isNormalSidebar)return null;var na=this.state.isTickerVisible,oa=na?da._("Hide Ticker"):da._("Show Ticker"),pa=na?m.HIDE_TICKER:m.SHOW_TICKER;return (w.createElement(ga,{value:pa},oa));},_renderConditionalSeparator:function(na){if(!na)return null;return w.createElement(s,null);},_renderMenu:function(){var na=!!k.get('has_pause_render_option')||!!k.get('has_ticker_toggle_option');return (w.createElement(ia,{className:'fbChatSidebarDropdown/PopoverMenu',multiple:true,onItemClick:this._onItemClick},this._renderChatSoundOption(),this._renderAdvancedSettingsOption(),this._renderConditionalSeparator(true),this._renderCloseAllOption(),this._renderHideSidebarOption(),this._renderHideGroupsOption(),this._renderOnlineOption(),this._renderConditionalSeparator(!!k.get('has_apps_option')&&this.props.isNormalSidebar),this._renderAppsOption(),this._renderConditionalSeparator(na&&this.props.isNormalSidebar),this._renderPauseOption(),this._renderTickerToggleOption()));},render:function(){var na=da._("Options"),oa=fa(this.props.className,(("_5qth")+(' '+"_5vm9")+(!j.isOnline()?' '+"_5vma":''))),pa=z.getTrackingInfo(z.types.DROPDOWN_BUTTON);return (w.createElement(t,{alignh:"right",alignv:"top",className:oa,layerBehaviors:[p,o],menu:this._renderMenu(),onHide:this.props.onHide,onShow:this.props.onShow,ref:"menu"},w.createElement(q,{"aria-label":na,className:"_5vmb button","data-ft":pa,"data-hover":"tooltip",href:"#"})));}});e.exports=ma;},null);
__d("ChatBehavior",["Arbiter","AvailableList","AvailableListConstants","MercuryConstants"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j=b('MercuryConstants').ChatNotificationConstants,k=false,l=h.getWebChatNotification&&h.getWebChatNotification(),m=k,n=true,o=Object.assign(new g(),{ON_CHANGED:'changed',notifiesUserMessages:function(){return l!==j.NO_USER_MESSAGE_NOTIFICATION;},ignoresRemoteTabRaise:function(){return m;},showsTabUnreadUI:function(){return n;}});function p(){o.inform(o.ON_CHANGED);}h.subscribe&&h.subscribe(i.ON_CHAT_NOTIFICATION_CHANGED,function(){var q=l,r=h.getWebChatNotification();l=r;if(q!=r)p();});g.subscribe('chat/set_does_page_occlude_tabs',function(q,r){m=!!r;p();});g.subscribe('chat/set_show_tab_unread_ui',function(q,r){n=!!r;p();});e.exports=o;},null);
__d("ChatSidebarSheetChatOffline.react",["Link.react","React","ReactComponentWithPureRenderMixin","fbt"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';var k=h,l=k.PropTypes,m=h.createClass({displayName:"ChatSidebarSheetChatOffline",mixins:[i],propTypes:{onGoOnlineClick:l.func.isRequired},render:function(){return (h.createElement("div",null,j._("{=Go online} to see who's available.",[j.param("=Go online",h.createElement(g,{className:"fbChatGoOnlineLink",onClick:this.props.onGoOnlineClick},j._("Turn on chat")))])));}});e.exports=m;},null);
__d("ChatSidebarSheet",["ArbiterMixin","ChannelConnection","ChannelConstants","ChatBehavior","ChatSidebarSheetChatOffline.react","ChatVisibility","CSS","DOM","Event","JSLogger","PresencePrivacy","React","fbt","mixin","setTimeoutAcrossTransitions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){b.__markCompiled&&b.__markCompiled();var v=p.create('sidebar_sheet');function w(ca){switch(ca){case i.HINT_AUTH:return s._("Your session has timed out. Please log in.");case i.HINT_CONN:return s._("Facebook {Chat} is currently unavailable.",[s.param("Chat",s._("Chat"))]);case i.HINT_MAINT:return s._("Facebook {Chat} is currently down for maintenance.",[s.param("Chat",s._("Chat"))]);default:return s._("Facebook {Chat} is currently unavailable.",[s.param("Chat",s._("Chat"))]);}}function x(ca){var da;if(ca===null||false===navigator.onLine){da=s._("Unable to connect to chat. Check your Internet connection.");}else if(ca>i.WARNING_COUNTDOWN_THRESHOLD_MSEC){var ea=n.create('a',{href:'#',className:'fbChatReconnectLink'},s._("Try again"));da=s._("Unable to connect to chat. {try-again-link}",[s.param("try-again-link",ea)]);}else if(ca>1000){da=s._("Unable to connect to chat. Reconnecting in {seconds}...",[s.param("seconds",Math.floor(ca/1000))]);}else da=s._("Unable to connect to chat. Reconnecting...");return da;}var y=t(g);for(var z in y)if(y.hasOwnProperty(z))ba[z]=y[z];var aa=y===null?null:y.prototype;ba.prototype=Object.create(aa);ba.prototype.constructor=ba;ba.__superConstructor__=y;function ba(ca){"use strict";this._root=ca;this._message=n.find(ca,'div.fbChatSidebarMessage div.message');h.subscribe([h.CONNECTED,h.SHUTDOWN,h.RECONNECTING],this._handleConnectionChange.bind(this));h.subscribe([h.MUTE_WARNING,h.UNMUTE_WARNING],this._render.bind(this));q.subscribe('privacy-user-presence-changed',this._render.bind(this));j.subscribe(j.ON_CHANGED,this._render.bind(this));this._render();}ba.prototype._handleConnectionChange=function(ca,da){"use strict";this._channelStatus=ca;this._channelData=da;this._render();};ba.prototype._renderChannelDisconnect=function(){"use strict";if(this._channelStatus===h.SHUTDOWN){return n.setContent(this._message,w(this._channelData));}else if(this._channelStatus===h.RECONNECTING){var ca=this._channelData;n.setContent(this._message,x(ca));if(ca>1000){if(ca>i.WARNING_COUNTDOWN_THRESHOLD_MSEC)this._warningMsgEventListener=o.listen(this._message,'click',function(event){if(m.hasClass(event.getTarget(),'fbChatReconnectLink')){h.reconnect();return false;}});this._showWarningTimeout=u(this._handleConnectionChange.bind(this,h.RECONNECTING,ca-1000),1000);}}};ba.prototype._renderOffline=function(){"use strict";return r.render(r.createElement(k,{onGoOnlineClick:function(ca){v.log('sidebar_go_online');l.goOnline();}}),this._message);};ba.prototype._clear=function(){"use strict";if(this._showWarningTimeout){clearTimeout(this._showWarningTimeout);this._showWarningTimeout=null;}if(this._warningMsgEventListener){this._warningMsgEventListener.remove();this._warningMsgEventListener=null;}if(this._goOnlineEventListener){this._goOnlineEventListener.remove();this._goOnlineEventListener=null;}m.removeClass(this._root,'offline');m.removeClass(this._root,'error');m.removeClass(this._root,'notice');n.empty(this._message);};ba.prototype._render=function(){"use strict";this._clear();if(!l.isOnline()){m.addClass(this._root,'offline');this._renderOffline();}else if(h.disconnected()){m.addClass(this._root,'error');this._renderChannelDisconnect();}else if(!j.notifiesUserMessages()){m.addClass(this._root,'notice');var ca=s._("Alerts are off while you use another client to chat.");n.setContent(this._message,ca);}this.inform('updated');};Object.assign(ba.prototype,{_channelStatus:null,_channelData:null,_showWarningTimeout:null,_warningMsgEventListener:null,_goOnlineEventListener:null});e.exports=ba;},null);
__d("SidebarFitWindowHeight",["Arbiter","ArbiterMixin","Event","Style","SubscriptionsHandler","UITinyViewportAction","Vector","mixin","queryThenMutateDOM"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();var p=n(h);for(var q in p)if(p.hasOwnProperty(q))s[q]=p[q];var r=p===null?null:p.prototype;s.prototype=Object.create(r);s.prototype.constructor=s;s.__superConstructor__=p;function s(t){"use strict";this.$SidebarFitWindowHeight0=t;this.onViewportUpdate();l.subscribe('change',this.onViewportUpdate.bind(this));}s.prototype.onViewportUpdate=function(){"use strict";if(l.isTiny()){this.onScroll();var t=this.onScroll.bind(this);this.$SidebarFitWindowHeight1=new k();this.$SidebarFitWindowHeight1.addSubscriptions(i.listen(window,'scroll',t),g.subscribe('dom-scroll',t));}else{if(this.$SidebarFitWindowHeight2!==0){j.set(this.$SidebarFitWindowHeight0,'margin-top','0');this.$SidebarFitWindowHeight2=0;}this.$SidebarFitWindowHeight1&&this.$SidebarFitWindowHeight1.release();}};s.prototype.onScroll=function(){"use strict";o(this.updateScrollPosition.bind(this),this.resizeSidebar.bind(this),'SidebarFitWindowHeight/scroll');};s.prototype.updateScrollPosition=function(){"use strict";this.$SidebarFitWindowHeight3=m.getScrollPosition().y;this.$SidebarFitWindowHeight4||(this.$SidebarFitWindowHeight4=this.$SidebarFitWindowHeight0.offsetHeight);};s.prototype.resizeSidebar=function(){"use strict";var t=-Math.max(Math.min(this.$SidebarFitWindowHeight3,this.$SidebarFitWindowHeight4),0);j.set(this.$SidebarFitWindowHeight0,'margin-top',t+'px');if(t!=this.$SidebarFitWindowHeight2){this.$SidebarFitWindowHeight2=t;this.inform('resized',t);}};s.prototype.getOffset=function(){"use strict";return this.$SidebarFitWindowHeight2;};e.exports=s;},null);
__d("ChatSidebar",["Arbiter","ArbiterMixin","AsyncRequest","BanzaiODS","Bootloader","ChatConfig","ChatImpressionLogger","ChatOptions","ChatOrderedList","ChatSidebarActions","ChatSidebarOptionsListener","ChatSidebarComposeLink.react","ChatSidebarDropdown.react","ChatSidebarSheet","ChatSidebarStore","CSS","DOM","DOMDimensions","Event","JSLogger","LitestandClassicPlaceHolders","MercuryConfig","OrderedFriendsList","Parent","PresencePrivacy","React","ScrollableArea","SidebarFitWindowHeight","Style","ViewportBounds","createArrayFromMixed","csx","cx","debounce","emptyFunction","ge","performanceAbsoluteNow"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa){b.__markCompiled&&b.__markCompiled();var ra='chat_sidebar_visibility',sa,ta,ua=false,va=false,wa=false,xa=false,ya=false,za,ab,bb,cb,db,eb,fb,gb,hb,ib=null,jb,kb=z.create('chat_sidebar');j.setEntitySample(ra,.0001);function lb(){v.removeClass(document.documentElement,'sidebarMode');if(!wb.isInitialized()||(!wb.isVisible()&&!xa)){g.inform('reflow');return;}wa=false;xa=false;ib=null;eb.hide();gb.getCore().reset();v.hide(cb);v.hide(ab);v.hide(bb);v.removeClass(document.documentElement,'miniSidebar');v.removeClass(cb,"_51xq");za&&za.setProps({shown:false},function(){return rb(false);});kb.log('minisidebar_hide');g.inform('sidebar/hide',wb);g.inform('reflow');}function mb(){var xb=wb.shouldShowSidebar(),yb=wb.shouldShowMiniSidebar();if(wb.isEnabled()&&(xb||yb)){if(xb){pb();qb();}else sb();}else lb();if(!wb.isInitialized()){vb();p.init();}ib=null;}function nb(){if(gb&&wb.isVisible())gb.getCore().getElement().focus();}function ob(xb){var yb=hb.height;xb.forEach(function(zb){if(zb&&zb!==sa)yb-=x.getElementDimensions(zb).height;});if(jb)yb-=jb.getOffset();if(fb)yb-=x.getElementDimensions(fb).height;return Math.max(0,yb);}function pb(){if(wb.isVisible())return;v.hide(ab);v.show(bb);v.removeClass(document.documentElement,'miniSidebar');v.removeClass(cb,"_51xq");za&&za.setProps({shown:false},function(){return rb(false);});wa=true;xa=false;ib=null;v.show(cb);v.addClass(document.documentElement,'sidebarMode');eb.show();kb.log('sidebar_show');g.inform('sidebar/show',wb);aa.destroy('sidebar');}function qb(){var xb=ob(ka(bb.childNodes)),yb=eb.getItemHeight(),zb=8,ac=Math.floor((xb-zb)/yb);ia.set(sa,'height',xb+'px');eb.setNumTopFriends(ac);if(ba.ScrollableSidebarTypeaheadGK){gb.getView().setMaxHeight(xb);}else{var bc=Math.floor((xb-zb)/yb);bc=(bc-2)>0?bc-2:0;gb.getData().setMaxResults(bc);}g.inform('sidebar/resized',wb);g.inform('reflow');}function rb(xb){if(cb===null)return;v.conditionClass(cb,"_2e4g",xb);}function sb(){v.hide(bb);v.show(ab);v.show(cb);v.addClass(document.documentElement,'sidebarMode');v.addClass(document.documentElement,'miniSidebar');v.addClass(cb,"_51xq");var xb=ob([]);if(!za){k.loadModules(["ChatMiniSidebar.react","ChatSearchSource"],function(yb,zb){if(!ta)ta=new zb({queryRequests:[{uri:'/ajax/mercury/composer_query.php'}]});za=fa.render(fa.createElement(yb,{dataSource:ta,height:xb,maxEntries:50,onClickSearch:rb,onToggleSidebar:wb.toggle,shown:true}),ab);});}else za.setProps({height:xb,shown:true});wa=false;xa=true;aa.destroy('sidebar');kb.log('minisidebar_show');g.inform('minisidebar/show',wb);g.inform('reflow');}function tb(){n.setSetting('sidebar_mode',wb.isEnabled(),'sidebar');new i('/ajax/chat/settings.php').setHandler(oa).setErrorHandler(oa).setData({sidebar_mode:wb.isEnabled()}).setAllowCrossPageTransition(true).send();}function ub(){return ca.getActiveList().length<=l.get('sidebar.min_friends');}function vb(){var xb=true;if(!wb.isEnabled()){kb.log('state_not_enabled');xb=false;}if(!wb.isViewportCapable())if(!wb.isViewportCapableForMiniSidebar()){kb.log('state_not_shown_viewport_mini');xb=false;}if(xb)j.bumpEntityKey(ra,'state_viewport_can_show');if(va){kb.log('state_not_shown_hidden');xb=false;}if(ub()){kb.log('state_not_shown_num_friends');xb=false;}var yb=xb?'state_shown':'state_not_shown';kb.log(yb);j.bumpEntityKey(ra,yb);}var wb={init:function(xb,yb,zb,ac){wb.init=oa;this._initTime=qa();ya=true;cb=xb;eb=yb;gb=zb;db=ac;sa=w.find(xb,'div.fbChatSidebarBody');ab=w.find(xb,"._51x-");bb=w.find(xb,"._51x_");fb=w.find(xb,"._5qqe");var bc=w.find(xb,"._x1u");bc&&fa.render(fa.createElement(r,{className:"_3a-4 _5q85"}),bc);if(l.get('sidebar_react_dropdown',false)){var cc=w.find(xb,"._1ltf");cc&&fa.render(fa.createElement(s,{isNormalSidebar:true,onClickPause:function(ec){ec?o._pause():o._unpause();},onToggleSidebar:function(){return p.toggle();}}),cc);}y.listen(window,'resize',mb);var dc=new t(xb);dc.subscribe('updated',mb);eb.setScrollContainer(da.byClass(eb.getRoot(),'uiScrollableAreaWrap'));eb.subscribe(['render','show','hide'],na(function(ec){var fc=ga.getInstance(eb.getRoot());fc&&fc.adjustGripper();}));q.listen();g.subscribe('chat/option-changed',function(ec,fc){if(fc.name==='hide_groups')mb();});g.subscribe(['AppsDivebar/show-apps','AppsDivebar/hide-apps'],mb);zb.getCore().subscribe('sidebar/typeahead/active',wb.updateOnActiveTypeahead);zb.subscribe('reset',function(){if(!zb.getCore().getValue()&&!eb.isVisible())wb.updateOnActiveTypeahead(null,false);});g.subscribeOnce('buddylist-nub/initialized',function(ec,fc){y.listen(fc.getButton(),'click',function(event){var gc=va;va=false;p.enable();var hc=wb.shouldShowSidebar()||wb.shouldShowMiniSidebar();va=gc&&!hc;return !hc;});});ua=!!n.getSetting('sidebar_mode');ea.subscribe('privacy-user-presence-changed',mb);mb();m.init(eb);ja.addPersistentRight(wb.getVisibleWidth);wb.inform('sidebar/initialized',wb,g.BEHAVIOR_PERSISTENT);g.inform('sidebar/initialized',wb,g.BEHAVIOR_PERSISTENT);jb=new ha(fb);jb.subscribe('resized',mb);u.addListener(function(){var ec=u.getState();if(ec.enabled){this.enable();}else this.disable();}.bind(this));},updateOnActiveTypeahead:function(xb,yb){if(!wa)return;if(yb){eb.hide();}else{eb.show();mb();}},isInitialized:function(){return u.isInitialized();},disable:function(){if(!wb.isEnabled())return;ua=false;tb();lb();},enable:function(){if(wb.isEnabled())return;ua=true;tb();mb();setTimeout(nb,0);},ensureLoaded:function(){if(!ua)return;if(ya)return;if(pa('pagelet_sidebar'))return;d(['UIPagelet'],function(xb){var yb=w.create('div',{id:'pagelet_sidebar'});w.appendContent(document.body,yb);xb.loadFromEndpoint('SidebarPagelet','pagelet_sidebar');});ya=true;},hide:function(){if(va)return;va=true;lb();},unhide:function(){if(!va)return;va=false;mb();},getBody:function(){return sa;},getRoot:function(){return cb;},getVisibleWidth:function(){if((!wa&&!xa)||!cb)return 0;if(ib===null){ib=cb.offsetWidth;if(xa)ib=206;}return ib;},isEnabled:function(){return ua;},isViewportCapable:function(){hb=x.getViewportWithoutScrollbarDimensions();var xb=l.get('sidebar.minimum_width');return hb.width>xb;},shouldShowSidebar:function(){var xb=wb.isViewportCapable();return xb&&!va&&!ub();},isViewportCapableForMiniSidebar:function(){hb=x.getViewportWithoutScrollbarDimensions();var xb=l.get('sidebar.minimum_width'),yb=l.get('minisidebar.minimum_width');return hb.width>yb&&hb.width<=xb;},shouldShowMiniSidebar:function(){var xb=wb.isViewportCapableForMiniSidebar();return xb&&!va&&!ub();},isVisible:function(){return wa;},resize:mb,toggle:function(){p.toggle();},getInitTime:function(){return this._initTime;}};Object.assign(wb,h);e.exports=wb;},null);
__d("ChatSidebarLog",["AsyncSignal","Banzai","BanzaiLogger","Bootloader","ChatPerfEvent","csx","DOM","ErrorUtils","ModuleDependencies","JSLogger","Run","copyProperties","performanceAbsoluteNow"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){b.__markCompiled&&b.__markCompiled();var t=p.create('chat_sidebar_load'),u=null,v=false,w=(Math.random()*2147483648|0).toString(36),x=Date.now(),y=null,z=false;q.onLoad(function(){v=true;});try{d(['ChatSidebar'],function(ga){u=ga;});}catch(aa){t.warn('exception',{reason:aa.toString()});}function ba(ga,ha){if(ga&&ga.length>ha)return ga[ha];return null;}function ca(ga){if(ga.name=='SyntaxError'||/syntaxerror/i.test(ga.message))z=true;}function da(){if(!y)y=i.create(r({retry:true},h.VITAL));return y;}function ea(ga){setTimeout(function(){var ha=o.getMissing('ChatSidebar'),ia=j.getErrorUrls(),ja=j.getLoadingUrls(),ka=[];for(var la in ja)ka.push({url:la,time:ja[la]});ka.sort(function(sa,ta){return ta.time-sa.time;});var ma={};for(var na=0,oa=ka.length;na<oa;na++)ma[ka.url]=ka.time;var pa={start_gap:x-j.getStartTime(),page_loaded:v,page_id:w,timeout:ga,missing_total:ha?ha.length:null,module_1:ba(ha,0),module_2:ba(ha,1),module_3:ba(ha,2),error_url_total:ia.length,error_url_1:ba(ia,0),error_url_2:ba(ia,1),error_url_3:ba(ia,2),loading_url_total:ka.length,loading_url_1:ba(ka,0)?ba(ka,0).url:null,loading_time_1:ba(ka,0)?ba(ka,0).time:null,loading_url_2:ba(ka,1)?ba(ka,1).url:null,loading_time_2:ba(ka,1)?ba(ka,1).time:null,loading_url_3:ba(ka,2)?ba(ka,2).url:null,loading_time_3:ba(ka,2)?ba(ka,2).time:null},qa=null;if(!u){t.warn('require_'+ga,{missing:ha});qa='require';}if(u&&!u.isInitialized()){t.warn('init_'+ga,{missing:ha});qa='init';}if(u&&u.isInitialized()&&u.isEnabled()&&u.shouldShowSidebar()){var ra=m.scry(u.getRoot(),"._42fz");if(!ra||ra.length===0){t.warn('render_'+ga,{missing:ha});qa='render';}}if(qa){pa.symptom=qa;new g('/ajax/chat/sidebar_load.php',pa).send();da().log('SidebarLoadFailureLoggerConfig',{start_gap:x-j.getStartTime(),page_loaded:v,page_id:w,timeout:ga,symptom:qa,has_syntax_error:z});}},ga);}var fa={start:function(ga){this._serverStartTime=s();n.addListener(ca);ea(5000);ea(10000);ea(15000);ea(30000);ea(60000);},logRendered:function(){if(this._loggedPerformance)return;var ga=s();if(this._serverStartTime)i.log('ChatPerfLoggerConfig',{event:k.SIDEBAR_FROM_SERVER_TTI,duration:ga-this._serverStartTime});var ha=u&&u.getInitTime();if(ha)i.log('ChatPerfLoggerConfig',{event:k.SIDEBAR_FROM_CLIENT_TTI,duration:ga-ha});this._loggedPerformance=true;}};e.exports=fa;},null);
__d("ChatSidebarUser.react",["ChatOpenTab","ChatSidebarItem.react","WebMessengerPermalinkConstants","ReactComponentWithPureRenderMixin","React"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();var l=k,m=l.PropTypes,n=k.createClass({displayName:"ChatSidebarUser",mixins:[j],propTypes:{birthday:m.bool,detailedStatus:m.string,image:m.string,imageSize:m.number,name:m.string,sectionName:m.string.isRequired,slot:m.number,status:m.number,statusTime:m.string,unreadCount:m.number,userID:m.string.isRequired,nowData:m.object},_openTab:function(event){g.openUserTab(this.props.userID,this.props.sectionName,{global_slot:this.props.slot});return event.preventDefault();},render:function(){var o=i.getURIPathForIDOrVanity(this.props.userID);return (k.createElement(h,{onClick:this._openTab,href:o,imageSize:this.props.imageSize,image:this.props.image,name:this.props.name,status:this.props.status,birthday:this.props.birthday,statusTime:this.props.statusTime,detailedStatus:this.props.detailedStatus,context:this.props.context,unreadCount:this.props.unreadCount,nowData:this.props.nowData}));}});e.exports=n;},null);
__d("ChatUnreadCount",["ArbiterMixin","ChatConfig","Map","MercuryIDs","MercurySingletonMixin","MercuryThreadInformer","MercuryThreads","MercuryUnreadState","mixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){b.__markCompiled&&b.__markCompiled();var p=o(g);for(var q in p)if(p.hasOwnProperty(q))s[q]=p[q];var r=p===null?null:p.prototype;s.prototype=Object.create(r);s.prototype.constructor=s;s.__superConstructor__=p;function s(t){"use strict";this.$ChatUnreadCount0=t;this.$ChatUnreadCount1=l.getForFBID(t);this.$ChatUnreadCount2=m.getForFBID(t);this.$ChatUnreadCount3=new i();this.$ChatUnreadCount4=n.getForFBID(t);this.setupSubscriptions();}s.prototype.getUnreadCountForUID=function(t){"use strict";if(!h.get('unread_count_enabled')||!t)return null;var u=j.getThreadIDFromUserID(t);if(!this.$ChatUnreadCount4.getIsThreadUnread(u)){this.$ChatUnreadCount3["delete"](t);return 0;}var v=this.$ChatUnreadCount2.getOrFetch(u),w=v&&v.unread_count;this.$ChatUnreadCount3.set(t,w);return w;};s.prototype.setupSubscriptions=function(){"use strict";if(!h.get('unread_count_enabled'))return;this.$ChatUnreadCount1.subscribe('threads-updated',function(t,u){var v=Object.keys(u).some(function(w){var x=j.getUserIDFromThreadID(w);if(x===null)return false;var y=this.$ChatUnreadCount3.get(x)||0;return this.getUnreadCountForUID(x)!==y;}.bind(this));if(v)this.inform('unread-count-changed');}.bind(this));this.$ChatUnreadCount1.subscribe('unread-updated',function(){return this.inform('unread-count-changed');}.bind(this));};Object.assign(s,k);e.exports=s;},null);
__d("ChatSidebarUserGroup.react",["AvailableList","AvailableListConstants","ChannelConnection","ChatContexts","ChatSidebarSections","ChatSidebarUser.react","LastMobileActiveTimes","PresencePrivacy","PresenceStatus","React","ShortProfiles","SubscriptionsHandler","WorkModeConfig","cx","shield","ChatUnreadCount"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){b.__markCompiled&&b.__markCompiled();var v=b('ChatUnreadCount').get(),w=p,x=w.PropTypes,y=Object.keys(k).map(function(aa){return k[aa];}),z=p.createClass({displayName:"ChatSidebarUserGroup",propTypes:{ids:x.array.isRequired,sectionName:x.oneOf(y).isRequired,nowDataFetcher:x.func},getInitialState:function(){return {userData:[]};},_onAvailabilityChanged:function(aa,ba){if(!ba||this.props.ids.indexOf(ba)!==-1)this.forceUpdate();},componentWillMount:function(){this.componentWillReceiveProps(this.props);this._subscriptions=new r();this._subscriptions.addSubscriptions(g.subscribe(h.ON_AVAILABILITY_CHANGED,this._onAvailabilityChanged),v.subscribe('unread-count-changed',u(this.forceUpdate,this)));},componentWillUnmount:function(){this._subscriptions.release();},componentWillReceiveProps:function(aa){q.getMulti(aa.ids,function(ba){var ca=aa.ids.map(function(da){return ba[da];});this.setState({userData:ca});}.bind(this));},_renderProfile:function(aa,ba){var ca=s.is_work_user;if(aa.id===0||!(aa.is_friend||ca))return null;var da=o.get(aa.id),ea=(da!==h.ACTIVE)?m.getShortDisplay(aa.id):null,fa=(da===h.ACTIVE)?o.getDetailedActivePresence(aa.id):null,ga=i.disconnected(),ha=!n.allows(aa.id),ia=j.getShortDisplay(aa.id),ja=this.props.nowDataFetcher?this.props.nowDataFetcher(aa.id):null;return (p.createElement("li",{className:(("_42fz")+(ia?' '+"_52zj":'')+(ga?' '+"_570-":'')+(ha?' '+"_1dcc":'')),"data-id":aa.id,key:aa.id},p.createElement(l,{birthday:aa.is_birthday,context:ia,detailedStatus:fa,image:aa.thumbSrc,imageSize:this.props.imageSize,name:aa.name,sectionName:this.props.sectionName,slot:ba,status:da,statusTime:ea,userID:aa.id,nowData:ja,unreadCount:v.getUnreadCountForUID(aa.id)})));},render:function(){return (p.createElement("ul",p.__spread({},this.props),this.state.userData.map(this._renderProfile)));}});e.exports=z;},null);
__d("XNowQueryController",["XController"],function(a,b,c,d,e,f){b.__markCompiled&&b.__markCompiled();e.exports=b("XController").create("\/status\/sidebar\/",{});},null);
__d("NowPoller",["Arbiter","Poller","XNowQueryController"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j=5000;function k(n,o){"use strict";this.$NowPoller0=n;this.$NowPoller1=new h({interval:j,setupRequest:this.$NowPoller2.bind(this),clearOnQuicklingEvents:false,dontStart:true});this.$NowPoller3=o;this.$NowPoller4=null;}k.prototype.$NowPoller2=function(n){"use strict";this.$NowPoller5=Date.now();n.setHandler(this.$NowPoller6.bind(this)).setErrorHandler(this.$NowPoller7.bind(this)).setOption('suppressErrorAlerts',true).setOption('retries',1).setData({section:this.$NowPoller3,includeusers:this.$NowPoller4}).setURI(i.getURIBuilder().getURI()).setAllowCrossPageTransition(true);};k.prototype.$NowPoller6=function(n){"use strict";var o=n.getPayload();this.$NowPoller0({pinnedfriends:o.pinned,topfriends:o.top_friends,mostrecent:o.most_recent,self:o.self});};k.prototype.$NowPoller7=function(n){"use strict";};k.prototype.setIncludeUsers=function(n){"use strict";this.$NowPoller4=n;};k.prototype.start=function(){"use strict";setTimeout(this.$NowPoller1.start.bind(this.$NowPoller1),0);};k.prototype.restart=function(){"use strict";if(this.$NowPoller1.isMuted()){this.$NowPoller1.resume();this.forceUpdate();}};k.prototype.stop=function(){"use strict";this.$NowPoller1.mute();};k.prototype.forceUpdate=function(){"use strict";this.$NowPoller1.request();};var l,m;k.start=function(){if(!l){l=new k(function(n){g.inform('Now/updatedData',n);},'all');if(m)l.setIncludeUsers(m);l.start();}};k.setIncludeUsers=function(n){m=n;if(l)l.setIncludeUsers(m);};k.forceUpdate=function(){if(l)l.forceUpdate();};k.listenForUpdate=function(n){g.subscribe('Now/updatedData',function(o,p){n(p);});};e.exports=k;},null);
__d("ChatSidebarOrderedList.react",["Animation","AsyncDialog","AsyncRequest","BanzaiODS","ChatQuietLinks","ChatSidebarConstants","ChatSidebarGroupThreadsGroup.react","ChatSidebarLog","ChatSidebarSections","ChatSidebarUserGroup.react","NowPoller","PresencePrivacy","ReactComponentWithPureRenderMixin","React","Scroll","URI","cx","fbt"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){b.__markCompiled&&b.__markCompiled();var y='chat_sidebar_visibility',z=t,aa=z.PropTypes;j.setEntitySample(y,.0001);var ba=t.createClass({displayName:"ChatSidebarOrderedList",propTypes:{topUsers:aa.array.isRequired,availableUsers:aa.array.isRequired,isSidebar:aa.bool.isRequired,scrollContainer:aa.object,groups:aa.array.isRequired,showNow:aa.bool},getInitialState:function(){return {nowData:{}};},componentDidMount:function(){n.logRendered&&n.logRendered();k.nukeLinks(t.findDOMNode(this));this._logFriendCount();if(this.props.showNow){q.listenForUpdate(function(da){return this.setState({nowData:da});}.bind(this));q.start();}},_scrollToSeparator:function(da){if(!this.props.scrollContainer)return;var ea=this.props.scrollContainer.scrollHeight,fa=this.props.scrollContainer.clientHeight,ga=u.getTop(this.props.scrollContainer),ha=Math.min(da.offsetTop,ea-fa);if(ga!==ha){var ia=Math.abs(ha-ga)/this.props.scrollContainer.clientHeight*500;new g(this.props.scrollContainer).to('scrollTop',ha).ease(g.ease.end).duration(ia).go();}},_openBlackbirdSettings:function(){var da=new v('/ajax/chat/privacy/settings_dialog.php').addQueryData({ref:'whitelist_separator'});h.send(new i(da));},_renderOfflineSection:function(){var da=l.getImageSize(this.props.isSidebar),ea=this.props.topUsers.filter(function(ga){return !r.allows(ga);});ea.splice(-2);var fa=(t.createElement("a",{href:"#",onClick:this._openBlackbirdSettings},x._("Edit")));return [t.createElement("div",{key:"users_separator1",className:"_554m"},t.createElement("div",{className:"_554o"},t.createElement("div",{className:"_554n"},t.createElement("span",{className:"_554p"},x._("MORE FRIENDS")),t.createElement("div",{className:"_554q"},t.createElement("span",{className:"_554r"}))))),t.createElement("div",{key:"users_separator2",className:"_554m blackbirdWhitelist"},t.createElement("div",{className:"_554o"},t.createElement("div",{className:"_554n"},t.createElement("div",{className:"_5v-d"},t.createElement("span",{className:"_554t"},x._("These friends can't see you on chat. {=link}",[x.param("=link",fa)])))))),t.createElement(p,{key:o.OFFLINE_USERS,sectionName:o.OFFLINE_USERS,ids:ea,imageSize:da})];},_renderOnlineSection:function(){if(this.props.availableUsers.length===0)return null;var da=l.getImageSize(this.props.isSidebar);return [t.createElement("div",{key:"users_separator",ref:"usersSeparator",onClick:function(){return this._scrollToSeparator(t.findDOMNode(this.refs.usersSeparator));}.bind(this),className:"_554m moreOnlineFriends"},t.createElement(ca,null,x._("{MORE ONLINE FRIENDS} ({=count})",[x.param("MORE ONLINE FRIENDS",x._("MORE FRIENDS")),x.param("=count",this.props.availableUsers.length)]))),t.createElement(p,{key:o.MORE_ONLINE_FRIENDS,sectionName:o.MORE_ONLINE_FRIENDS,ids:this.props.availableUsers,imageSize:da})];},_renderGroupsSection:function(){if(this.props.groups.length===0)return null;return [t.createElement("div",{key:"group_separator",ref:"groupSeparator",onClick:function(){return this._scrollToSeparator(t.findDOMNode(this.refs.groupSeparator));}.bind(this),className:"_554m moreOnlineFriends"},t.createElement(ca,null,x._("GROUP CONVERSATIONS"))),t.createElement(m,{key:"group_threads_section",groups:this.props.groups})];},render:function(){var da=l.getImageSize(this.props.isSidebar),ea=this.props.topUsers;if(r.getVisibility()==r.ONLINE)ea=this.props.topUsers.filter(function(la){return r.allows(la);});var fa=(r.getOnlinePolicy()==r.ONLINE_TO_WHITELIST&&r.getVisibility())?this._renderOfflineSection():this._renderOnlineSection(),ga=null,ha=null;if(this.props.showNow&&this.state.nowData){var ia=ea,ja=[];if(this.state.nowData.pinnedfriends)ja=this.state.nowData.pinnedfriends.map(function(la){return la.user_id;});if(this.state.nowData.topfriends)ea=this.state.nowData.topfriends.map(function(la){return la.user_id;});ia=ia.filter(function(la){return (ja.indexOf(la)==-1);});q.setIncludeUsers(ia);ia=ia.filter(function(la){return (ea.indexOf(la)==-1);});ia.forEach(function(la){ea.push(la);});var ka=function(la){var ma=null;if(this.state.nowData.pinnedfriends)this.state.nowData.pinnedfriends.forEach(function(na){if(na.user_id==la)ma=na;});if(this.state.nowData.topfriends)this.state.nowData.topfriends.forEach(function(na){if(na.user_id==la)ma=na;});return ma;}.bind(this);ga=t.createElement("div",null,t.createElement(ca,null,x._("PINNED FRIENDS")),t.createElement(p,{ids:ja,imageSize:da,key:o.NOW_PINNED_LIST,nowDataFetcher:ka,sectionName:o.NOW_PINNED_LIST}));ha=t.createElement("div",null,t.createElement(ca,null,x._("TOP FRIENDS")),t.createElement(p,{key:o.ORDERED_LIST,ids:ea,imageSize:da,nowDataFetcher:ka,sectionName:o.ORDERED_LIST}));}else ha=t.createElement(p,{key:o.ORDERED_LIST,ids:ea,imageSize:da,sectionName:o.ORDERED_LIST});return (t.createElement("li",null,ga,ha,this._renderGroupsSection(),fa));},_logFriendCount:function(){this._logTimeout=setTimeout(function(){j.bumpEntityKey(y,this.props.availableUsers.length===0?'state_list_empty':'state_list_mounted');}.bind(this),5000);}}),ca=t.createClass({displayName:"ChatSidebarSeparator",mixins:[s],render:function(){return (t.createElement("div",{className:"_554o"},t.createElement("div",{className:"_554n"},t.createElement("span",{className:"_554p"},this.props.children),t.createElement("div",{className:"_554q"},t.createElement("span",{className:"_554r"})))));}});e.exports=ba;},null);
__d("ChatSortUsers",["AvailableListConstants","OrderedFriendsList","PresencePrivacy","PresenceStatus","ShortProfiles","TokenizeUtil"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();function m(q,r){var s=i.allows(q),t=i.allows(r);if(s!==t)return s?-1:1;return 0;}var n={};function o(q){if(n[q])return n[q];var r=(k.getNowUnsafe(q)||{}).name;if(r)return n[q]=l.flatten(r);return '~';}var p={sortAlphabetical:function(q,r){var s=o(q),t=o(r);if(s!==t)return s<t?-1:1;return 0;},sortMobile:function(q,r){var s=j.get(q)===g.MOBILE,t=j.get(r)===g.MOBILE;if(s!==t)return t?-1:1;return p.sortAlphabetical(q,r);},sortCoefficient:function(q,r){var s=h.getRank(q),t=h.getRank(r);if(s!==t)return s-t;return p.sortAlphabetical(q,r);},sort:function(q,r){var s=m(q,r);if(s!==0)return s;return p.sortCoefficient(q,r);}};e.exports=p;},null);
__d("ChatOrderedList",["Arbiter","ArbiterMixin","AvailableList","AvailableListConstants","CSS","ChatConfig","ChatOptions","ChatHovercard","ChatOrderedListHover","ChatSidebarConstants","ChatSidebarInboxConfig","ChatSidebarOrderedList.react","ChatSortUsers","ChatVisibility","DOM","DataStore","Event","JSLogger","OrderedFriendsList","Parent","PresencePrivacy","PresenceStatus","React","createObjectFrom","csx","debounceAcrossTransitions","mixin","shield"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha){b.__markCompiled&&b.__markCompiled();var ia=null,ja,ka=ga(h);for(var la in ka)if(ka.hasOwnProperty(la))na[la]=ka[la];var ma=ka===null?null:ka.prototype;na.prototype=Object.create(ma);na.prototype.constructor=na;na.__superConstructor__=ka;function na(oa,pa){"use strict";this._isSidebar=oa;this._root=pa;this._isVisible=false;this._excludedIds={};this._numTopFriends=5;this._groups=[];this._hoverController=null;this._orderedList=u.find(this._root,'.fbChatOrderedList');this._scrollableOrderedList=z.byClass(this._root,'scrollableOrderedList');this._scrollableArea=z.byClass(this._root,'scrollable');if(this._isSidebar)new n(this);g.subscribe(x.DUMP_EVENT,function(qa,ra){ra.chat_lists=ra.chat_lists||{sorted_list:this.getCachedSortedList(),ordered_list:y.getList(),available_list:na.getAvailableList(this._excludedIds),excluded_list:this._excludedIds};}.bind(this));aa.subscribe('privacy-user-presence-changed',ha(this._render,this));i.subscribe(j.ON_AVAILABILITY_CHANGED,ha(this._render,this));}na.prototype.getShowingUsers=function(){"use strict";return u.scry(this._root,"li._42fz,li._5a58").map(this.getUserForNode);};na.prototype.getUserForNode=function(oa){"use strict";return v.get(oa,'id')||v.get(oa,'serverthreadid');};na.prototype.getHoverController=function(){"use strict";if(!this._hoverController)this._hoverController=new o(this);return this._hoverController;};na.prototype.getItemHeight=function(){"use strict";return p.getItemHeight(this._isSidebar);};na.prototype.getRoot=function(){"use strict";return this._root;};na.prototype.getSortedList=function(oa){"use strict";return na.getSortedList(oa||this._excludedIds,this._numTopFriends);};na.prototype.getCachedSortedList=function(oa){"use strict";if(ia==null)ia=this.getSortedList(oa);return ia;};na.prototype.hide=function(){"use strict";if(!this._isVisible)return;this._isVisible=false;k.hide(this._scrollableOrderedList||this._root);this.inform('hide');};na.prototype.setNumTopFriends=function(oa){"use strict";var pa=na.getGroups(),qa=oa-pa.length;if(qa>l.get('min_top_friends'))oa=qa;if(oa!==this._numTopFriends||pa.length!==this._groups.length){this._groups=pa;this._numTopFriends=oa;this._render();}};na.prototype._renderOrderedList=function(){"use strict";if(!this._isVisible||ja)return;var oa=na.getSortedList({},this._numTopFriends),pa=na.getAvailableList(da(oa));pa.sort(s.sortMobile);var qa=q.component;if(qa){ca.render(ca.createElement(qa,{showCount:q.show_count,showPresence:q.show_presence,threadCount:this._numTopFriends}),this._orderedList);}else ca.render(ca.createElement(r,{availableUsers:pa,isSidebar:this._isSidebar,scrollContainer:this._scrollContainer,topUsers:oa,groups:na.getGroups(),showNow:l.get('badger_www_nub')}),this._orderedList);this.inform('render');};na.prototype._render=function(){"use strict";this._render=fa(this._renderOrderedList.bind(this),300);this._render();};na.prototype.show=function(){"use strict";if(this._isVisible)return;this._isVisible=true;k.show(this._scrollableOrderedList||this._root);this._render();this.inform('show');};na.prototype.isVisible=function(){"use strict";return this._isVisible;};na.prototype.setScrollContainer=function(oa){"use strict";if(u.contains(oa,this._root))this._scrollContainer=oa;};na.getGroups=function(){"use strict";if(!m.getSetting('hide_groups')){return y.getGroups();}else return [];};na.getSortedList=function(oa,pa){"use strict";var qa=y.getList().filter(function(ta){return !(ta in oa)&&aa.getFriendVisibility(ta)!==aa.BLACKLISTED;});if(!t.isOnline())if(aa.getOnlinePolicy()===aa.ONLINE_TO_WHITELIST)qa=this._filterByWhitelist(qa);var ra=qa.slice(0,pa);if(ra.length===pa){var sa=na.getAvailableList(ra.concat(oa)).length;sa&&ra.splice(-1);}ia=ra.slice();return ra;};na._filterByWhitelist=function(oa){"use strict";var pa=oa,qa={},ra,sa;oa=[];for(ra=0;ra<pa.length;++ra){sa=pa[ra];if(aa.allows(sa)){qa[sa]=true;oa.push(sa);}}var ta=aa.getWhitelist();for(ra=0;ra<ta.length;++ra){sa=ta[ra];if(!(sa in qa))oa.push(sa);}for(ra=0;ra<pa.length;++ra){sa=pa[ra];if(!aa.allows(sa))oa.push(sa);}return oa;};na.getAvailableList=function(oa){"use strict";var pa;if(!pa)pa=ba.getOnlineIDs();return pa.filter(function(qa){return !(qa in oa);});};na._pause=function(){"use strict";ja=true;};na._unpause=function(){"use strict";ja=false;};na._registerToggleRenderItem=function(oa){"use strict";w.listen(oa,'click',function(){ja=!ja;k.conditionClass(oa,'checked',ja);});};e.exports=na;},null);
__d("ChatTypeaheadBehavior",["BanzaiLogger","ChatOpenTab","ChatTypeaheadEvent","CSS","MercuryTypeaheadConstants","Parent","Rect","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){b.__markCompiled&&b.__markCompiled();function o(q,r){var s=l.byClass(q,"_4oes");if(s)j.conditionClass(s,"_5q83",r);}function p(q){"use strict";this._typeahead=q;this._loggedQuery=false;}p.prototype.enable=function(){"use strict";var q=this._typeahead;this._subscriptions=[q.subscribe('focus',function(){this._loggedQuery=false;q.getData().refreshData();o(q.getElement(),true);}.bind(this)),q.subscribe('blur',function(r){if(this._loggedQuery)g.log('ChatTypeaheadLoggerConfig',{event:i.ABANDONED_QUERY,max_results:q.getData().getMaxResults(),num_friend_results:q.getView().results.filter(function(s){return s.render_type===k.FRIEND_TYPE;}).length,query:q.getCore().value});q.getCore().reset();o(q.getElement(),false);this._loggedQuery=false;}.bind(this)),q.subscribe('respond',function(r,s){if(!this._loggedQuery&&q.getCore().getValue().length>0){g.log('ChatTypeaheadLoggerConfig',{event:i.NEW_QUERY});this._loggedQuery=true;}if(s.value&&s.value===q.getCore().getValue()){if(!s.results.length){var t=s.value.toLowerCase(),u=q.getData().getQueryCache();if(!s.isAsync&&!u.hasOwnProperty(t))return;q.getView().showNoResults();}j.addClass(q.getElement(),'hasValue');}}.bind(this)),q.subscribe('reset',function(){j.removeClass(q.getElement(),'hasValue');}),q.subscribe('select',function(r,s){var t=s.selected.uid;if(s.selected.mercury_thread&&!s.selected.mercury_thread.is_canonical)t=s.selected.mercury_thread.thread_fbid;q.getView().hide();g.log('ChatTypeaheadLoggerConfig',{event:i.RESULT_SELECTED,max_results:q.getData().getMaxResults(),result_type:s.selected.render_type});this._loggedQuery=false;h.openTabByType(t,s.selected.type,'typeahead');}.bind(this)),q.subscribe('highlight',function(r,s){if(s.index>=0){var t=q.getView().getItems()[s.index];if(t){var u=new m(t),v=t.offsetParent,w=u.boundWithin(new m(v)).getPositionVector();u.getPositionVector().sub(w).scrollElementBy(v);}}})];};p.prototype.disable=function(){"use strict";this._subscriptions.forEach(function(q){this._typeahead.unsubscribe(q);},this);this._subscriptions=null;};Object.assign(p.prototype,{_subscriptions:null});e.exports=p;},null);
__d("Dock",["Event","shield","Arbiter","ArbiterMixin","ChatQuietLinks","CSS","DataStore","DOM","Parent","Scroll","Style","Toggler","Vector","csx","emptyFunction","WebMessengerWidthControl"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){b.__markCompiled&&b.__markCompiled();b('WebMessengerWidthControl');function v(){}Object.assign(v,j,{MIN_HEIGHT:140,INITIAL_FLYOUT_HEIGHT_OFFSET:10,init:function(w){this.init=u;this.rootEl=w;this.calculateViewportDimensions();this.calculateFlyoutHeightOffset();k.removeEmptyHrefs(this.rootEl);g.listen(w,'click',this._onClick.bind(this));g.listen(window,'resize',this._onWindowResize.bind(this));r.subscribe(['show','hide'],function(x,y){var z=y.getActive();if(!n.contains(w,z))return;if(l.hasClass(z,'fbNub')){this.notifyNub(z,x);if(x==='show')this._resizeNubFlyout(z);}else{var aa=o.byClass(z,'fbNubFlyout');if(aa)l.conditionClass(aa,'menuOpened',x==='show');}}.bind(this));this.inform('init',{},i.BEHAVIOR_PERSISTENT);},calculateViewportDimensions:function(){return (this.viewportDimensions=s.getViewportDimensions());},calculateFlyoutHeightOffset:function(){this.flyoutHeightOffset=this.INITIAL_FLYOUT_HEIGHT_OFFSET+s.getElementDimensions(this.rootEl).y;var w=n.scry(document,"div._4f7n")[0];if(w){var x=q.isFixed(w)?'viewport':'document';this.flyoutHeightOffset+=s.getElementPosition(w,x).y+s.getElementDimensions(w).y;}},toggle:function(w){var x=this._findFlyout(w);if(!x)return;this.subscribe('init',function(){r.toggle(w);});},show:function(w){this.subscribe('init',function(){r.show(w);});},showNub:function(w){l.show(w);},hide:function(w){this.subscribe('init',function(){var x=r.getInstance(w);n.contains(w,x.getActive())&&x.hide();});},hideNub:function(w){l.hide(w);this.hide(w);},setUseMaxHeight:function(w,x){l.conditionClass(w,'maxHeight',x!==false);this._resizeNubFlyout(w);},_resizeNubFlyout:function(w){var x=this._findFlyout(w);if(!x||l.hasClass(w,'placeholder')||!(l.hasClass(w,'openToggler')||l.hasClass(w,'opened')))return;var y=n.find(x,'div.fbNubFlyoutOuter'),z=n.find(y,'div.fbNubFlyoutInner'),aa=n.find(z,'div.fbNubFlyoutBody'),ba=p.getTop(aa),ca=aa.offsetHeight;q.set(aa,'height','auto');var da=s.getElementDimensions(x),ea=s.getElementDimensions(aa),fa=this.getMaxFlyoutHeight(w);q.set(x,'max-height',fa+'px');q.set(y,'max-height',fa+'px');da=s.getElementDimensions(x);var ga=s.getElementDimensions(z),ha=ga.y-ea.y,ia=da.y-ha,ja=parseInt(aa.style.height||aa.clientHeight,10),ka=ia!==ja;if(da.y>ha&&ka)q.set(aa,'height',ia+'px');l.removeClass(x,'swapDirection');var la=s.getElementPosition(x).x;l.conditionClass(x,'swapDirection',function(){if(la<0)return true;return (la+da.x>this.viewportDimensions.x);}.bind(this)());if(ka&&ba+ca>=ea.y){p.setTop(aa,aa.scrollHeight);}else p.setTop(aa,ba);this.notifyNub(w,'resize');},getMaxFlyoutHeight:function(w){var x=this._findFlyout(w),y=s.getElementPosition(x,'viewport'),z=s.getElementDimensions(x),aa=Math.max(this.MIN_HEIGHT,this.viewportDimensions.y-this.flyoutHeightOffset)-(this.viewportDimensions.y-y.y-z.y);return Math.max(aa,0);},resizeAllFlyouts:function(){var w=this._getAllNubs(),x=w.length;while(x--)this._resizeNubFlyout(w[x]);},hideAllFlyouts:function(){var w=this._getAllNubs(),x=w.length;while(x--)this.hide(w[x]);},_getAllNubs:function(){var w=n.scry(this.rootEl,"div._50-v.openToggler");return w.concat(n.scry(this.rootEl,"div._50-v.opened"));},_onClick:function(event){var w=event.getTarget(),x=o.byClass(w,'fbNub');if(x){if(o.byClass(w,'fbNubFlyoutTitlebar')){var y=o.byTag(w,'a'),z=w.nodeName=='INPUT'&&w.getAttribute('type')=='submit';if(!y&&!z){this.hide(x);return false;}}this.notifyNub(x,'click');}},_onWindowResize:function(event){this.calculateViewportDimensions();this.resizeAllFlyouts();},_findFlyout:function(w){return l.hasClass(w,'fbNubFlyout')?w:n.scry(w,'div.fbNubFlyout')[0]||null;},registerNubController:function(w,x){m.set(w,'dock:nub:controller',x);x.subscribe('nub/button/content-changed',h(this.inform,this,'resize',w));x.subscribe('nub/flyout/content-changed',h(this._resizeNubFlyout,this,w));},unregisterNubController:function(w){m.remove(w,'dock:nub:controller');},notifyNub:function(w,x,y){var z=m.get(w,'dock:nub:controller');z&&z.inform(x,y);}});e.exports=a.Dock||v;},null);
__d("NubController",["ArbiterMixin","Dock"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();function i(){}Object.assign(i.prototype,g,{init:function(j){this.el=j;h.registerNubController(j,this);return this;},buttonContentChanged:function(){this.inform('nub/button/content-changed');},flyoutContentChanged:function(){this.inform('nub/flyout/content-changed');},hide:function(){h.hide(this.el);},show:function(){h.show(this.el);}});e.exports=i;},null);
__d("DropdownContextualHelpLink",["DOM","ge"],function(a,b,c,d,e,f,g,h){b.__markCompiled&&b.__markCompiled();var i={set:function(j){var k=h('navHelpCenter');if(k!==null)g.replace(k,j);}};e.exports=i;},null);
__d("ChatPerfInstrumentation",["BanzaiLogger","ChatPerfEvent","Promise","emptyFunction","performanceAbsoluteNow"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l={_startTime:(Number),init:function(){this._startTime=k();return new i(function(m){return m();});},_log:function(event){g.log('ChatPerfLoggerConfig',{event:event,duration:k()-this._startTime});},logTTI:function(){this.logTTI=j;this._log(h.TTI);},logCHAT_CONVERSATION_TTI:function(){this.logCHAT_CONVERSATION_TTI=j;this._log(h.CHAT_CONVERSATION_TTI);}};e.exports=l;},null);
__d("ChatCookieInterface",["ChatConfig","InitialServerTime","LogHistory","PresenceState","PresenceUtil","areJSONRepresentationsEqual"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.__markCompiled&&b.__markCompiled();'use strict';var m=i.getInstance('chat_cookie'),n=h.serverTime,o=g.get('tab_max_load_age')||3600000,p=n-o,q={store:function(u,v){if(u.uct2==v.lastChangeTime)return u;var w=t(u,v),x={};if(!w){x.old_tabs=u&&u.t2&&JSON.stringify(u.t2);x.old_promoted=u&&u.lm2;x.old_time=u&&u.uct2;x.old_reason=u&&u.tr;x.old_window=u&&u.tw;var y=[];v.tabs.forEach(function(z){if(!z.fragile){var aa={i:z.id,si:z.server_id};if(z.raised)aa.r=1;y.push(aa);}});u.t2=y;u.lm2=v.promotedID;u.uct2=v.lastChangeTime;u.tr=v.lastChangeReason;u.tw=k.getSessionID();x.new_tabs=JSON.stringify(u.t2);x.new_promoted=u.lm2;x.new_time=u.uct2;x.new_reason=u.tr;x.new_window=u.tw;m.debug('store',x);}else{x.tabs=u&&u.t2&&JSON.stringify(u.t2);x.promoted=u&&u.lm2;x.time=u&&u.uct2;x.reason=u&&u.tr;x.window=u&&u.tw;x.last_change_time=v.lastChangeTime;x.last_change_reason=v.lastChangeReason;x.min_change_time=p;m.warn('store_bad_state',x);}return u;},load:function(u,v){if(!u){m.warn('load_bad_state',u);return false;}var w=t(u,v);if(!w||w===v.lastChangeTime)return false;var x={};x.old_tabs=JSON.stringify(v.tabs);x.old_promoted=v.promotedID;x.old_time=v.lastChangeTime;x.old_reason=v.lastChangeReason;x.window_id=k.getSessionID();x.cookie_tabs=u&&u.t2&&JSON.stringify(u.t2);x.cookie_promoted=u&&u.lm2;x.cookie_time=u&&u.uct2;x.cookie_reason=u&&u.tr;x.cookie_window=u&&u.tw;v.lastChangeTime=w;v.lastChangeReason='load';var y=r(v,u.t2,u.lm2||null);x.load_result=y;x.new_tabs=JSON.stringify(v.tabs);x.new_promoted=v.promotedID;x.new_time=v.lastChangeTime;x.new_reason=v.lastChangeReason;var event='load';if(!v.isInitialized)event+='_init';m.log(event,x);return y;}};function r(u,v,w){var x;if(!s(u,v,w))return false;var y=u.tabs.filter(function(ba){return !!ba.fragile;}),z={};u.promotedID=null;u.tabs=v.map(function(ba){var ca={id:ba.i,server_id:ba.si};if(ca.id==w)u.promotedID=ca.id;if(ba.r)ca.raised=true;z[ca.id]=ca;return ca;});u.tabs=u.tabs.filter(function(ba){return !!ba;});if(u.localRaised)for(var aa in u.localRaised)if(!z[aa]||!z[aa].raised)delete u.localRaised[aa];y=y.filter(function(ba){return !z[ba.id];});(x=u.tabs).push.apply(x,y);return true;}function s(u,v,w){if(w!=u.promotedID)return true;var x=u.tabs.filter(function(aa){return !aa.fragile;});if(v.length!=x.length)return true;for(var y=0,z=v.length;y<z;y++)if(!l(v[y],x[y]))return true;return false;}function t(u,v){var w=j.verifyNumber(u.uct2);if(!w||typeof w!=='number'){m.warn('bad_cookie_version',u);return null;}if(w<v.lastChangeTime||w<p)return null;return w;}e.exports=q;},null);
__d("ChatTabPresence",["AvailableList","ChatTabModel","MercuryIDs"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j={};function k(l){var m=i.getUserIDFromThreadID(l);if(m&&g.shouldUpdateForID(m))g.updateForID(m);}h.subscribe('chat/tabs-changed',function(event,l){l.tabs.forEach(function(m){if(m.raised&&!j[m.id])k(m.id);});j={};l.tabs.forEach(function(m){if(m.raised)j[m.id]=true;});});e.exports={};},null);
__d("ChatMentionsNotifications",["fbt","CurrentUser","MercuryParticipants"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j={notifyIfMessageToMe:function(k){var l='fbid:'+h.getID(),m=k.body;i.get(l,function(n){var o=new RegExp(n.short_name,"i");if(o.test(m))j._notify(k);});},_notify:function(k){var l=48,m=k.body;if(m.length>l)m=m.substr(0,l-3)+"...";new Notification(g._("You were tagged in a message!"),{body:m,icon:"http://facebook.com//images/icons-large/fb-xl.png"});}};e.exports=j;},null);
__d("ChatTabViewInstances",["Map"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';e.exports=new g();},null);
__d("ChatNewMessageHandler",["ChatActivity","ChatMentionsNotifications","ChatTabModel","ChatTabViewInstances","JSLogger","MercuryAssert","MercuryBrowserAlerts","UserActivity","MercuryConfig","MercuryThreadlistConstants"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){b.__markCompiled&&b.__markCompiled();var q=k.create('chat_new_message'),r={_notify:function(s,t,u){if(o.DesktopNotificationsGK)h.notifyIfMessageToMe(t);var v=j.get(s);u.view_is_visible=v&&v.isVisible();u.view_is_focused=v&&v.isFocused();if(!u.view_is_visible)q.log('message_to_hidden');u.is_active=g.isActive();m.messageReceived(t);},newMessage:function(s,t){l.isThreadID(s);var u=i.getTab(s),v={thread_id:s,message_id:t.message_id,to_new_tab:!u,to_raised_tab:u?!!u.raised:true};this._notify(s,t,v);q.log('message',v);}};m.subscribe('before-alert',function(s,event){var t=event.threadID,u=j.get(t),v=i.getTab(t),w=p.MESSAGE_NOTICE_INACTIVITY_THRESHOLD;if(v&&v.raised&&u&&u.isVisible()&&u.isFocused()&&n.isActive(w)){u.tryMarkAsRead();event.cancelAlert();}});e.exports=r;},null);
__d("ChatTabLRUManager",["ChatTabViewInstances","ChatTabModel","InitialServerTime","MercuryThreads"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();var j=b('MercuryThreads').get(),k={getLRUVisibleTab:function(l){if(l.hasRoomForRaisedTab())return (void 0);var m=Object.keys(l.getTabsToShow()||{}),n=1*60,o=null,p=Infinity;for(var q=0;q<m.length;q++){var r=m[q],s=j.getThreadMetaNow(r);if(h.isTabPromoted(r))continue;if(!g.get(r).hasEmptyInput()||!s)continue;var t=(i.serverTime-s.timestamp)/1000;if(!s.timestamp||(s.timestamp&&s.timestamp<p&&t>n)){o=s.thread_id;p=s.timestamp;}}return o;}};e.exports=k;},null);
__d("ChatTabPolicy",["ChatBehavior","ChatConfig","JSLogger","MercuryActionType","MercuryLogMessageType","MercuryAssert","MercuryIDs","MercuryParticipantTypes","MercurySourceType","MercuryThreadInfo","MercuryThreadMode","MercuryViewer","MessagingTag","PresencePrivacy","ShortProfiles","MercuryThreadActions"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){b.__markCompiled&&b.__markCompiled();var v=b('MercuryThreadActions').get(),w=i.create('tab_policy');e.exports={messageIsAllowed:function(x,y,z){var aa=x.thread_id,ba=y.message_id;l.isThreadID(aa);l.isParticipantID(y.author);var ca;if(p.isMuted(x)){ca={thread_id:aa,message_id:ba,mute_settings:x.mute_settings};w.log('message_thread_muted',ca);return;}if(x.mode==q.OBJECT_ORIGINATED){ca={thread_id:aa,message_id:ba,mode:x.mode};w.log('message_object_originated',ca);return;}if(y.source==o.EMAIL||y.source==o.TITAN_EMAIL_REPLY){ca={thread_id:aa,message_id:ba,source:y.source};w.log('message_source_not_allowed',ca);return;}var da=m.getUserIDFromParticipantID(y.author);if(!da){w.log('message_bad_author',{thread_id:aa,message_id:ba,user:da});return;}if(y.action_type!=j.USER_GENERATED_MESSAGE&&!this._messageIsNewlyCreatedGroup(y,x)){ca={thread_id:aa,message_id:ba,type:y.action_type};w.log('message_non_user_generated',ca);return;}if(x.is_canonical_user&&!g.notifiesUserMessages()){w.log('message_jabber',{thread_id:aa,message_id:ba});v.markSeen(aa,true);return;}if(x.is_canonical&&!x.canonical_fbid){w.log('message_canonical_contact',{thread_id:aa,message_id:ba});return;}if(x.folder!=s.INBOX){w.log('message_folder',{thread_id:aa,message_id:ba,folder:x.folder});return;}var ea=m.getUserIDFromParticipantID(r.getID());u.getMulti([da,ea],function(fa){if(!t.allows(da)){w.log('message_privacy',{thread_id:aa,message_id:ba,user:da});return;}var ga=fa[da].employee&&fa[ea].employee,ha=h.get('IsWorkUser',false);if(!ga&&!ha&&!fa[da].isCommercePage&&fa[da].type!==n.FRIEND){w.log('message_non_friend',{thread_id:aa,message_id:ba,user:da});return;}z();});},_messageIsNewlyCreatedGroup:function(x,y){return x.action_type===j.LOG_MESSAGE&&x.log_message_type===k.THREAD_NAME&&y.message_count===1;}};},null);
__d("ChatTabViewEvents",["Arbiter"],function(a,b,c,d,e,f,g){b.__markCompiled&&b.__markCompiled();'use strict';e.exports=new g();},null);
__d("ChatTabViewSelector",["Event","Arbiter","ChatTabActions","CSS","DataStore","DOM","MenuDeprecated","NubController","ChatTabTemplates","Toggler","copyProperties","MercuryThreadInformer","MercuryThreads","MercuryThreadMetadataRenderer"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){b.__markCompiled&&b.__markCompiled();var r=b('MercuryThreadInformer').get(),s=b('MercuryThreads').get(),t=b('MercuryThreadMetadataRenderer').get();function u(v){var w=o[':fb:chat:tab:selector'].build(),x=w.getRoot(),y=w.getNode('menu'),z=l.find(y,'.uiMenuInner'),aa={},ba=new n().init(x);j.hide(x);l.insertBefore(v,x);function ca(fa){var ga=0;for(var ha in aa){var ia=aa[ha],ja=s.getThreadMetaNow(ha),ka=ia.getNode('unreadCount'),la=(ja&&ja.unread_count)||0;ga+=la;if(la>9)la='+';j.conditionClass(ka,'invisible_elem',!la);l.setContent(ka,la);}var ma=w.getNode('numMessages');j.conditionShow(ma,ga);l.setContent(ma,ga);}this.setTabData=function(fa){aa={};if(fa.length<1){j.hide(x);return;}j.show(x);l.empty(z);fa.forEach(function(ga){var ha=o[':fb:chat:tab:selector:item'].build();aa[ga.id]=ha;var ia=ha.getNode('content');t.renderAndSeparatedParticipantList(ga.id,ia);l.prependContent(z,ha.getRoot());k.set(ha.getRoot(),'threadID',ga.id);var ja=ha.getNode('closeButton');g.listen(ja,'click',function(event){i.closeTab(ga.id,'selector/close-tab');event.kill();});});ba.flyoutContentChanged();l.setContent(w.getNode('numTabs'),fa.length);ca();};function da(event,fa){if(fa.menu!=y)return;var ga=k.get(fa.item,'threadID');u.inform('selected',ga);p.hide(x);}function ea(event,fa){m.register(y);}m.subscribe('select',da.bind(this));p.listen('show',x,function(){h.inform('layer_shown',{type:'ChatTabSelector'});ea();});p.listen('hide',x,function(){h.inform('layer_hidden',{type:'ChatTabSelector'});});r.subscribe('threads-updated',ca);}q(u,new h());e.exports=u;},null);
__d("ChatTabController",["Arbiter","BanzaiLogger","ChatActivity","ChatConfig","ChatNewMessageHandler","ChatTabActions","ChatTabLRUManager","ChatTabModel","ChatTabPolicy","ChatTabViewEvents","ChatTabViewInstances","ChatTabViewSelector","JSLogger","MercuryViewer","Style","UserAgent_DEPRECATED","VideoCallCore","ChatTabPresence","ChatTypeaheadBehavior","MercuryThreadInformer","MercuryThreadActions","MercuryThreads"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){b.__markCompiled&&b.__markCompiled();b('ChatTabPresence');b('ChatTypeaheadBehavior');var x=b('MercuryThreadInformer').get(),y=b('MercuryThreadActions').get(),z=b('MercuryThreads').get(),aa=j.get('tab_auto_close_timeout')||7200000,ba=s.create('tab_controller');function ca(na,oa,pa){var qa=n.get().tabs,ra=qa[na],sa,ta;if(qa.length===0)return false;var ua=qa.slice(na+1),va=qa.slice(0,na),wa=ua.concat(va);if(!oa)wa.reverse();if(ra)wa.push(ra);for(var xa=0;xa<wa.length;xa++){sa=wa[xa];ta=q.get(sa.id);if(ta&&ta.isVisible()&&(!pa||sa.raised)){ta.focus();return true;}}return false;}function da(na,oa){var pa=oa&&oa.getRightmostHiddenTab();if(pa===na)return null;return pa;}function ea(){return Math.floor(Math.random()*2147483648).toString(16);}function fa(na,oa,pa,qa){l.raiseTab(na,true,pa);var ra=oa&&oa.getLeftmostVisibleTab(),sa=oa&&oa.getTabsToShow();if(sa&&!sa[na]&&ra){n.promoteThreadInPlaceOfThread(na,ra,da(na,oa),true);}else l.promoteTab(na);g.inform('chat/open-tab',na);var ta=q.get(na);ta&&ta.focus();}function ga(na,oa){if(!n.getTab(na))l.raiseTab(na,false);var pa=oa&&m.getLRUVisibleTab(oa),qa=oa&&oa.getTabsToShow();if(qa&&!qa[na]&&pa)n.promoteThreadInPlaceOfThread(na,pa,da(na,oa));}function ha(na){r.subscribe('selected',function(pa,qa){fa(qa,na);});g.subscribe('page_transition',function(pa,qa){l.closeFragileTabs();});g.subscribe('chat-visibility/go-offline',function(){l.closeAllTabs();});i.subscribe('idle',function(pa,qa){if(qa>aa){var ra=n.get().tabs;ra.forEach(function(sa){var ta=sa.id;z.getThreadMeta(ta,function(ua){if(!ua.unread_count){ba.log('autoclose_idle_seen',{thread_id:ta,idleness:qa});l.closeTab(ta,'autoclose_idle_seen');}});});}});p.subscribe('nub-activated',function(pa,qa){fa(qa,na);});p.subscribe('focus-tab',function(pa,qa){var ra=n.getTab(qa);if(ra&&ra.raised)fa(qa,na,ra.signatureID,true);});function oa(pa,qa){h.log('VideoCallLoggerConfig',{event:'chat_tab_call_click'});w.showOutgoingCallDialog(qa.userID,qa.clickSource);}p.subscribe('video-call-clicked',oa);p.subscribe('interaction-with-tab',function(pa,qa){var ra=n.getTab(qa);ra&&ra.raised&&y.markSeen(qa);});p.subscribe('esc-pressed',function(pa,qa){ba.log('close_esc',{thread_id:qa});var ra=n.indexOf(qa);l.closeTab(qa,'close_esc');setTimeout(function(){ca(ra-1,true,true);},0);});x.subscribe('messages-received',function(pa,qa){for(var ra in qa){var sa=qa[ra];for(var ta=0;ta<sa.length;ta++){var ua=sa[ta];if(ua.author!=t.getID()){if(!ua.is_unread){ba.log('message_already_read',{action_id:ua.action_id,thread_id:ua.thread_id});continue;}z.getThreadMeta(ra,function(va){o.messageIsAllowed(va,ua,function(){ga(ra,na);k.newMessage(ra,ua);});});}}}});x.subscribe('thread-read-changed',function(pa,qa){for(var ra in qa)if(!qa[ra].mark_as_read){ba.log('autoclose_marked_unread',{thread_id:ra});l.closeTab(ra,'autoclose_marked_unread');}});p.subscribe('tab-pressed',function(pa,qa){return !ca(n.indexOf(qa.id),qa.shiftPressed);});g.subscribe(s.DUMP_EVENT,function(pa,qa){qa.chat_controller={auto_close_timeout:aa};});this.openTab=function(pa,qa,ra){fa(pa,qa,ea());if(ra)ra(q.get(pa));};}if(v.firefox()){var ia=function(){return u.get(document.body,'overflowX')+' '+u.get(document.body,'overflowY');},ja=ia(),ka=function(){var na=ia();if(na!==ja){ja=na;g.inform('overflow-applied-to-body');}};if('MutationObserver' in window){var la=new MutationObserver(ka),ma={attributes:true,attributeFilter:['class','style']};la.observe(document.documentElement,ma);}else document.documentElement.addEventListener('DOMAttrModified',function(event){if(event.getTarget()===document.documentElement&&(event.attrName==='class'||event.attrName==='style'))ka();},false);}e.exports=ha;},null);
__d("ChatTabViewPlaceholder",["DOM","ErrorUtils","React","cx"],function(a,b,c,d,e,f,g,h,i,j){b.__markCompiled&&b.__markCompiled();'use strict';function k(l,m,n,o,p,q){this.$ChatTabViewPlaceholder0={threadID:m,serverThreadID:n,signatureID:o,root:p,prevTab:q};this.$ChatTabViewPlaceholder1={visible:true,raised:true};l.then(function(r){try{var t=new r(this.$ChatTabViewPlaceholder0.threadID,this.$ChatTabViewPlaceholder0.serverThreadID,this.$ChatTabViewPlaceholder0.signatureID,this.$ChatTabViewPlaceholder0.root,this);t.setVisibleState(this.$ChatTabViewPlaceholder1.visible,this.$ChatTabViewPlaceholder1.raised);this.destroy();this.$ChatTabViewPlaceholder2=t.getTabElem();if(this.$ChatTabViewPlaceholder3)this.$ChatTabViewPlaceholder3(this.$ChatTabViewPlaceholder0.threadID,t);}catch(s){h.reportError(s,false);}}.bind(this));this.render(this.$ChatTabViewPlaceholder0.root,this.$ChatTabViewPlaceholder0.prevTab);}k.prototype.getTabElem=function(){return this.$ChatTabViewPlaceholder2;};k.prototype.onBeingReplaced=function(l){this.$ChatTabViewPlaceholder3=l;};k.prototype.updateSignatureID=function(l){this.$ChatTabViewPlaceholder0.signatureID=l;};k.prototype.getScrollTop=function(){return 0;};k.prototype.appendTo=function(l){g.appendContent(l,this.$ChatTabViewPlaceholder2);};k.prototype.insertBefore=function(l){g.insertBefore(l.getTabElem(),this.$ChatTabViewPlaceholder2);};k.prototype.isFocused=function(){return false;};k.prototype.destroy=function(){i.unmountComponentAtNode(this.$ChatTabViewPlaceholder2);g.remove(this.$ChatTabViewPlaceholder2);};k.prototype.nextTabIs=function(l){var m=l&&l.getTabElem();return !!(this.$ChatTabViewPlaceholder2&&this.$ChatTabViewPlaceholder2.nextSibling===m);};k.prototype.setVisibleState=function(l,m){this.$ChatTabViewPlaceholder1={visible:l,raised:!!m};this.render(this.$ChatTabViewPlaceholder0.root,this.$ChatTabViewPlaceholder0.prevTab);};k.prototype.render=function(l,m){var n=!this.$ChatTabViewPlaceholder1.visible,o=this.$ChatTabViewPlaceholder1.raised,p=(("fbNub")+(' '+"_50-v")+(n?' '+"hidden_elem":'')+(o?' '+"opened":'')+(' '+"placeholder")+(' '+"_50mz"));if(!this.$ChatTabViewPlaceholder2){var q=g.create('div',{className:p});this.$ChatTabViewPlaceholder2=q;i.render(i.createElement("div",null,i.createElement("span",{className:"fbNubButton"}),"opened"+' '+"? (",i.createElement("div",{className:"fbNubFlyout fbDockChatTabFlyout _16bz"},i.createElement("div",{className:"fbNubFlyoutTitlebar"}),i.createElement("div",{className:"fbNubFlyoutBody"})),")"),q);if(m&&m.getTabElem()){this.insertBefore(m);}else this.appendTo(l);}else this.$ChatTabViewPlaceholder2.className=p;};e.exports=k;},null);
__d("ChatTabViewLoader",["Bootloader","ChatTabViewPlaceholder","Promise","Run","requireWeak"],function(a,b,c,d,e,f,g,h,i,j,k){b.__markCompiled&&b.__markCompiled();'use strict';var l,m;k(['ChatTabView'],function(o){return m=o;});var n={make:function(o,p,q,r,s){if(m){return new m(o,p,q,r,s);}else{if(!l)l=new i(function(t){j.onAfterLoad(function(){g.loadModules(["ChatTabView"],function(u){m=u;t(u);});});});return new h(l,o,p,q,r,s);}}};e.exports=n;},null);
__d("ChatTabViewCoordinator",["Arbiter","ChatTabModel","ChatTabViewLoader","ChatTabViewSelector","CSS","JSLogger","VideoCallSupport"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();var n=l.create('chat_tab_coordinator');function o(p,q){var r=new j(p),s={},t=false;function u(){var y=h.get(),z={};y.tabs.forEach(function(ba){z[ba.id]=1;});n.log('process_tab_changed',{model_tabs:Object.keys(z),view_tabs:Object.keys(s)});for(var aa in s)if(!z[aa]){n.log('remove_tab',{tab_id:aa});s[aa].destroy();delete(s[aa]);}v(y);w(y);if(y.tabNeedsFocus&&!y.tabNeedsFocus.isFocused())y.tabNeedsFocus.focus();}function v(y){var z=null;y.tabs.forEach(function(aa){var ba=aa.id,ca=false;if(!s[ba]){n.log('add_tab',{tab_id:ba});s[ba]=i.make(ba,aa.server_id,aa.signatureID,p,z);ca=true;if(s[ba].onBeingReplaced)s[ba].onBeingReplaced(function(ea,fa){s[ea]=fa;});}else s[ba].updateSignatureID(aa.signatureID);if(s[ba].isFocused())y.tabNeedsFocus=s[ba];if(!ca&&!s[ba].nextTabIs(z)){var da=s[ba].getScrollTop();if(z){s[ba].insertBefore(z);}else s[ba].appendTo(p);if(da)s[ba].setScrollTop(da);}z=s[ba];});}function w(y){var z=q.getTabsToShow(y),aa=[],ba=false;y.tabs.forEach(function(ca){if(!z[ca.id]){s[ca.id].setVisibleState(false,ca.raised);aa.push(ca);}});y.tabs.forEach(function(ca){if(z[ca.id]){s[ca.id].setVisibleState(true,ca.raised);ba|=ca.raised;}});r.setTabData(aa);x(ba);}function x(y){if(!y&&t){g.inform('layer_hidden',{type:'ChatTab'});t=false;}else if(y&&!t){g.inform('layer_shown',{type:'ChatTab'});t=true;}}if(m.isVideoCallSupported())k.addClass(p,'videoCallEnabled');q.subscribe('tabs-changed',u);u();}e.exports=o;},null);
__d("TabsViewport",["Arbiter","ArbiterMixin","ChatTabModel","Dock","DOM","DOMDimensions","Event","Parent","Vector","ViewportBounds","areJSONRepresentationsEqual","csx","shield"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){b.__markCompiled&&b.__markCompiled();var t=175,u=269,v=0;function w(){return t;}function x(){return u;}function y(z){this._root=z;var aa=this._recalculateWidth.bind(this);m.listen(window,'resize',aa);j.subscribe('resize',aa);g.subscribeOnce('sidebar/initialized',aa,g.SUBSCRIBE_NEW);i.subscribe('chat/tabs-changed',s(this._recalculateTabs,this,true));this._recalculateWidth();this._initialized=true;}Object.assign(y.prototype,h,{_root:null,_initialized:false,_availableWidth:0,_maxShown:1,_viewState:null,_recalculateWidth:function(){var z=y._getAvailableDockWidth(this._root),aa=Math.max(1,Math.floor(z/x())),ba=aa!=this._maxShown;if(!this._viewState||ba||z<=this._viewState.usedWidth||z>this._viewState.widthToShowNext){this._availableWidth=z;this._maxShown=aa;this._viewState=null;this._recalculateTabs(ba);}},_onTabsChanged:function(){if(this._initialized){this.inform('tabs-changed');this.inform('max-to-show-changed',this._maxShown);this.inform('max-to-show-change-completed');}},_recalculateTabs:function(z){var aa=y._getTabsToShow(i.get(),this._availableWidth);if(z||!q(this._viewState,aa)){this._viewState=aa;this._onTabsChanged();}},getMaxTabsToShow:function(){return this._maxShown;},checkWidth:function(){this._recalculateWidth();},hasRoomForRaisedTab:function(){return this._availableWidth-this._viewState.usedWidth>x();},getTabsToShow:function(){return JSON.parse(JSON.stringify(this._viewState.tabsToShow));},getShowingTabsOrder:function(){var z=i.get(),aa=this._viewState.tabsToShow;return z.tabs.filter(function(ba){return aa[ba.id];});},getRightmostHiddenTab:function(){var z=i.get(),aa=this._viewState.tabsToShow,ba=z.tabs.filter(function(da){return !aa[da.id];}),ca=ba.shift();return ca?ca.id:null;},getLeftmostVisibleTab:function(){var z=this.getShowingTabsOrder(),aa=z.pop();return aa?aa.id:null;},getRaisedVisibleTabs:function(){var z=[],aa=this.getShowingTabsOrder(),ba=aa.length;for(var ca=0;ca<ba;ca++)if(i.getTab(aa[ca].id).raised)z.push(aa[ca].id);return z;},shouldPromoteOnRaise:function(z){if(!this._viewState.tabsToShow[z])return true;if(this._viewState.nextToHide!=z)return false;var aa=i.getTab(z),ba=aa&&aa.raised;return !ba&&(this._availableWidth-this._viewState.usedWidth<x()-w());}});Object.assign(y,{_getAvailableDockWidth:function(z){var aa=l.getViewportWithoutScrollbarDimensions().width;aa-=p.getLeft()+p.getRight();aa-=50;var ba=n.byClass(z,'fbDock'),ca=k.find(ba,"._56ox"),da=ca?o.getElementDimensions(ca).x:0;aa-=da;var ea=k.scry(ba,"._56oy");da+=o.getElementDimensions(ea.pop()).x;var fa=o.getElementDimensions(ba),ga=fa.x-da;if(ga>v)v=ga;aa-=v;aa-=15;return Math.max(aa,0);},_getTabsToShow:function(z,aa){aa=Math.max(aa,x()+1);function ba(ra,sa){return (ra.raised||!sa)?x():w();}var ca=JSON.parse(JSON.stringify(z.tabs)),da=-1,ea=null;if(z.promoted)ca.forEach(function(ra,sa){if(ra.id===z.promoted){da=sa;ea=ra;}});var fa=0,ga=false,ha=0,ia=!ea;ca.forEach(function(ra,sa){var ta=ba(ra,ga);ga=ga||!ra.raised;ra.leftmostOffset=fa+ta;fa+=ta;if(ra.leftmostOffset<aa)ha++;ia|=sa==da;ra.alreadyPlacedPromoted=ia;});function ja(ra,sa,ta){var ua={};for(var va=0;va<sa;va++){var wa=ra[va];if(!wa.alreadyPlacedPromoted&&va==sa-1){ua[ta]=true;}else ua[wa.id]=true;}return ua;}var ka=ja(ca,ha,z.promoted),la=ja(ca,ha-1,z.promoted),ma=null;for(var na in ka)if(!la[na])ma=na;var oa=ca[ha-1],pa=oa?oa.leftmostOffset:0,qa=Infinity;if(ha<ca.length)qa=ca[ha].leftmostOffset;return {nextToHide:ma,tabsToShow:ka,usedWidth:pa,widthToShowNext:qa};}});e.exports=y;},null);
__d("MNCommerceDialogContainer.react",["MNCommerceDialogStateStore","PureStoreBasedStateMixin","React"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=i.createClass({displayName:"MNCommerceDialogContainer",mixins:[h(g)],statics:{calculateState:function(){var k=g.getDialogContainer();return {dialogContainer:k};}},render:function(){var k=this.state.dialogContainer;if(!k)return null;return i.createElement(k,null);}});e.exports=j;},null);
__d("P2PDialogStore",["EventEmitter","P2PActionConstants","P2PDispatcher"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j,k={};for(var l in g)if(g.hasOwnProperty(l))n[l]=g[l];var m=g===null?null:g.prototype;n.prototype=Object.create(m);n.prototype.constructor=n;n.__superConstructor__=g;function n(){g.call(this);j=i.register(this.onEventDispatched.bind(this));k={dialogClass:null,dialogProps:null};}n.prototype.getState=function(){return k;};n.prototype.onEventDispatched=function(o){var p=o.type,q=o.data;switch(p){case h.DIALOG_SHOWN:k.dialogClass=q.dialogClass;k.dialogProps=q.dialogProps;this.emit('change');break;case h.DIALOG_CLOSED:k.dialogClass=null;k.dialogProps=null;this.emit('change');break;}};e.exports=new n();},null);
__d("P2PDialogContainer.react",["P2PDialogStore","React","ReactLayeredComponentMixin"],function(a,b,c,d,e,f,g,h,i){b.__markCompiled&&b.__markCompiled();'use strict';var j=h.createClass({displayName:"P2PDialogContainer",mixins:[i],getInitialState:function(){return g.getState();},componentDidMount:function(){this.dialogStoreSub=g.addListener('change',this.onDialogStoreChange);},componentWillUnmount:function(){if(this.dialogStoreSub){this.dialogStoreSub.remove();this.dialogStoreSub=null;}},onDialogStoreChange:function(){this.setState(g.getState());},renderLayers:function(){if(!this.state.dialogClass)return {};var k=this.state.dialogClass;return {dialog:h.createElement(k,h.__spread({},this.state.dialogProps))};},render:function(){return null;}});e.exports=j;},null);
__d("ChatApp",["CSS","ChatPerfInstrumentation","DOM","JSLogger","Promise","React","csx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){b.__markCompiled&&b.__markCompiled();'use strict';var n={init:function(r,s,t){if(this._isInitialized){j.create('chat_app').error('repeated_init');return;}this._rootElem=r;k.resolve().then(function(){return h.init();}).then(function(){return o();}).then(function(){return p(t);}).then(function(){return q(s,r);}).then(function(){this._isInitialized=this._isLoaded=true;h.logTTI();}.bind(this));},isInitialized:function(){return !!this._isInitialized;},isHidden:function(){return !this._isInitialized||this._isHidden;},hide:function(){if(this.isHidden())return;g.hide(this._rootElem);this._isHidden=true;},unhide:function(){if(this._isInitialized){if(this._isHidden){g.show(this._rootElem);this.tabsViewport.checkWidth();d(['Dock'],function(r){r.resizeAllFlyouts();});this._isHidden=false;}}else if(!this._isLoaded){d(['UIPagelet'],function(r){r.loadFromEndpoint('ChatTabsPagelet','ChatTabsPagelet');r.loadFromEndpoint('BuddylistPagelet','BuddylistPagelet');});this._isLoaded=true;}}};function o(){return new k(function(r){d(['MercuryChannelHandler','MercuryDelayedRoger','MercuryDeliveryState','MercuryParticipants','MercuryStateCheck','MercuryThreads','MercuryUnreadState','MercuryUnseenState'],function(s,t,u,v,w,x,y,z){s.get().turnOn();t;u.get();v;x.get();z.get();y.get();w.get();r();});});}function p(r){return new k(function(s){d(['MercuryServerRequests'],function(t){t.get().handleUpdate(r);s();});});}function q(r,s){return new k(function(t){d(['ChatTabController','ChatTabViewCoordinator','TabsViewport','MNCommerceDialogContainer.react','P2PDialogContainer.react'],function(u,v,w,x,y){n.tabsViewport=new w(r);n.tabViewCoordinator=new v(r,n.tabsViewport);n.tabController=new u(n.tabsViewport);var z=i.find(s,"._26-x");l.render(l.createElement(x,null),z);var aa=i.find(s,"._26-y");l.render(l.createElement(y,null),aa);t();});});}e.exports=n;},null);